window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.im.js'] = (new Date()).getTime();
Type.registerNamespace("_im");_im.i=function(n,t,i,r){if(n==="Mouse"&&t){var u=this;i.q().e(function(n,t){if(!t.c)for(var i=0;i<t.a.length;i++){var u=t.a[i];r.f(u)}})}};_im.d=function(n,t,i,r){this.l=Function.createDelegate(this,this.n);this.h=Function.createDelegate(this,this.m);this.e=Function.createDelegate(this,this.o);this.i=Function.createDelegate(this,this.p);_im.d.initializeBase(this);this.d=r;this.a=n;this.g=new _j.g(this.i,_a.a.l);this.q(i.b(1,_bc.e.a,this.a.a(),2));this.a.a().e(this.e);t.m(this.h);if(r.get_mainWindowInstance()&&!r.get_mainWindowInstance().closed){var u=this;_a.X.a(r.get_mainWindowInstance(),function(n){n.chatWindowReady(u.a.p())})}};_im.d.prototype={d:null,a:null,g:null,f:null,b:function(){return this.eK(_im.d.a)},q:function(n){this.eI(_im.d.a,n);return n},j:function(n){this.f=n;this.eH("EditorCallContext");return n},c:function(){return this.eK(_im.d.b)},r:function(n){this.eI(_im.d.b,n);return n},o:function(n,t){switch(t.c){case 0:for(var i=0;i<t.a.length;i++){var f=t.a[i];this.b().y(f)}return;case 2:for(var r=t.b.length-1;r>=0;r--){var e=t.b[r];var o=this;var u=this.b().a().k(function(n){var t=n;return t.l.i()===e.i()});u<this.b().a().x.length&&this.b().a().n(u)}return}},p:function(){if(!_j.h.a(this.c())){this.a.bc(this.c());var n=this;_a.X.a(this.d.get_mainWindowInstance(),function(t){t.sendChatMessage(n.a.c().Id,n.c())})}},m:function(n){_j.e.a(_a.a.l,"ChatViewModel.BeforeUnload invoked.");this.a.a().f(this.e);var t=this;_a.X.a(this.d.get_mainWindowInstance(),function(n){_j.e.a(_a.a.l,"ChatViewModel.BeforeUnload calling into main window.");n.endChat(t.a.p())})},n:function(){this.j(new _cmc.k(!1))}};_im.j=function(n,t,i){this.c=n;this.e=t;this.d=i};_im.j.prototype={c:null,e:null,d:null,f:function(n){var i={};i.ItemID=n.J();var r=new _db.I;r.b(n);var t=_bc.d.e();if(n.C!==-1&&n.D!==-1){t.c=n.C;t.d=n.D}_j.e.a(_a.a.l,"ChatViewModelFactory: Chat.BodyText: {0}",n.l());var u=this;this.c.g(_y.fS,function(){return u},i,t,r,!1)},b:function(n,t,i){return null},a:function(n,t,i){var r=n.a();return new _im.d(r,this.c,this.e,this.d)}};_im.G=function(n){this.b=n};_im.G.prototype={b:null,a:function(n,t,i){for(var u=new Array(n.x.length),f=new Array(n.x.length),r=0;r<n.x.length;r++){var e=n.x[r];u[r]=e.c();f[r]=e.i()}var o=t?t.p():null;var s=this;_a.X.a(this.b.get_mainWindowInstance(),function(n){n.startChat(u,f,o,i)})}};_im.m=function(n){_im.m.initializeBase(this);this.e=n};_im.m.prototype={e:null,K:function(n){this.e.d(1);n.dt(this.e.b(),null,this.J,this.H)},cS:function(n,t,i){if(n===-9){_j.e.a(_a.a.l,"AcceptChatAction.ProcessResult: Suppressing 'ConversationEnded' error.");n=this.e.b()}if(n<0){i(Error.create("InstantMessageOperationError: "+n));return}this.e.d(3);_j.e.a(_a.a.l,"AcceptChatSession web service call succeeded for chat {0}.",this.e.b());t()},V:function(){_a.dk.prototype.V.call(this)}};_im.n=function(n,t){this.j=n;this.k=t};_im.n.prototype={k:null,j:null,c:function(n,t){return this.j.d(n,t)},b:function(n,t){return this.j.c(n,t)},g:function(n,t){return null},h:function(n,t){return null},i:function(n,t){return new _im.C(n,t)},f:function(n){return this.k.b(n)}};_im.s=function(n,t){_im.s.initializeBase(this);this.e=n;this.f=t};_im.s.prototype={e:null,f:null,S:function(){_a.dk.prototype.S.call(this);this.f.w(this.e)},K:function(n){if(this.e.b()===-1){this.e.d(4);return}n.iL(this.e.b(),null,this.J,this.H)},cS:function(n,t,i){this.e.d(4);if(!n){i(Error.create("EndChatAction returned false."));return}t()}};_im.t=function(n){this.a=n};_im.t.prototype={a:null,b:function(n){return new _im.s(n,this.a)}};_im.u=function(n){_im.u.initializeBase(this);_a.b.j(n,"sipUris");this.e=n};_im.u.prototype={e:null,K:function(n){n.gc(this.e,null,this.J,this.H)},cS:function(n,t,i){if(n<0){i(Error.create("GetPresenceAction failed with InstantMessageOperationError: "+n));return}t()}};_im.v=function(n){_im.v.initializeBase(this);this.e=n};_im.v.prototype={e:!1,K:function(n){var t;var i=(t=new _gg.vA(this.L),t.isAutomated=!this.e,t);n.gJ(this.e,i,this.J,this.H)},cS:function(n,t,i){if(n<0){n!==-2&&_j.e.a(_a.a.l,"Sign in failed with code {0}, will retry.",n);i(Error.create("InstantMessageOperationError: "+n));return}t()}};_im.w=function(n){_im.w.initializeBase(this);this.e=n};_im.w.prototype={e:!1,K:function(n){n.gK(this.e,null,this.J,this.H)},cS:function(n,t,i){if(n<0){i(Error.create("InstantMessageOperationError: "+n));return}t()}};_im.B=function(){_im.B.initializeBase(this)};_im.B.prototype={K:function(n){n.cP(null,this.J,this.H)},cS:function(n,t,i){if(n<0){i(Error.create("ResetPresenceAction failed with InstantMessageOperationError: "+n));return}t()}};_im.C=function(n,t){_im.C.initializeBase(this);this.e=n;this.f=t};_im.C.prototype={f:null,e:null,S:function(){_a.dk.prototype.S.call(this)},K:function(n){this.e.H()||this.e.d(1);var t=new _g.eh(this.f);t.ChatSessionId=this.e.b();t.Recipients=this.e.V();t.Subject=this.e.m();n.cW(t,null,this.J,this.H)},cS:function(n,t,i){if(n<0){i(Error.create("InstantMessageOperationError: "+n));return}this.e.o(n);this.e.d(3);t()},V:function(){this.e.q(_nbs.a.Rj);_a.dk.prototype.V.call(this)}};_im.D=function(n,t){_im.D.initializeBase(this);_a.b.c(n,"sipUri");this.f=n;this.e=t};_im.D.prototype={f:null,e:"None",K:function(n){var t=new _gg.iq;t.Presence=this.e;n.dc(t,null,this.J,this.H)},cS:function(n,t,i){var r=n;if(r){i(Error.create("SetPresenceAction failed with InstantMessageOperationError: "+r));return}t()}};_im.k=function(n,t,i,r,u){_im.k.initializeBase(this);_a.b.a(i,"participants");_a.b.g(i.x.length,0,"participants.Count");if(u){if(i.x.length!==1)throw Error.invalidOperation("imAddress can only be used in conjunction with a single participant.");if(r)throw Error.invalidOperation("imAddress and itemOrConversation are mutually exclusive.");}this.e=n;this.d=this.k(i);_a.b.g(this.d.x.length,0,"No valid participants.");this.j=t;this.h=r;this.f=u};_im.k.prototype={e:null,j:null,d:null,h:null,f:null,S:function(){_a.dk.prototype.S.call(this);if(this.j){this.j.a(this.d,this.h,this.f);return}this.e.z(this.d,this.h,this.f)},ba:function(){return 0},k:function(n){for(var r=new _j.l,u={},e=n.x.length,i=0;i<e;i++){var t=n.x[i];if(t&&this.e.a(t.i())){var f=t.i();if(!(f in u)){r.a(t);u[f]=t}}}return r}};_im.l=function(n,t){this.a=n;this.b=t};_im.l.prototype={a:null,b:null,d:function(n,t){return new _im.k(this.a,this.b,n,t,null)},c:function(n,t){var i=new _j.l;i.a(n);return new _im.k(this.a,this.b,i,null,t)}};_im.E=function(n){_im.E.initializeBase(this);_a.b.j(n,"sipUris");this.e=n};_im.E.prototype={e:null,K:function(n){n.iA(this.e,null,this.J,this.H)},cS:function(n,t,i){if(n<0){i(Error.create("SubscribeForPresenceUpdatesAction failed with InstantMessageOperationError: "+n));return}t()}};_im.F=function(n){_im.F.initializeBase(this);_a.b.c(n,"sipUri");this.e=n};_im.F.prototype={e:null,K:function(n){n.iN(this.e,null,this.J,this.H)},cS:function(n,t,i){if(n<0){i(Error.create("UnsubscribeFromPresenceUpdatesAction failed with InstantMessageOperationError: "+n));return}t()}};_im.o=function(n){this.b=n.a/1e3;this.a={}};_im.o.prototype={b:0,a:null,e:function(n){this.c();this.a[n.toString()]=this.d()},f:function(n){this.c();return n.toString()in this.a},d:function(){return _a.d.a()},c:function(){var e=this.d();var t=new _j.q;var i=this.a;for(var r in i){var u={key:r,value:i[r]};var o=u.value;var s=o.D(this.b);s.b(e)<0&&t.c(u.key)}for(var f=t.i(),h=f.length,n=0;n<h;++n){var c=f[n];delete this.a[c]}}};_im.c=function(n,t,i,r,u,f,e){this.V=Function.createDelegate(this,this.bH);this.bj=Function.createDelegate(this,this.ci);this.bk=Function.createDelegate(this,this.cj);this.be=Function.createDelegate(this,this.cb);this.bn=Function.createDelegate(this,this.co);this.bb=Function.createDelegate(this,this.Z);this.W=Function.createDelegate(this,this.ca);this.bf=Function.createDelegate(this,this.cc);this.bg=Function.createDelegate(this,this.ce);this.bh=Function.createDelegate(this,this.cf);this.bi=Function.createDelegate(this,this.cg);this.bl=Function.createDelegate(this,this.ck);this.bm=Function.createDelegate(this,this.cl);this.bc=Function.createDelegate(this,this.bY);this.bd=Function.createDelegate(this,this.bZ);this.bo=Function.createDelegate(this,this.cp);this.D=new _j.l;this.G=new _j.l;this.K=new _j.l;_im.c.initializeBase(this);this.n("Initialization","unknown");this.C=t;this.j(this.C.c);if(!n){this.n("Initialization","Disabled");return}this.E=i;this.H=!0;this.L=!1;this.R=new _im.o(_a.bW.b(30));var o=new _g.R;o.NotificationType="InstantMessageNotification";this.U=new _h.I(o,this.E,r);this.U.J(this.bo);if(u&&e){this.ba=!0;_j.e.a(_a.a.l,"ChatManager: Waiting for the pending-get activation event.");var s=this;u.b(_no.e,function(n){_j.e.a(_a.a.l,"ChatManager: Pending-get activated.");s.S=!0;s.bG()});var h=this;u.b(_a.ek,function(){h.bp()});u.b(_a.cO,this.bd);f?this.bV(f):this.B="Disabled"}this.D.e(this.bc);this.M=this.bM(this.E)};_im.c.d=function(n,t,i){var r;var u,f;if(f=n.G(function(n){return n.b()===t},u={val:r}),r=u.val,f){i.val=r;return!0}i.val=null;return!1};_im.c.e=function(n,t,i){var r;var u,f;var e=(f=n.G(function(n){var i=n;if(i.a().x.length!==1)return!1;var r=i.a().x[0];return r.i()===t?!0:!1},u={val:r}),r=u.val,f);i.val=r;return e};_im.c.prototype={C:null,ba:!1,X:null,O:null,S:!1,Q:!1,bB:!1,R:null,E:null,P:!1,H:!1,T:!1,B:"unknown",J:null,L:!1,U:null,M:null,j:function(n){this.bA(_im.c.a,n)},bE:function(n){this.bD(_im.c.a,n)},d:function(){return this.B},c:function(){return this.B==="SignedIn"},f:function(){this.bs("IsEnabled");return this.B!=="Disabled"},q:function(){return this.D},s:function(){return this.G},r:function(){return this.K},b:function(){this.bs("CurrentUserSipUri");return this.O},t:function(){return!1},k:function(n){if(!this.S){_j.e.a(_a.a.l,"Ignoring a SignIn attempt because the pending-get connection is not yet started.");return}this.H=!0;this.L=n;this.Z()},l:function(n){_j.e.a(_a.a.l,"Signing out.");var t=new _im.w(n);t.b(this.bm);t.c(this.bl);this.n("SignOut:Manual="+n,"AttemptingSignOut");this.E.a(t)},h:function(n,t,i){var r=_im.b.a(t);var u;var f,e;var o=(e=this.C.f(r,f={val:u}),u=f.val,e);this.bR(n,r,_im.b.b(i),o)},m:function(n,t){var i=new _im.D(_im.b.a(n),t);i.b(this.bi);i.c(this.bh);this.E.a(i)},n:function(n,t){t==="Error";_j.e.a(_a.a.l,"SignInState: {0} Requesting change from {1} to {2}",n,this.B,t);var i=this.c();if(this.B!==t){this.B=t;this.bw(_im.c.b);this.c()!==i&&this.bw(_im.c.c)}},A:function(n,t){_j.e.a(_a.a.l,"Setting current user SIP URI to {0}",t);this.O=t},x:function(){if(this.B==="SignedIn"){_j.e.a(_a.a.l,"ResetPresence");var n=new _im.B;n.b(this.bg);n.c(this.bf);this.E.a(n)}},z:function(n,t,i){_j.e.a(_a.a.l,"Starting chat.");_a.b.b(n,"basePersonaParticipants");_a.b.g(n.x.length,0,"basePersonaParticipants.Count");i&&_a.b.f(n.x.length,1,"When imAddress is specified, participant count must be 1.");for(var u=new _j.l,l=n.x.length,o=0;o<l;o++){var a=n.x[o];var v=_pc.a.d(a);u.a(v)}var r=null;if(u.x.length===1){var e=u.x[0];var f=null;i?f=i:e.i()&&(f=e.i());if(f){var s,h;h=_im.c.e(this.D,f,s={val:r});r=s.val;h}var c=e.c();if(!_j.h.b(f)&&!_j.h.b(c)){var y=_im.b.a(f);this.C.d("StartChat (single participant)",y,c,e.cG(),!0)}}else{var p=this;u.o(function(n){var t=n;var i=t.i();var r=t.c();if(!_j.h.b(i)&&!_j.h.b(r)){var u=_im.b.a(i);p.C.d("StartChat (multiple participants)",u,r,t.cG(),!0)}})}if(!r){r=this.bt(u,t);this.bq(r);if(i){var w=u.x[0];r.bb(w,i)}}_g.g.isInstanceOfType(t)?r.P(t):_g.p.isInstanceOfType(t)&&r.O(t);return r},o:function(n){_j.e.a(_a.a.l,"Accepting invitation.");this.G.p(n,!0);this.bq(n);var t=new _im.m(n);this.E.a(t)},p:function(n){},v:function(n){_j.e.a(_a.a.l,"Ignoring invitation.");this.G.p(n,!0);this.R.e(n.b())},w:function(n){_j.e.a(_a.a.l,"Removing chat {0}",n.b());n.d(4);n.a().f(this.W);var t=this.D.p(n,!0);var i=this.G.p(n,!0);n.c()&&_h.d.a().c(n.c().Id)},cb:function(n){if(n.EventType==="Reload"){_j.e.b(_a.a.l,"ChatManager.OnIMNotification: Received a 'Reload' notification from the OWA server, assuming server has rebooted or connection re-established");this.H=!0;this.N(!1);return}var t=n;var i=t.PayloadType;if(_j.u.a(i)){_j.e.b(_a.a.l,"ChatManager.OnIMNotification: Unexpected notification payload: {0}, {1}",n.EventType,n.toString());return}if(i==="ServiceUnavailable"){if(t.ServiceError==="ClientSignOut"){_j.e.b(_a.a.l,"ChatManager.OnIMNotification: Service unavailable, client signed out.  {0}",t.ErrorMessage);this.n("IMNotification","SignedOut");return}_j.e.b(_a.a.l,"ChatManager.OnIMNotification: Received a 'ServiceUnavailable' notification: {0}, {1}.",t.ServiceError,t.ErrorMessage);this.N(!1);return}if(i==="SignOn")if(t.SignOnStarted){_j.e.a(_a.a.l,"ChatManager.OnIMNotification: Sign-on started.");return}else{_j.e.a(_a.a.l,"ChatManager.OnIMNotification: Sign-on succeeded.");this.N(!0);this.ch();this.bB=t.IsUserInUcsMode;return}if(i==="UpdateUserPresence"||i==="UserPresenceChange"||i==="QueryUserPresenceChange"){this.bQ(t);return}this.C.l(t);t.Persona&&!t.Persona.ImAddress&&(t.Persona.ImAddress=t.SipUri);if(t.PayloadType==="PendingContactList"){if(!t.PendingContacts){_j.e.b(_a.a.cp,"The payload for PendingContacts is empty");return}this.bL(t.PendingContacts);return}if(t.PayloadType==="AddToBuddyList"){if(!t.AddedContacts){_j.e.b(_a.a.cp,"The payload for AddedContacts is empty");return}this.cn(t.AddedContacts)&&_j.e.a(_a.a.cp,"Removed already added contact from pending buddyRequests");return}if(t.PayloadType==="EmptySubscribers"){this.bP();_j.e.a(_a.a.cp,"Removed already added contact from pending buddyRequests after receiving emptysubscribers");return}if(!("ChatSessionId"in t)){_j.e.a(_a.a.l,"Notification {0} not supported, no session id.",i);return}if(this.R.f(t.ChatSessionId)){_j.e.a(_a.a.l,"ChatManager.OnIMNotification: {0} for conversation {1} was ignored.",t.PayloadType,t.ChatSessionId);return}_j.e.a(_a.a.l,"ChatManager.OnIMNotification: {0}, Session={1}, SipUri={2}",i,t.ChatSessionId,t.SipUri);var r;var u,f,e,o;if((f=_im.c.d(this.D,t.ChatSessionId,u={val:r}),r=u.val,f)||(o=_im.c.d(this.G,t.ChatSessionId,e={val:r}),r=e.val,o)){var s=this.C.b(t.SipUri,t.DisplayName);this.cm(t,r,s);return}_j.e.a(_a.a.l,"No matching chat found for session {0}",t.ChatSessionId);this.cq(t)},e:function(n){for(var r=n.b(),t=0;t<r;t++){var i=n.a(t);if(i&&this.a(i.SipUri))return!0}return!1},a:function(n){return _j.h.b(n)?!1:_j.h.b(this.b())?!1:n.toLowerCase()===this.b().toLowerCase()?!1:!0},u:function(n){return _im.b.b(n)},g:function(n){return _im.b.d(n)},y:function(){},bM:function(n){return new _im.A(n)},bN:function(){this.n("DelayInternalSignIn","AttemptingSignIn");_j.m.a().a(_a.a.l,"ChatManager.InternalSignIn",this.bb,3e4)},bx:function(){this.bE(this.C.c);_j.R.prototype.bx.call(this)},cj:function(n){_j.e.a(_a.a.l,"Sign-in action succeeded.  Awaiting notification.");this.J=_j.m.a().a(_a.a.l,"ChatManager.SignInNotificationTimeout",this.bn,1e4)},ci:function(n){_j.e.a(_a.a.l,"Sign-in action failed.");var t=n;if(t.N===-11){_j.e.a(_a.a.l,"Automatic sign-in rejected because the user was explicitly signed out.");this.n("Automatic Sign-In Rejected","SignedOut");return}_j.e.b(_a.a.l,"Sign-in failed: {0}",t.G.message);this.N(!1)},co:function(){_j.e.b(_a.a.l,"Sign-in timeout expired.  Current sign-in state: {0}, ServiceAvailable: {1}.",this.B,this.P);this.B!=="SignedIn"&&this.N(!1)},cl:function(n){_j.e.a(_a.a.l,"Sign-out succeeded.");this.n("SignOutSucceeded","SignedOut")},cp:function(n,t){if(!this.T){_j.e.a(_a.a.l,"Subscribed to notifications.");this.T=!0;this.Z()}},bX:function(n,t,i){if(this.B!=="Disabled"){var r=n?"SignedOut":"Disabled";if(_j.h.a(i)){_j.e.a(_a.a.l,"The currentUserSipUri is null/empty -> Marking SignInState as disabled.");r="Disabled"}else i=_im.b.a(i);this.n("Configuration Updated",r)}this.X=t;this.A("InternalSetConfiguration",i);this.Q=!0},Z:function(){if(!this.T){_j.e.a(_a.a.l,"Subscribing to notifications.");this.U.m(_a.a.l,"OnIMNotification",this.be,1);return}_j.e.a(_a.a.l,"Signing in. Manual: {0}, will retry: {1}",this.L,this.H);var n=new _im.v(this.L);n.b(this.bk);n.c(this.bj);this.n("InternalSignIn","AttemptingSignIn");this.E.a(n);this.J&&(this.J=_j.m.a().b(this.J))},bt:function(n,t){_j.e.a(_a.a.l,"Creating new Chat.");var i=new _h.h(!0);i.a().e(this.W);i.a().z(n);i.N(new _g.e("IM:"+Math.random().toString()));if(!t)return i;if(_g.g.isInstanceOfType(t)){i.P(t);return i}if(_g.p.isInstanceOfType(t)){i.O(t);return i}var r=_j.h.c("CreateChat: itemOrConversation type {0} is not supported.",Object.getType(t).getName());_j.e.c(_a.a.l,r);throw Error.invalidOperation(r);},bq:function(n){_j.e.a(_a.a.l,"Activating chat.");n.c()&&_h.d.a().b(n.c().Id,n);var t=this.bS(n);this.D.t(t,n)},cm:function(n,t,i){var u=n.PayloadType;switch(u){case"NewChatMessageToast":_j.e.a(_a.a.l,"NewChatMessageToast received and mapped to chat {0}.",t.b());return;case"ParticipantJoined":this.C.e(n);var r;if(n.Persona){r=new _pc.a(null,!0,null);r.eY(n.Persona)}else r=_pc.a.l(i,n.SipUri);t.X(n.SipUri,r,i);return;case"ParticipantLeft":t.Y(n.SipUri,i);return;case"EndChatSession":t.u||this.G.p(t,!0);return;case"NewChatMessage":t.L(i,n.MessageContent);return;case"UserActivity":switch(n.UserActivity){case"FailedDelivery":t.q(_nbs.a.Rj);return;case"Typing":t.bf(i);return;case"StoppedTyping":t.e("");return;case"TwoOrMoreTyping":t.e(_nbs.a.SH);return;case"DeliveryTimeout":t.q(_nbs.a.GB);return;default:return}}},cq:function(n){if(n.PayloadType==="NewChatMessageToast"){this.C.e(n);var i=this.C.b(n.SipUri,n.DisplayName);var u=this.bu(n.Persona,i,n.SipUri,n.ToastMessage,n.MessageSubject,n.ChatSessionId);_j.e.a(_a.a.l,"ChatManager.TryProcessInvitation: Created invitation for conversation {0} (NewChatMessageToast).",n.ChatSessionId);return!0}if(n.PayloadType==="NewChatMessage"){var t=this.C.b(n.SipUri,n.DisplayName);var r=this.bu(n.Persona,t,n.SipUri,n.MessageContent,"",n.ChatSessionId);r.L(t,n.MessageContent);_j.e.a(_a.a.l,"ChatManager.TryProcessInvitation: Created invitation for conversation {0} (NewChatMessage).",n.ChatSessionId);return!0}return!1},bu:function(n,t,i,r,u,f){var o;if(n){o=new _pc.a(null,!0,null);o.eY(n)}else o=_pc.a.l(t,i);r||(r="");var s=new _j.l;s.a(o);var e=this.bt(s,null);e.o(f);e.j=o;e.r=r;_j.h.b(u)||e.y(u);this.G.a(e);return e},bL:function(n){_a.b.b(n,"senderInfo");for(var u=n,f=u.length,t=0;t<f;++t){var i=u[t];var r=i.SipUri;_j.e.a(_a.a.cp,"Adding pending contact to buddy requests list",r);var e=this.bT(i.DisplayName,i.Title,r);this.bC(r,!1)||this.K.a(e)}},cn:function(n){_a.b.b(n,"senderInfo");for(var i=!1,r=n,f=r.length,t=0;t<f;++t){var e=r[t];var u=e.SipUri;_j.e.a(_a.a.cp,"Examining the AddToBuddyList payload for existing buddy requests",u);i=this.bC(u,!0)}return i},bP:function(){_j.e.a(_a.a.cp,"Received empty subscribers notification, we need to hide the pending buddy dialogue");this.K.g()},bT:function(n,t,i){_a.b.b(n,"displayName");_a.b.b(i,"buddyImAddress");var r=_pc.a.l(n,i);_j.h.a(t)||r.cS(t);return r},bC:function(n,t){for(var i=0;i<this.K.x.length;i++){var r=this.K.x[i];if(!r.i().localeCompare(n)){if(t){_j.e.a(_a.a.cp,"Removing already added contact from pending buddyRequests",r.i());this.K.n(i)}return!0}}return!1},bS:function(n){var t=this;return this.D.k(function(t){return n.g.b(t.g)>=0})},N:function(n){this.J&&(this.J=_j.m.a().b(this.J));var t=this.P;this.P=n;if(n&&t){_j.e.a(_a.a.l,"Service confirmed available.");return}else if(n&&!t){_j.e.a(_a.a.l,"Service resumed.");return}else if(!n&&t){_j.e.a(_a.a.l,"Service interrupted.");this.bp();this.bF();return}else if(!n&&!t){_j.e.a(_a.a.l,"Service confirmed unavailable.");this.bF();return}_j.e.c(_a.a.l,"Unexpected condition in ChatManager.SetServiceAvailability.")},ch:function(){this.n("SignedOn Succeeded","SignedIn");this.H=!0;this.L=!1},bp:function(){this.D.o(this.V);this.G.o(this.V);var n=this;this.D.o(function(t){t.bd(n.P)})},bF:function(){if(this.B==="AttemptingSignIn"||this.B==="SignedIn"||this.B==="Error"){if(this.H){this.H=!1;this.bN();return}this.L=!1;this.n("SignIn-GiveUp","Error")}},ck:function(n){_j.e.b(_a.a.l,"Sign-out failed: {0}",n.G.message);this.n("SignOutFailed","SignedOut")},ce:function(n){_j.e.a(_a.a.l,"Reset presence succeeded.")},cc:function(n){_j.e.b(_a.a.l,"Reset presence failed: {1}",n.G.message)},cg:function(n){var t=n;_j.e.a(_a.a.l,"Set presence to {0} succeeded.",t.e)},cf:function(n){var t=n;_j.e.b(_a.a.l,"Set presence to {0} failed: {1}",t.e,n.G.message)},bH:function(n){var t=n;t.o(-2);t.be()},bR:function(n,t,i,r){var f=this.C.b(t,null);var e=new _im.h(n,t,f,i,r);var u=this.hl(_im.c.a);u&&u(e)},bQ:function(n){var t=this.hl(_im.c.a);if(t){var f=n.PayloadType;if(n.PayloadType==="UpdateUserPresence"){var i=n.DisplayName;_j.h.b(i)&&(i=this.X);var o=new _im.h(f,this.O,i,_im.b.b(n.NewUserPresence),!0);t(o);return}if(n.UserPresenceChanges)for(var s=n.PayloadType!=="QueryUserPresenceChange",e=n.UserPresenceChanges,h=e.length,r=0;r<h;++r){var u=e[r];var c=new _im.h(f,u.SipUri,u.UserName,_im.b.b(u.Presence),s);t(c)}}},ca:function(n,t){switch(t.c){case 0:var i=t.a;var r=this.by(i);this.M.i(r);break;case 2:var u=t.b;var f=this.by(u);var e=this.bv(f);this.M.j(e);break;case 1:case 3:default:_a.b.d(!1,"Unexpected notification received: "+t.c);break}},by:function(n){var i=new _j.q;if(n)for(var r=n,u=r.length,t=0;t<u;++t){var f=r[t];this.br(i,f)}return i},bv:function(n){for(var f=this.Y(this.D.d()),i=new _j.q,r=n.d,e=r.length,t=0;t<e;++t){var u=r[t];f.g(u)||i.c(u)}return i},bY:function(n,t){switch(t.c){case 0:var i=t.a;var r=this.Y(i);this.M.i(r);break;case 2:var u=t.b;var f=this.Y(u);var e=this.bv(f);this.M.j(e);break;case 1:case 3:default:_a.b.d(!1,"Unexpected notification received: "+t.c);break}},Y:function(n){var i=new _j.q;if(n)for(var r=n,f=r.length,t=0;t<f;++t){var e=r[t];var u=e;if(u.a()){var o=this;u.a().o(function(n){o.br(i,n)})}}return i},br:function(n,t){var r=t;var i=_im.b.a(r.i());i.localeCompare(this.O)&&(n.g(i)||n.c(i))},bs:function(n){this.ba&&(this.B==="unknown"||!this.Q)&&_j.e.c(_a.a.l,"ChatManager: Do not access {0} until configuration has loaded.",n)},bG:function(){if(this.f()&&this.S&&this.Q){var n=this;_j.m.a().a(_a.a.l,"ChatManager.SignIn",function(){n.k(!1)},5e3)}},bV:function(n){var t=n.e().bD.InstantMessage;var i=n.c().bD.UserDisplayName;var r=n.c().bD.UserSipUri;this.bX(t,i,r);this.bG()},bZ:function(n){if(!n.a){this.H=!1;this.N(!1)}}};_im.f=function(){this.c=Function.createDelegate(this,this.m);_im.f.initializeBase(this);this.a={}};_im.f.prototype={a:null,k:function(){var n=this.a;for(var t in n){var i={key:t,value:n[t]};var r=i.value;r.d(0)}},l:function(n){this.h(n,!1)},e:function(n){this.h(n,!0)},m:function(n){this.d(n.e(),n.b(),n.d(),n.a(),n.c())},d:function(n,t,i,r,u){this.g(n,t,i,u);this.j(n,t,r,u)},b:function(n,t){var i=t;if(_j.h.b(i)&&!_j.h.b(n)){n=_im.b.a(n);var r=this.a[n];r&&(i=r.a);_j.h.b(i)&&(i=_im.b.c(n))}return i},f:function(n,t){t.val=0;n=_im.b.a(n);var i=this.a[n];if(!i)return!1;t.val=i.b;return!0},h:function(n,t){if(!_j.h.b(n.SipUri)){this.g(n.PayloadType,n.SipUri,n.DisplayName,t);if(!_j.u.a(n.NewUserPresence)){var i=_im.b.b(n.NewUserPresence);this.j(n.PayloadType,n.SipUri,i,t)}}},g:function(n,t,i,r){var u=this;this.i(n,t,r,function(n){_j.h.b(i)||n.e(i)})},j:function(n,t,i,r){var u=this;this.i(n,t,r,function(n){_j.u.a(i)||n.d(i)})},i:function(n,t,i,r){t=_im.b.a(t);var u=this.a[t];if(!u){if(!i)return;u=new _im.p(t);this.a[t]=u}r(u)}};_im.p=function(n){_im.p.initializeBase(this);_a.b.c(n,"sipUri");this.c=n};_im.p.prototype={c:null,a:null,b:0,e:function(n){if(this.a===n)return n;this.a=n;this.bw("DisplayName");return n},d:function(n){if(this.b===n)return n;this.b=n;this.bw("Presence");return n},toString:function(){return String.format("SipUri: {0}, DisplayName: {1}, Presence: {2}",this.c,this.a,this.b)}};_im.q=function(n,t,i,r){this.l=Function.createDelegate(this,this.o);this.f=n;this.m=t;this.i=i;this.h=r;this.i.e(this.l);this.h.e(this.l)};_im.q.prototype={m:null,i:null,h:null,f:!1,g:null,k:!1,n:0,b:function(n){if(n&&this.f){if(this.j()){n();return}this.g||(this.g=new Sys.EventHandlerList);this.g.addHandler("chatInitialized",n)}},a:function(){return this.j()&&this.f?this.m:null},e:function(){return this.j()&&this.f?this.i.b():null},d:function(){return this.j()&&this.f?this.h.b():null},c:function(){return this.f},j:function(){if(!this.k&&this.f){this.i.a(null);this.h.a(null)}return this.k||!this.f},o:function(){this.n++;if(this.n===2){this.k=!0;if(this.g){this.g.getHandler("chatInitialized")();this.g=null}}}};_im.r=function(n,t,i,r,u){this.e=n;this.d=t;this.g=i;this.c=r;this.f=u};_im.r.prototype={e:!1,d:null,g:null,c:null,f:0,b:null,a:function(){_a.b.f(this.f,"Mouse","ChatProviderFactory.Create - Layout");this.b||(this.b=new _im.q(this.e,this.d,this.g,this.c));return this.b}};_im.x=function(n,t,i,r){_im.x.initializeBase(this,[n,t,i,r]);_j.e.a(_a.a.l,"PopOutPresenceManager.Ctor.")};_im.x.prototype={o:function(){return new _im.y(this.g)},p:function(n){this.n(n.b(),n.a())},i:function(n){this.f.c(n)},q:function(){}};_im.y=function(n){_im.y.initializeBase(this,[n]);_j.e.a(_a.a.l,"PopOutPresenceRequestsManager.Ctor")};_im.y.prototype={c:function(n){_a.b.c(n,"sipUri");this.d.queryPresenceInMainWindow(n)},j:function(){}};_im.z=function(n,t,i,r){this.j=Function.createDelegate(this,this.p);this.k=Function.createDelegate(this,this.r);this.c={};_im.z.initializeBase(this);_a.b.a(n,"chatManager");_a.b.a(t,"chatParticipantCache");_a.b.a(i,"presenceCrossWindowNotifier");this.d=n;this.h=t;this.d.apcl(_im.c.b,this.k);this.d.j(this.j);this.g=i;this.f=this.o();this.m=r;this.e=this.d.B;_j.e.a(_a.a.bI,"PresenceManager.Ctor.")};_im.z.prototype={d:null,h:null,g:null,m:null,f:null,e:"unknown",l:function(){return this.d.B==="SignedIn"},a:function(n){_j.e.a(_a.a.bI,"PresenceManager.TryRegisterForPresenceUpdates: Registering persona for presence updates:{1}",n||"");if(_j.h.b(n))return null;n=_im.b.a(n);this.s(n);this.i(n);return this.c[n]},b:function(n,t){_a.b.c(n,"sipUri");this.i(n);t.val=0;if(n in this.c){var i=this.c[n];if(i){t.val=i.a();return!0}}return!1},o:function(){return new _im.g(this.g)},i:function(n){if(this.l()){var t;var i,r;(r=this.h.f(n,i={val:t}),t=i.val,r)&&this.n(n,t);n!==_im.b.a(this.d.b())&&this.f.c(n)}},p:function(n){if(this.l()){this.n(n.b(),n.a());this.g.updatePresenceInAllPopOutWindows(n.b(),n.a())}},n:function(n,t){n=_im.b.a(n);if(!(n in this.c))return!1;var i=this.c[n];i.b(t);return!0},q:function(){this.g.updateSignInStateInAllPopOutWindows(this.e)},D:function(){_j.e.a(_a.a.bI,"PresenceManager.InternalDispose.");this.d.rpcl(_im.c.b,this.k);this.d.bE(this.j);this.f.dispose();this.f=null},r:function(n,t){var s=n;var i=this.e;var h=i==="SignedIn";this.e=s.B;var r=this.l();if(h!==r)if(r){_j.e.a(_a.a.bI,"PresenceManager.OnSignInStateChanged: OldSignInState: {0} to NewSignInState: {1}. Requesting presence for every persona active.",i,this.e);var e=this.c;for(var o in e){var a={key:o,value:e[o]};var v=a.key;this.i(v)}}else{_j.e.a(_a.a.bI,"PresenceManager.OnSignInStateChanged: OldSignInState: {0} to NewSignInState: {1}. Resetting presence to Unknown everywhere.",i,this.e);var u=this.c;for(var f in u){var c={key:f,value:u[f]};var l=c.value;l.b(0)}this.f.j();this.h.k()}this.q()},s:function(n){n in this.c||(this.c[n]=this.m.a(n))}};_im.g=function(n){this.h=Function.createDelegate(this,this.m);this.f=Function.createDelegate(this,this.k);this.g=Function.createDelegate(this,this.l);this.e=_im.g.a;this.a=new _a.k;_im.g.initializeBase(this);_a.b.b(n,"presenceCrossWindowNotifier");this.d=n;this.a.p(this.g);_j.e.a(_a.a.bI,"PresenceRequestsManager.Ctor")};_im.g.prototype={d:null,b:null,c:function(n){_a.b.c(n,"sipUri");if(!this.a.j(n)){_j.e.a(_a.a.bI,"PresenceRequestsManager.AddOrUpdatePendingGetRequests: Queuing a presence retrieval request for sip {0}",n);this.a.c(n)}},j:function(){_j.e.a(_a.a.bI,"PresenceRequestsManager.ClearAll: Clearing all pending get presence requests: {0}",this.a.b());this.a.m()},D:function(){_j.e.a(_a.a.bI,"PresenceRequestsManager.InternalDispose.");this.i()},i:function(){if(this.b){_j.e.a(_a.a.bI,"PresenceRequestsManager.CancelBatchGetPresenceRequestsTimer.");this.b=_j.m.a().b(this.b)}},m:function(){this.b=null;var n=this.a.e();var i=n.join("; ");this.a.m();var t=new _im.u(n);t.a(this.f);_a.g.a.a(t)},l:function(n,t){if(this.a.b()>0){if(!this.b){_j.e.a(_a.a.bI,"PresenceRequestsManager.OnPendingGetPresenceRequestsCollectionChanged: Activating timer to run after {0}ms. Current count of pending requests = {1}",this.e,this.a.b());this.b=_j.m.a().a(_a.a.bI,"GetPresence",this.h,this.e)}}else{_j.e.a(_a.a.bI,"PresenceRequestsManager.OnPendingGetPresenceRequestsCollectionChanged: Cancelling timer. Current count of pending requests = {0}",this.a.b());this.i()}},k:function(n){var t=n;var i=t.e.join("; ");if(t.G){_j.e.b(_a.a.bI,"PresenceRequestsManager.OnGetPresenceActionCompleted: Failed with {0} for {1} SipUris: '{2}'",t.G,this.a.b(),i);return}}};_im.A=function(n){this.h=Function.createDelegate(this,this.n);this.f=Function.createDelegate(this,this.l);this.g=Function.createDelegate(this,this.m);this.d=n;this.b=new _j.q;this.c=new _j.q;this.a=new _j.q};_im.A.prototype={d:null,b:null,c:null,a:null,e:!1,i:function(n){for(var i=new _j.q,f=n.d,e=f.length,r=0;r<e;++r){var t=f[r];if(this.a.g(t)){this.a.n(t);continue}this.c.g(t)||this.b.g(t)||i.g(t)||i.c(t)}if(i.d.length>0){this.b.h(i.d);var u=new _im.E(i.d);u.b(this.g);u.c(this.f);this.d.a(u)}},j:function(n){for(var i=0;i<n.d.length;i++){var t=n.d[i];if(this.b.g(t)){this.b.n(t);continue}this.a.g(t)||this.c.g(t)&&this.a.c(t)}this.k()},k:function(){if(this.a.d.length&&!this.e){this.e=!0;var n=this.a.d[0];this.a.j(0);this.c.n(n);var t=new _im.F(n);t.a(this.h);this.d.a(t)}},n:function(n){this.e=!1;this.k()},m:function(n){for(var u=n,r=u.e,f=r.length,t=0;t<f;++t){var i=r[t];this.c.g(i)||this.c.c(i);this.b.n(i)}_j.e.a(_a.a.l,"SubscribeForPresenceUpdates: succeeded.")},l:function(n){for(var i=n,r=i.e,u=r.length,t=0;t<u;++t){var f=r[t];this.b.n(f)}var e=i.e.join(";");_j.e.a(_a.a.l,"SubscribeForPresenceUpdates: failed to subscribe for: {0}.",e)}};_im.h=function(n,t,i,r,u){_a.b.c(n,"source");_a.b.c(t,"sipUri");this.j=n;this.i=t;this.f=i;this.h=r;this.g=u};_im.h.prototype={j:null,i:null,f:null,h:0,g:!1,e:function(){return this.j},b:function(){return this.i},d:function(){return this.f},a:function(){return this.h},c:function(){return this.g},toString:function(){return String.format("Source: {0}, Sip: {1}, DisplayName: {2}, Presence: {3}, IsAboutMeOrMyBuddy: {4}",this.j,this.i,this.f,this.h,this.g)}};_im.b=function(){};_im.b.b=function(n){switch(n){case"Away":return 3;case"BeRightBack":return 3;case"Busy":return 4;case"DoNotDisturb":return 6;case"IdleBusy":return 4;case"IdleOnline":return 2;case"None":return 0;case"Offline":return 1;case"Online":return 2;default:return 0}};_im.b.d=function(n){switch(n){case 2:return"Online";case 3:return"Away";case 5:return"IdleBusy";case 4:return"Busy";case 6:return"DoNotDisturb";case 1:return"Offline";case 0:default:return"None"}};_im.b.a=function(n){_a.b.c(n,"imAddress");var t=n.toLowerCase();t.startsWith("sip:")||(t="sip:"+t);return t};_im.b.c=function(n){_a.b.c(n,"imAddress");var t=n.toLowerCase();t.startsWith("sip:")&&(t=t.substr(4));return t};_im.e=function(n){this.g=Function.createDelegate(this,this.l);this.f=Function.createDelegate(this,this.o);this.j=Function.createDelegate(this,this.q);this.e=Function.createDelegate(this,this.m);this.h=Function.createDelegate(this,this.p);_im.e.initializeBase(this,[n]);_im.e.a++;this.k=".ChatMouseView#Handler."+_im.e.a};_im.e.prototype={k:null,b:null,c:null,d:null,a:null,n:function(){if(!this.a)return null;if(!_j.h.a(this.a.m()))return this.a.m();var t=this.a.a();var n=t.x.length;if(n)if(n===1){var i=t.x[0];return String.format(_nbs.a.qg,i.c())}else return String.format(_nbs.a.NP,n);else return null},G:function(){_j.c.prototype.G.call(this);this.d.bh(!1);this.b.f(100);this.l()},Y:function(){_j.i.prototype.Y.call(this);if(!this.V()){if(this.a){this.a.a().f(this.h);this.a.rpcl(_h.h.c.a,this.e)}this.a=null;return}var n=this.V();this.a=n.a;this.a.a().e(this.h);this.a.apcl(_h.h.c.a,this.e);this.a.apcl(_h.h.e.a,this.j)},H:function(){_j.c.prototype.H.call(this);if(!this.B){this.c.rpcl(_b.p.a.a,this.f);window.removeEventListener("resize",this.g);this.c=null;this.b=null;this.d=null;return}this.b=this.B.a("TranscriptScrollRegion");this.c=this.B.a("TranscriptLabel");this.d=this.B.a("Editor");this.c.apcl(_b.p.a.a,this.f);window.addEventListener("resize",this.g);this.i()},i:function(){var n=this.n();_j.h.a(n)||(window.document.title=n)},p:function(n,t){this.i()},m:function(n,t){this.i()},q:function(n,t){if(this.a.s()){var i=_j.B.e(this.d.z.children,"textarea");i.length>0&&i[0].setAttribute("disabled","true")}},o:function(n,t){var i=this.b.z;var r=i.scrollHeight;i.scrollTop=r-_j.k.g(i)},l:function(){var n=window.innerHeight;n>=425&&(this.b.z.style.height=String.format("{0}px",251+n-425))}};_im.a=function(){};_im.a.$$cctor=function(){_im.a._I()};_im.a.f=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div class='_im_2'> <div class='_im_3 ms-bg-color-neutralLighter'> <div class='_im_4'> <div></div> </div> </div> <div class='_im_5'> <span></span> <div></div> </div> <div class='_im_6 ms-font-weight-regular ms-font-color-neutralSecondary ms-bg-color-neutralLighter ms-border-color-neutralTertiaryAlt'> <span></span> </div> <div class='_im_7 border-color-transparent ms-border-color-neutralTertiaryAlt-hover'></div> </div> </div>";_j.i.a().appendChild(n);return n};_im.a.t=function(n){return n.b()};_im.a.b=function(n){return n.a};_im.a.q=function(n){return n.l()};_im.a.e=function(n){return n.S()};_im.a.r=function(n){return n.t()};_im.a.u=function(n){return n.g};_im.a.s=function(n){return n.f};_im.a.i=function(n){return n.bN};_im.a.v=function(n){return n.c()};_im.a.j=function(n){return n.ca()};_im.a.g=function(n,t){n.ba(t)};_im.a.d=function(n,t){n.a(t)};_im.a.n=function(n,t){n.a(t)};_im.a.h=function(n,t){n.Q(t)};_im.a.o=function(n,t){n.eW(t)};_im.a.w=function(n,t){n.j(t)};_im.a.k=function(n,t){n.bk(t)};_im.a.x=function(n,t){n.r(t)};_im.a.l=function(n,t){n.ch(t)};_im.a.p=function(n,t){n.bS(t)};_im.a.m=function(n,t){n.cc=t};_im.a._I=function(){var n="ChatMouseView";new _j.d(n,function(){_im.a.a[n]===undefined&&(_im.a.a[n]=[null,[[-1,0,["ParticipantsViewModel"],[_im.a.t],null,"DataContext",null,_im.a.g,1,null,null,null]],null,[[-1,0,["Chat","BodyText"],[_im.a.b,_im.a.q],null,"Html",null,_im.a.d,1,null,null,null]],[[-1,0,["Chat","LastMessageAriaLabel"],[_im.a.b,_im.a.e],null,"Text",null,_im.a.n,1,null,null,null],[-1,0,["Chat","LastMessageAriaLabel"],[_im.a.b,_im.a.e],null,"AriaLabel",null,_im.a.h,1,null,null,null]],[[-1,0,["Chat","Status"],[_im.a.b,_im.a.r],null,"Html",null,_im.a.d,1,null,null,null]],[[-1,4,null,null,null,"SizingMode",null,_im.a.p,0,null,null,0,1],[-1,4,null,null,null,"EditorAriaLabel",null,_im.a.m,0,null,null,null,_u.n.Qn],[-1,0,["SendCommand"],[_im.a.u],null,"EnterCommand",null,_im.a.o,1,null,null,null],[-1,0,["EditorCallContext"],[_im.a.s],_im.a.w,"CallContext",_im.a.i,_im.a.k,2,null,null,null],[-1,0,["SendText"],[_im.a.v],_im.a.x,"Content",_im.a.j,_im.a.l,2,null,null,null]]]);var t=_im.a.c.childNodes[0].cloneNode(!0);var i=new _zz.j(_j.a.a(t,[0,3]),_j.b.Instance.a(_y.a),_j.b.Instance.a(_j.o),_j.b.Instance.a(_j.j),_j.b.Instance.a(_b.d),_j.b.Instance.a(_a.f));i.bt("_im_8 ms-font-weight-regular ms-font-color-black");i.eX(!0);var e=new _b.p(_j.a.a(t,[0,2,0]),_j.b.Instance.a(_a.f));var o=new _b.X(_j.a.a(t,[0,1,1]),_j.b.Instance.a(_j.j));var r=new _b.p(_j.a.a(t,[0,1,0]),_j.b.Instance.a(_a.f));var u=new _fce.g(_j.a.a(t,[0,1]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));var f=new _j.c(_j.a.a(t,[0,0,0,0]));f.y("ReadOnlyRecipientWellView");var s=new _fce.g(_j.a.a(t,[0,0,0]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));return new _j.a(t,[s,f,u,r,o,e,i]).l({TranscriptScrollRegion:u,TranscriptLabel:r,Editor:i})},"",_im.d,_im.e,function(n){return new _im.e(n)},!1,!1,!1,0,_im.a.a)};_im.i.registerClass("_im.i");_im.d.registerClass("_im.d",_a.bv);_im.j.registerClass("_im.j",null,_y.fS,_bc.bm);_im.m.registerClass("_im.m",_h.fG);_im.s.registerClass("_im.s",_h.fG);_im.u.registerClass("_im.u",_h.fG);_im.v.registerClass("_im.v",_h.fG);_im.w.registerClass("_im.w",_h.fG);_im.B.registerClass("_im.B",_h.fG);_im.C.registerClass("_im.C",_h.fG);_im.D.registerClass("_im.D",_h.fG);_im.k.registerClass("_im.k",_a.dk);_im.E.registerClass("_im.E",_h.fG);_im.F.registerClass("_im.F",_h.fG);_im.c.registerClass("_im.c",_j.R,_h.bd,_j.bs,Sys.IDisposable);_im.f.registerClass("_im.f",_j.R);_im.p.registerClass("_im.p",_j.R);_im.z.registerClass("_im.z",_j.bZ,_h.cw);_im.x.registerClass("_im.x",_im.z);_im.g.registerClass("_im.g",_j.bZ);_im.y.registerClass("_im.y",_im.g);_im.e.registerClass("_im.e",_j.c);_im.d.b=new _a.e("SendText",String,_im.d,"");_im.d.a=new _a.e("ParticipantsViewModel",_rw.c,_im.d);_im.c.b="SignInState";_im.c.c="IsSignedIn";_im.c.a="Presence";_im.g.a=5e3;_im.e.a=0;_im.a.c=_im.a.f();_im.a.a={};_im.a.$$cctor();
window.scriptsLoaded['microsoft.owa.core.im.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.im.js'] = (new Date()).getTime();
