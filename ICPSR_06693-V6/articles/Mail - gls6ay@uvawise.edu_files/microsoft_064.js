window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.attachments.js'] = (new Date()).getTime();
Type.registerNamespace("_at");_at.ba=function(){this.a={}};_at.ba.prototype={e:function(n){return this.a[_g.q.toString(n).toLowerCase()]},b:function(n,t){this.a[_g.q.toString(n).toLowerCase()]=t;return t},d:function(n){return _g.q.toString(n).toLowerCase()in this.a},c:function(n){var r=n.toLowerCase();var t=this.a;for(var i in t){var u={key:i,value:t[i]};if(u.key===r)return!0}return!1},f:function(){return _ff.i.a(this.a)}};_at.bT=function(n,t,i,r,u,f){_at.bT.initializeBase(this);this.h=n;this.l=t;this.j=i;this.k=r;this.f=u;this.e=f};_at.bT.prototype={l:null,j:null,k:null,h:null,n:null,f:!1,e:null,K:function(n){var t=new _gg.oB(this.L);n.bl(this.h,this.l,this.j,this.k,t,this.J,this.H,this.f,this.e)},cS:function(n,t,i){try{_a.b.c(n,"result");this.n=n;t()}catch(r){i(r)}}};function AttachmentsComponent(){}AttachmentsComponent.$$cctor=function(){_a.t.a().a(AttachmentsComponent)};AttachmentsComponent.prototype={b:function(n,t,i){if(t.a()){var u=this;n.b(_at.F,function(){var t=_bc.n.isInstanceOfType(_g.k.a)?_g.k.a:null;return new _at.g(n.a(_a.E),t?t.d().j():null,t?t.j():null)}).a()}else{var f=this;n.b(_at.F,function(){return new _at.bN}).a()}var e=this;n.b(_at.l,function(){return _at.l.a()}).b(_at.K).b(_db.cZ).a();var o=this;n.b(_at.L,function(){return _at.M.a?new _at.M:null}).a();var s=this;n.b(_a.eX,function(){return i.d()}).a();var r=_at.w.b(i);var h=this;n.b(_at.H,function(){return new _at.H(n.a(_h.o),n.a(_j.o),n.a(_no.c),n.a(_a.r),n.a(_a.f),n.d(_at.R),n.c(_db.A),n.a(_a.bo),r?null:n.a(_at.o),n.a(_a.E),n.c(_db.bg),n.a(_j.j),n.a(_at.t),n.a(_at.L),n.a(_a.eX),n.a(_y.G))}).a();var c=this;n.b(_y.gg,function(){return new _at.bL(n.a(_y.a),n.a(_at.F),n.d(_y.hG),n.d(_bc.G),n.a(_y.iz),n.a(_at.K),r?n.a(_y.bP):null,n.a(_at.H))}).a();var l=this;n.b(_at.bo,function(){return new _at.bo(n.a(_at.K),r?n.a(_at.w):null,n.a(_at.H))}).b(_y.iz).a();var a=this;n.b(_at.w,function(){return new _at.w(n.a(_a.f),n.a(_g.a).n().bD.DownloadTokenRefreshMinutes,n.a(_g.a).n().bD.DownloadUrlBase,n.a(_g.a).c().bD.UserEmailAddress,n.a(_g.a).n().bD.FirstDownloadToken,i.c(),n.a(_a.r))}).b(_y.bP).a();var v=this;n.b(_at.o,function(){return new _at.o(n.a(_a.f),n.a(_g.a).n().bD.DownloadTokenRefreshMinutes,n.a(_g.a).n().bD.DownloadUrlBase,n.a(_g.a).c().bD.UserEmailAddress,n.a(_g.a).n().bD.FirstDownloadToken,i.c(),n.a(_a.r),!1)}).b(_y.cy).a();var y=this;n.b(_at.t,function(){return new _at.t(n.a(_a.f),i.c())}).a();var p=this;n.b(_at.D,function(){return new _at.D}).b(_h.dn)},a:function(){return null}};_at.i=function(){};_at.i.d=function(n){var t=null;n&&(t=n.c());return t};_at.i.b=function(n,t,i){return t?n.g().ReferenceAttachmentsEnabled:i?!0:n.g().ClassicAttachmentsEnabled};_at.i.f=function(n){try{if(n.indexOf("safelinks.protection.outlook.com")>0){var i=new _a.P(n);var t=_a.w.g(i.f);if("url"in t)return decodeURIComponent(t.url)}}catch(r){return n}return n};_at.i.i=function(n){switch(n){case 6:case 5:return!0;default:return!1}};_at.i.h=function(n){if(_j.h.a(n))return n;var t=n.lastIndexOf("/");return t>=1?n.substr(0,t):n};_at.i.a=function(n){return!_j.h.a(n)&&(!!_at.i.c&&n.startsWith(_at.i.c)||n.startsWith(_at.i.g)||n==="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7")};_at.i.e=function(n){return n.e()===4&&!_j.h.a(n.bD.Location)};_at.AttachmentPolicyLevel=function(){};_at.AttachmentPolicyLevel.prototype={undefined:0,block:1,forceSave:2,allow:3};_at.AttachmentPolicyLevel.registerEnum("_at.AttachmentPolicyLevel",!1);_at.K=function(){};_at.K.registerInterface("_at.K");_at.L=function(){};_at.L.registerInterface("_at.L");_at.w=function(n,t,i,r,u,f,e){this.e=t;this.d=i;this.c=r;this.g=f;this.h=e;this.f=n;this.i=!!n&&n.a().B().Enabled&&!_j.h.b(this.d)&&!_j.h.b(this.c)&&!_j.h.b(u);_j.e.a(_a.a.c,"DownloadAuthenticatorFactory constructor: Use download URL base: {0}",this.i);t<1&&(t=1);this.b=new _at.o(this.f,this.e,this.d,this.c,u,this.g,this.h,!1)};_at.w.b=function(n){return n.e().a().dY().Enabled};_at.w.a=function(n,t,i){if(!n)return t.i;var r=_at.i.d(i);return n.a(r)};_at.w.prototype={b:null,i:!1,d:null,e:0,c:null,g:!1,h:null,f:null,a:function(n){_j.h.b(n)&&(n=this.c);var t=this.b;if(t&&t.e===n){_j.e.a(_a.a.c,"DownloadAuthenticatorFactory re-using authenticator for <PII>{0}</PII>",t.e);return t}t.v();_j.e.a(_a.a.c,"DownloadAuthenticatorFactory creating new authenticator for <PII>{0}</PII>",t.e);this.b=new _at.o(this.f,this.e,this.d,n,null,this.g,this.h,!0);return this.b}};_at.bC=function(){_at.bC.initializeBase(this)};_at.bC.prototype={K:function(n){var t=new _gg.rh(this.L);t.explicitLogonUser=this.R;n.bJ(t,this.J,this.H)},cS:function(n,t,i){_j.h.b(n)?i(Error.create("Download token is missing or empty.")):t()}};_at.o=function(n,t,i,r,u,f,e,o){this.r=Function.createDelegate(this,this.u);this.q=Function.createDelegate(this,this.t);this.p=Function.createDelegate(this,this.s);this.f=i;this.e=r;this.l=f;this.o=e;this.m=o;this.n=n;this.h=u;this.i=-1;this.k=!!n&&n.a().B().Enabled&&!_j.h.b(this.f)&&!_j.h.b(this.e);_j.e.a(_a.a.c,"DownloadAuthenticator: Creating new instance for {0}. Use download URL base: {1}, groups: {2}",this.e,this.k,this.m);t<1&&(t=1);if(this.k){this.s();this.g=_j.m.a().e(_at.o.a,"DownloadAuthenticator",this.p,6e4*t);if(this.g){_j.e.a(_at.o.a,"QueuePeriodicCallback succeeded.");this.j=_a.c.b(_at.o.a,"TokenRequestTimer",!1,null)}else _j.e.c(_at.o.a,"QueuePeriodicCallback returned null.");var s=new _a.l;s.c("S",!!this.g);_a.c.c(_at.o.a,"QueuePeriodicCallback",s.toString(),0)}};_at.o.prototype={k:!1,f:null,e:null,l:!1,o:null,m:!1,n:null,g:null,d:null,j:null,i:0,h:null,v:function(){if(this.g){_j.m.a().b(this.g);this.g=null;return!0}return!1},s:function(){var n=new _at.bC;n.b(this.q);n.c(this.r);this.d=_a.c.b(_at.o.a,"TokenRequest",!1,null);this.j&&_a.c.a(this.j);this.j=_a.c.b(_at.o.a,"TokenRequestTimer",!1,null);this.l||(n.R=this.e);this.o.a(n)},t:function(n){this.h=n.N;if(this.d){_a.c.a(this.d);this.d=null}this.i=_a.K.a()},u:function(n){if(this.d){this.d.p="Action failed.";this.d.n=n.O();n.G?_a.c.e(this.d,n.G):_a.c.a(this.d);this.d=null}},a:function(n,t,i,r){if(!n||!n.Id||n.Id.startsWith("smime-")){_j.e.b(_at.o.a,"Attachment URL requires a non-empty and non-SMIME attachment ID.");return null}i||(i=_g.C.a());var u=String.format(i,encodeURIComponent(n.Id));t&&(u+=_g.C.e());if(!this.k||!this.m&&!_j.h.a(r)){_j.h.a(r)||(u=String.format("{0}/{1}",r,u));return u}if(_j.h.a(this.f)){_j.e.b(_at.o.a,"Attachment download URL is not properly configured.");return u}var e=new _a.l;var o=this.i===-1;e.c("F",o);var s=o?_a.c.y():_a.K.a()-this.i;e.a("A",s);e.c("G",!_j.h.a(r));e.c("T",!_j.h.d(this.h));_a.c.c(_at.o.a,"CreateDownloadUrl",e.toString(),0);var f;f=_a.bH.a()&&this.f.indexOf("@")!==-1?this.f+u+"&token="+this.h:this.f+this.e+"/"+u+"&token="+this.h;f=f+"&owa="+window.location.hostname;this.l&&(f=f+"&isc=1");_j.e.a(_at.o.a,"Download URL: {0}",f);return f},c:function(n,t,i,r,u){var f=this.a(n,t,r,u);f&&!i&&(f+="&isImagePreview=True");return f},b:function(n,t,i,r,u){var f=_at.t.c(this.n,n);return f?f.e(t,i,r,u):i}};_at.l=function(n,t){this.e=n||_at.l.g();this.g=t;this.f=this.g?this.e.DirectFileAccessOnPublicComputersEnabled:this.e.DirectFileAccessOnPrivateComputersEnabled;this.h=_at.l.d(this.e.BlockedFileTypes,this.e.ForceSaveFileTypes,this.e.AllowedFileTypes);this.i=_at.l.d(this.e.BlockedMimeTypes,this.e.ForceSaveMimeTypes,this.e.AllowedMimeTypes);this.j=_at.l.f(this.e.ActionForUnknownFileAndMIMETypes)};_at.l.a=function(){_at.l.b||(_at.l.b=new _at.l(_g.a.a().bD.AttachmentPolicy,_g.a.a().R()));return _at.l.b};_at.l.f=function(n){var t;try{t=_j.u.b(_at.AttachmentPolicyLevel,n)}catch(i){t=1}return t};_at.l.g=function(){var n=new _g.fk;return JsonParser.deserialize('{"AllowedFileTypes":[".rpmsg", ".xlsx", ".xlsm", ".xlsb", ".tiff", ".pptx", ".pptm", ".ppsx", ".ppsm", ".docx", ".docm", ".zip", ".xls", ".wmv", ".wma", ".wav", ".vsd", ".vss", ".vst",  ".vdx", ".vsx", ".vtx", ".vsdx", ".vssx", ".vstx", ".vsdm", ".vssm", ".vstm",".txt", ".tif", ".rtf", ".pub", ".ppt", ".png", ".pdf", ".one", ".mp3", ".jpg", ".gif", ".doc", ".bmp", ".avi"],"AllowedMimeTypes":["image/jpeg", "image/png", "image/gif", "image/bmp"],"ForceSaveFileTypes":[".swf", ".spl", ".dir", ".dcr"],"ForceSaveMimeTypes":["Application/x-shockwave-flash", "Application/octet-stream", "Application/futuresplash", "Application/x-director"],"BlockedFileTypes":[".vsmacros", ".msh2xml", ".msh1xml", ".ps2xml", ".ps1xml", ".mshxml", ".gadget", ".mhtml", ".psc2", ".psc1", ".msh2", ".msh1", ".aspx", ".xml", ".wsh", ".wsf", ".wsc", ".vsw", ".vbs", ".vbp", ".vbe", ".url", ".tmp", ".shs", ".shb", ".sct", ".scr", ".scf", ".reg", ".pst", ".ps2", ".ps1", ".prg", ".prf", ".plg", ".pif", ".pcd", ".osd", ".ops", ".mst", ".msp", ".msi", ".msh", ".msc", ".mht", ".mdz", ".mdw", ".mdt", ".mde", ".mdb", ".mda", ".maw", ".mav", ".mau", ".mat", ".mas", ".mar", ".maq", ".mam", ".mag", ".maf", ".mad", ".lnk", ".ksh", ".jse", ".its", ".isp", ".ins", ".inf", ".htc", ".hta", ".hpj", ".hlp", ".fxp", ".exe", ".der", ".csh", ".crt", ".cpl", ".com", ".cnt", ".cmd", ".chm", ".cer", ".bat", ".bas", ".asx", ".asp", ".app", ".adp", ".ade", ".ws", ".vb", ".js"],"BlockedMimeTypes":["application/x-javascript", "application/javascript", "application/msaccess", "x-internet-signup", "text/javascript", "application/xml", "application/prg", "application/hta", "text/scriplet", "text/xml"], "ActionForUnknownFileAndMIMETypes":"ForceSave","BlockWacViewingThroughUI":false,"WacViewableFileTypes":[".doc", ".docx", ".ppt", ".pptx", "xls", ".xlsx"],"WacViewingOnPublicComputersEnabled":true,"WacViewingOnPrivateComputersEnabled":true,"ForceWacViewingFirstOnPublicComputers":false,"ForceWacViewingFirstOnPrivateComputers":false,"DirectFileAccessOnPrivateComputersEnabled":true,"DirectFileAccessOnPublicComputersEnabled":true}')};_at.l.h=function(n){return n===".one"||n===".onepkg"};_at.l.d=function(n,t,i){var r={};_at.l.c(r,i,3);_at.l.c(r,t,2);_at.l.c(r,n,1);return r};_at.l.c=function(n,t,i){if(t)for(var u=t,f=u.length,r=0;r<f;++r){var e=u[r];n[e]=i}};_at.l.e=function(n,t){if(!n)return!1;for(var r=n,u=r.length,i=0;i<u;++i){var f=r[i];if(f===t)return!0}return!1};_at.l.prototype={g:!1,f:!1,j:0,e:null,h:null,i:null,b:function(){return this.e},c:function(){return this.e.WacEditableFileTypes?this.e.WacEditableFileTypes.length:0},a:function(n,t,i,r,u,f,e){!!i!==i&&(i=!0);n&&(n=n.toLowerCase());var s;s=this.k(n,t);var o=!1;var c=!1;var h=!1;if(s!==1&&i&&!r){var l=u&&f&&(t==="application/onenote"||_at.l.h(n));this.m(n,l)&&(o=!0);c=this.l(this.g,o);o&&!e&&(l?h=!0:this.e.WacEditableFileTypes&&n&&(h=_at.l.e(this.e.WacEditableFileTypes,n)))}o||this.f||(s=1);var a=u&&f&&_j.h.a(n)&&t==="application/onenote";return new _at.bB(this.f,s,o,c,h,a||e)},k:function(n,t){var i=this.h[n]||0;if(i===1)return 1;var r=this.i[t]||0;return r===1?1:i===2||r===2?2:i===3||r===3?3:this.j},d:function(n,t){var i=this.a(n,t).a;return i===1||!i},m:function(n,t){var i=this.g?this.e.WacViewingOnPublicComputersEnabled:this.e.WacViewingOnPrivateComputersEnabled;return i&&(t||this.n(n))},l:function(n,t){return t?n?this.e.ForceWacViewingFirstOnPublicComputers:this.e.ForceWacViewingFirstOnPrivateComputers:!1},n:function(n){return _at.l.e(this.e.WacViewableFileTypes,n)}};_at.bB=function(n,t,i,r,u,f){!n&&!i;this.e=n;this.a=t;this.b=i;this.f=r;this.d=u;this.g=f};_at.bB.prototype={a:0,e:!1,f:!1,b:!1,d:!1,g:!1,c:function(){return!this.g&&this.a!==1&&this.e},toString:function(){return String.format("Attachment PolicyLevel: {0}, DirectFileAccessEnabled: {1}, WAC: {2}, ForceBrowserView: {3}, WacEdit: {4}",this.a,this.e,this.b,this.f,this.d)}};_at.V=function(){};_at.V.a=function(n,t,i){n.o(function(n){var u=n;var r=u.g();r.a().b()>0&&_at.V.b(r.a().a(0),t)&&r.a().a(0).bf().n(function(n){var t=n;(!t.a()||_dg.b.isInstanceOfType(t))&&i(r.a().a(0),t)})})};_at.V.b=function(n,t){return!!n.bf()&&!n.bD.IsDraft&&!(t&&_g.b.a.doesIdEqualName(n.bD.ParentFolderId,"deleteditems"))};_at.D=function(){this.g=new FileReader};_at.D.prototype={g:null,h:null,b:function(){return this.g.error},d:function(){return this.h},c:function(){return this.g.result},f:function(n){this.g.onloadend=n;return n},e:function(n){if(_db.by.isInstanceOfType(n)){var t=n;this.g.readAsDataURL(t.c)}else if(_h.bD.isInstanceOfType(n)){var i=n;this.g.readAsDataURL(i.c)}},a:function(n,t,i,r,u){var f=this;this.g.onloadend=function(){if(!f.g.error&&f.g.result){var s=f.g.result.indexOf(",");var l=f.g.result.substring(s+1,f.g.result.length);var h=null;var e=0,o=0;if(u&&f.g.result.length>10&&f.g.result.substring(0,10)==="data:image"){var c=document.createElement("canvas");var a=c.getContext("2d");var n=new Image;n.onload=function(){if(n.height<n.width){o=250;n.height&&(e=o*n.width/n.height)}else{e=250;n.width&&(o=e*n.height/n.width)}_j.e.a(r,"Attachments canvas width={0}, height={1}",e,o);if(e&&o){c.width=e;c.height=o;try{a.drawImage(n,0,0,e,o);h=c.toDataURL("image/jpeg",1)}catch(i){_j.e.b(r,"Failed to get thumbnail with error {0}, ",i.message)}}f.i(f.g.result,l,s,t,h,e,o,r)};n.onerror=function(){_j.e.b(r,"Failed to load thumbnail into image object to get client thumbnail");f.i(f.g.result,l,s,t,h,e,o,r)};n.src=f.g.result}else f.i(f.g.result,l,s,t,h,e,o,r)}else{_j.e.b(r,"File reader failed with error code {0}",f.g.error);i()}};try{this.e(n)}catch(e){this.h=e;_a.o.a().K&&e.name==="NS_ERROR_FILE_ACCESS_DENIED"?_j.e.a(r,"Firefox: failed to read an attachment. Exception: {0}",e.message):_j.e.b(r,"Unexpected exception was thrown by FileReader.ReadAsDataURL: "+e.message);i()}},i:function(n,t,i,r,u,f,e,o){_j.e.a(o,"No error - Reading the file.");n.substring(0,i).indexOf("base64")!==-1?r(t,u,f,e):r(_a.bh.b(t),u,f,e)}};_at.bf=function(){};_at.bf.prototype={a:function(){return new _at.D}};_at.M=function(){};_at.M.b=function(){try{var n="dummyKey";var t="dummyValue";sessionStorage.setItem(n,t);sessionStorage.removeItem(n);return!0}catch(i){return!1}};_at.M.prototype={a:function(n){return sessionStorage.getItem(n)},b:function(n,t){sessionStorage.setItem(n,t)},c:function(n){sessionStorage.removeItem(n)}};_at.u=function(){this.b={}};_at.u.a=function(){_at.u.b||(_at.u.b=new _at.u);return _at.u.b};_at.u.prototype={a:function(n,t){this.b[n]=new _at.u.c(t)},c:function(n){if(n in this.b){var t=this.b[n];if(t.c())delete this.b[n];else return t.a}return null}};_at.u.c=function(n){this.a=n;this.b=Date.now()+36e5};_at.u.c.prototype={b:0,a:null,c:function(){return this.b<Date.now()}};_at.k=function(){};_at.k.g=function(){return _at.k.c("SharepointGroupProvider")};_at.k.c=function(n){if(n in _at.k.a){var t=_at.k.a[n];if(t&&t.AccessTokenExpiry){var i=_a.d.b(t.AccessTokenExpiry);return!!i&&_a.d.get_utcNow().p(1).b(i)<0}}return!1};_at.k.b=function(n,t,i,r,u){var f=r?"SharepointGroupProvider":_g.q.toString(n);if(_at.k.c(f)){var e=_at.k.a[f];var o=_a.d.b(e.AccessTokenExpiry);t&&t(e.AccessToken);_a.d.get_utcNow().p(30).b(o)>0&&_at.k.e(n,null,null,r,u);return}_at.k.e(n,t,i,r,u)};_at.k.e=function(n,t,i,r,u){var e;var o=(e=new _dg.cu,e.DataProviderType=n,e.IsGroupRequest=r,e);var f=_at.k.f();f.onreadystatechange=function(){if(f.readyState===4)if(f.status===200){var e=Sys.Serialization.JavaScriptSerializer.deserialize(f.responseText);var o=r?"SharepointGroupProvider":_g.q.toString(n);_at.k.h(e,o,t,i,u)}else if(i){var s=Error.create(String.format("GetAccessToken failed with HTTP Status code {0}",f.status));i(s)}};f.open("GET",_g.C.p(),!0);f.setRequestHeader("X-OWA-UrlPostData",encodeURI(Sys.Serialization.JavaScriptSerializer.serialize(o)));_at.k.i(f);f.send(null)};_at.k.i=function(n){n.setRequestHeader("X-OWA-Action","GetAccessTokenforDataProvider");n.setRequestHeader(_a.w.c(),_a.w.d())};_at.k.h=function(n,t,i,r,u){if(n.TokenResultCode||_j.h.a(n.AccessToken)){var f=String.format("Access token request failed for token key {0} with response code {1}",t,n.TokenResultCode.toString());_j.e.b(_a.a.c,f);if(n.TokenResultCode===3&&u){_j.e.b(_a.a.c,"Invoking reauth callback. User will need to re-authenticate.");u()}else r&&r(Error.create(f))}else{_at.k.a[t]=n;i&&i(n.AccessToken)}};_at.k.f=function(){return _at.k.d?_at.k.d():new XMLHttpRequest};_at.s=function(){};_at.s.e=function(n,t,i,r){var u=new XMLHttpRequest;u.onreadystatechange=function(){if(u.readyState===4)if(u.status===200){var n=Sys.Serialization.JavaScriptSerializer.deserialize(u.responseText);var f=t?n.thumbnailLink:n.webContentLink;i(f)}else if(r){var e=Error.create(String.format("XHR GetContentUrl for GDrive failed with statusCode: {0}, response body: {1}",u.status,u.responseText));r(e)}};var f="https://www.googleapis.com/drive/v3/files"+(t?"/{0}?fields=thumbnailLink":"/{0}?fields=webContentLink");f=String.format(f,n);u.open("GET",f,!0);_at.s.a(u,null,r,null)};_at.s.g=function(n,t,i){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===4)if(r.status===200)t(Sys.Serialization.JavaScriptSerializer.deserialize(r.responseText));else if(i){var n=Error.create(String.format("XHR GetMimeType for GDrive failed with statusCode: {0}, response body: {1}",r.status,r.responseText));i(n)}};var u=String.format("https://www.googleapis.com/drive/v3/files/{0}?fields={1}",n,"mimeType");r.open("GET",u,!0);_at.s.a(r,null,i,null)};_at.s.h=function(n,t,i,r){var f="name";var e="";switch(t.Paging.Sort.SortColumn){case 2:f="modifiedTime";break;case 1:f="quotaBytesUsed";break}e=t.Paging.Sort.SortOrder?"desc":"asc";var o=t.Paging.Location;var s=String.format("{0}&orderBy=folder,{1} {2}&q=mimeType!='application/octet-stream' and trashed=false and '{3}' in parents","maxResults=1000&fields=files(id,mimeType,name,size,modifiedTime,thumbnailLink)",f,e,_j.h.a(o)?"root":o);var h=String.format("{0}?{1}","https://www.googleapis.com/drive/v3/files",s);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(u.readyState===4)if(u.status===200){var f=Sys.Serialization.JavaScriptSerializer.deserialize(u.responseText);var e=_at.s.c(f,t.AttachmentDataProviderId);i(n,e)}else{var o=Error.create(String.format("XHR GetItems for GDrive failed with statusCode: {0}, response body: {1}",u.status,u.responseText));r(o)}};u.open("GET",h,!0);_at.s.a(u,null,r,function(){var t;var r=(t=new _gg.cv,t.ResultCode=2,t);i(n,r)})};_at.s.c=function(n,t){var r=_at.s.b(n,t);var i;return i=new _gg.cv,i.ResultCode=0,i.TotalItemCount=n.files.length,i.Items=r,i};_at.s.i=function(n,t,i,r){var e=t.Paging.Location;var o=t.Query;var f=_j.h.c("{0}&q=mimeType!='application/octet-stream' and trashed=false and fullText contains '{1}'","maxResults=1000&fields=files(id,mimeType,name,size,modifiedTime,thumbnailLink)",o);_j.h.a(e)||(f=f+_j.h.c(" and '{0}' in parents",e));var s=_j.h.c("{0}?{1}","https://www.googleapis.com/drive/v3/files",f);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(u.readyState===4)if(u.status===200){var f=Sys.Serialization.JavaScriptSerializer.deserialize(u.responseText);var e=_at.s.d(f,t.AttachmentDataProviderId);i(n,e)}else{var o=Error.create(_j.h.c("XHR SearchItems for GDrive failed with statusCode: {0}, response body: {1}",u.status,u.responseText));r(o)}};u.open("GET",s,!0);_at.s.a(u,null,r,null)};_at.s.d=function(n,t){var r=_at.s.b(n,t);var i;return i=new _gg.jz,i.ResultCode=0,i.TotalItemCount=n.files.length,i.Items=r,i};_at.s.f=function(n){var t=n.indexOf("/d/");return n.substring(t+3,n.indexOf("/",t+3))};_at.s.a=function(n,t,i,r){_at.k.b(5,function(i){_at.s.j(n,i);n.send(t)},i,!1,r)};_at.s.j=function(n,t){n.setRequestHeader("Authorization",String.format("Bearer {0}",t))};_at.s.b=function(n,t){for(var e=new Array(n.files.length),u=0;u<n.files.length;u++){var r=n.files[u];var f,i;var o=(i=new _gg.C,i.Name=r.name,i.Size=parseInt(r.size),i.Thumbnail=(f=new _gg.dz,f.Url=r.thumbnailLink,f),i.Modified=r.modifiedTime,i.MimeType=r.mimeType,i.Location=r.id,i.Id=r.id,i.AttachmentProviderId=t,i.ProviderType=5,i.Type=r.mimeType==="application/vnd.google-apps.folder"?1:0,i);e[u]=o}return e};_at.bU=function(){};_at.bU.prototype={files:null};_at.bV=function(){};_at.bV.prototype={id:null,name:null,mimeType:null,thumbnailLink:null,webContentLink:null,modifiedTime:null,size:null};_at.e=function(){};_at.e.o=function(n,t,i,r,u){if(!i){u(Error.create("Can't get file metadata for non-sharing link"));return}_at.e.p(t,n,r,u)};_at.e.p=function(n,t,i,r){var f=String.format("{0}?{1}&{2}",n,"api=srt","expand=thumbnails(select= medium, large)");var u=_at.e.a();u.onreadystatechange=function(){if(u.readyState===4){if(u.status===200){var n=u.responseText;if(!_j.h.a(n)&&_a.P.b(n)){var f=!_j.h.a(t)&&new _a.P(t).a===new _a.P(n).a;_at.e.q(n,f,i,r);return}}if(r){var e=Error.create(String.format("XHR GetFileMetadata failed with statusCode: {0}, response body: {1}",u.status,u.responseText));r(e)}}};u.open("GET",f,!0);u.send(null)};_at.e.q=function(n,t,i,r){var u=_at.e.a();u.onreadystatechange=function(){if(u.readyState===4)if(u.status===200){var n=Sys.Serialization.JavaScriptSerializer.deserialize(u.responseText);var t=n["@content.downloadUrl"];var f=_at.e.g(n,0);var e=_at.e.g(n,1);i(t,f,e)}else if(r){var o=Error.create(String.format("XHR GetFileMetadata failed with statusCode: {0}, response body: {1}",u.status,u.responseText));r(o)}};u.open("GET",n,!0);_at.e.b(u,null,r,t)};_at.e.r=function(n,t,i,r){var f="lastModifiedDateTime";switch(t.Paging.Sort.SortColumn){case 0:f="name";break;case 1:f="size";break}var e="desc";t.Paging.Sort.SortOrder||(e="asc");var s=String.format("orderby={0} {1}",f,e);var h="expand=thumbnails(select=medium)";var c=String.format("select={0},{1},{2},{3},{4},{5},{6}","name","size","lastModifiedDateTime","file","folder","id","webDavUrl");var l=String.format("{0}&{1}&{2}",h,s,c);var a=_j.h.a(t.Paging.FolderId)?"root":t.Paging.FolderId;var o=new _a.P(t.Paging.ItemsEndpointUrl);var v=String.format("{0}/{1}/{2}/children?{3}",String.format("{0}://{1}",o.c,o.a),"_api/v2.0/drive/items",a,l);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(u.readyState===4)if(u.status===200){var f=Sys.Serialization.JavaScriptSerializer.deserialize(u.responseText);var e=_at.e.n(f,t.AttachmentDataProviderId,t.Paging.ItemsEndpointUrl);i(n,e)}else{var o=Error.create(String.format("XHR GetItems failed with statusCode: {0}, response body: {1}",u.status,u.responseText));r(o)}};u.open("GET",v,!0);u.setRequestHeader("Prefer","HonorNonIndexedQueriesWarningMayFailRandomly");_at.e.b(u,null,r,!1)};_at.e.n=function(n,t,i){for(var s=new Array(n.value.length),e=0;e<n.value.length;e++){var r=n.value[e];var o,u;var h=(u=new _gg.C,u.Name=r.name,u.Size=r.size,u.Thumbnail=(o=new _gg.dz,o.Url=r.thumbnails&&r.thumbnails[0]&&r.thumbnails[0].medium?r.thumbnails[0].medium.url:null,o),u.Modified=r.lastModifiedDateTime,u.MimeType=r.file?r.file.mimeType:null,u.Location=new _a.P(r.webDavUrl).e,u.Id=r.id,u.ProviderEndpointUrl=i,u.ChildCount=r.folder?r.folder.childCount:0,u.AttachmentProviderId=t,u.ProviderType=0,u.Type=r.folder?1:0,u);s[e]=h}var f;return f=new _gg.cv,f.ResultCode=0,f.TotalItemCount=n.value.length,f.Items=s,f};_at.e.k=function(n,t,i,r,u,f,e,o,s,h){var l=String.format("{0}/content?{1}",_at.e.f(n,t,i,s),"@name.conflictBehavior=rename");var c=_at.e.a();c.onreadystatechange=function(){_at.e.c(c,h);if(c.readyState===4)if(c.status===200||c.status===201){var n=Sys.Serialization.JavaScriptSerializer.deserialize(c.responseText);f(n,!0)}else{var t=Error.create(String.format("XHR UploadAsSingleSlice failed with statusCode: {0}, response body: {1}",c.status,c.responseText));e(t)}};u&&_at.e.h(u,c);c.open("PUT",l,!0);_at.e.j(c,r,e,o)};_at.e.e=function(n,t,i,r,u,f,e,o){var h=String.format("{0}/upload.createSession",_at.e.f(n,t,i,e));var c='{ "item": {"@name.conflictBehavior": "rename"} }';var s=_at.e.a();s.open("POST",h,!0);s.setRequestHeader("Content-Type","application/json");s.onreadystatechange=function(){_at.e.c(s,o);if(s.readyState===4)if(s.status===200){var n=Sys.Serialization.JavaScriptSerializer.deserialize(s.responseText);var t=n.uploadUrl;r(t)}else{var i=Error.create(String.format("CreateAttachment XHR failed with statusCode: {0}, response body: {1}",s.status,s.responseText));u(i)}};_at.e.b(s,c,u,f)};_at.e.l=function(n,t,i,r,u,f,e,o,s,h){var c=_at.e.a();c.onreadystatechange=function(){_at.e.c(c,h);if(c.readyState===4)if(c.status===200||c.status===201){var n=Sys.Serialization.JavaScriptSerializer.deserialize(c.responseText);e(n,!0)}else if(c.status===202)e(null,!1);else{var t=Error.create(String.format("XHR UploadSlice failed with statusCode: {0}, response body: {1}",c.status,c.responseText));o(t)}};f&&_at.e.h(f,c);c.open("PUT",n,!0);var l=i*r;var a=Math.min(l+r,u);c.setRequestHeader("Content-Range",String.format("bytes {0}-{1}/{2}",l,Math.max(0,a-1),u));_at.e.j(c,t,o,s)};_at.e.m=function(n,t){var i=_at.e.a();i.open("DELETE",n);_at.e.b(i,null,null,t)};_at.e.g=function(n,t){var i=n.thumbnails;if(!i||!i.length)return null;var r=t?i[0].large:i[0].medium;return r?r.url:null};_at.e.j=function(n,t,i,r){_at.k.b(0,function(i){_at.e.i(n,i);_at.e.s(t,n)},i,r,null)};_at.e.b=function(n,t,i,r){_at.k.b(0,function(i){_at.e.i(n,i);n.send(t)},i,r,null)};_at.e.i=function(n,t){n.setRequestHeader("Authorization",String.format("Bearer {0}",t))};_at.e.h=function(n,t){t.upload.onprogress=n};_at.e.s=function(n,t){t.send(n)};_at.e.f=function(n,t,i,r){var u=null;u=r?String.format("{0}/{1}:/{2}:",n,"_api/v2.0/drive/special/attachments",i):_j.h.a(t)?String.format("{0}/{1}:/{2}:",n,"_api/v2.0/drive/root",i):String.format("{0}/{1}:/{2}/{3}:",n,"_api/v2.0/drive/root",t,i);return u};_at.e.a=function(){return _at.e.d?_at.e.d():new XMLHttpRequest};_at.e.c=function(n,t){if(n.readyState===2&&t){var r=n.getResponseHeader("SPRequestGuid");var i=new _a.l;i.b("ODReqId",r);_j.h.a(t.k())?t.i(i.toString()):t.i(t.k()+("|"+i.toString()))}};_at.e.w=function(){};_at.e.w.prototype={name:null,webUrl:null,webDavUrl:null,size:0,id:null,file:null,folder:null,parentReference:null,thumbnails:null,lastModifiedDateTime:null};_at.e.u=function(){};_at.e.u.prototype={childCount:0};_at.e.t=function(){};_at.e.t.prototype={mimeType:null};_at.e.z=function(){};_at.e.z.prototype={id:null,small:null,medium:null,large:null};_at.e.y=function(){};_at.e.y.prototype={height:null,width:null,url:null};_at.e.v=function(){};_at.e.v.prototype={value:null};_at.e.x=function(){};_at.e.x.prototype={id:null,path:null};_at.A=function(n){_at.A.initializeBase(this);this.f=n};_at.A.b=function(){_at.A.a={}};_at.A.prototype={e:null,f:0,K:function(n){var i=new _gg.qY(this.L);var t=new _gg.gQ;t.ClientVersion=this.f;n.bD(t,i,this.J,this.H)},cS:function(n,t,i){try{this.e=new Array(n.length);for(var r=0;r<n.length;r++){var u=n[r].Id;_at.A.a[u]||(_at.A.a[u]=_a.n.c(_gg.v,n[r],_gg.v));this.e[r]=_at.A.a[u]}t()}catch(f){i(f)}}};_at.bp=function(n){_at.bp.initializeBase(this);this.e=n};_at.bp.prototype={e:null,K:function(n){var t=new _gg.nG(this.L);n.bc(this.e,t,this.J,this.H)},cS:function(n,t,i){n?t():i(null)}};_at.bq=function(n){_at.bq.initializeBase(this);this.e=new _gg.fP;this.e.cancellationId=n};_at.bq.prototype={e:null,K:function(n){var t=new _gg.nH(this.L);n.bd(this.e,t,this.J,this.H)},cS:function(n,t,i){n?t():i(null)}};_at.br=function(n){_at.br.initializeBase(this);this.e=new _gg.fQ;this.e.cancellationId=n};_at.br.prototype={e:null,K:function(n){var t=new _gg.nI(this.L);n.be(this.e,t,this.J,this.H)},cS:function(n,t,i){n?t():i(null)}};_at.bs=function(n){_at.bs.initializeBase(this);this.e=n};_at.bs.prototype={e:null,K:function(n){var t=new _gg.nJ(this.L);n.dA(this.e,t,this.J,this.H)},cS:function(n,t,i){n?t():i(null)}};_at.bt=function(n,t){_at.bt.initializeBase(this);this.e=new _gg.fV;this.e.ewsAttachmentId=n;this.e.itemId=t};_at.bt.prototype={e:null,f:null,K:function(n){var t=new _gg.on(this.L);n.dF(this.e,t,this.J,this.H)},cS:function(n,t,i){try{_a.b.a(n,"result");if(n.ErrorMessage)throw Error.create(n.ErrorMessage);this.f=n.ContentId;t()}catch(r){i(r)}}};_at.bu=function(n,t,i,r){_at.bu.initializeBase(this);this.f=new _gg.fW;this.f.subscriptionId=i;this.f.ewsAttachmentId=n;this.f.itemId=t;this.f.channelId=_no.a.a;this.f.cancellationId=r;this.e=n.Id};_at.bu.prototype={f:null,e:null,K:function(n){var t=new _gg.os(this.L);n.bh(this.f,t,this.J,this.H)},cS:function(n,t,i){try{_a.b.a(n,"result");t()}catch(r){i(r)}}};_at.bv=function(n,t,i,r,u,f,e){_at.bv.initializeBase(this);this.e=new _gg.fX;this.e.attachmentDataProviderId=t;this.e.ewsAttachmentId=n.Id;this.e.emailId=i;this.e.subscriptionId=r;this.e.channelId=_no.a.a;this.e.cancellationId=e;this.e.fullPathLocation=u;this.e.PermissionLevel=f;this.f=n.Id};_at.bv.prototype={e:null,f:null,K:function(n){var t=new _gg.ot(this.L);n.bi(this.e,t,this.J,this.H)},cS:function(n,t,i){try{_a.b.a(n,"result");t()}catch(r){i(r)}}};_at.n=function(n,t,i,r,u,f,e,o,s,h,c){_at.n.initializeBase(this);this.o=n;this.j=t;this.q=i;this.s=r;this.r=s;this.l=h;this.p=u;this.u=f;this.t=e;this.D=o;this.k=c};_at.n.b=function(){var n=new XMLHttpRequest;return n.upload&&n.upload.onprogress!==undefined};_at.n.d=function(n,t,i,r,u,f){try{var e=JsonParser.deserialize(n);if(e&&e.Body)if(e.Body.ResponseMessages){var s=e.Body.ResponseMessages.Items[0];if(s.ResponseCode!=="NoError"){_j.e.c(_at.n.a,"Got a attachment error response with {0}",s.ResponseCode);var a=s.MessageText;var l={};l.ResponseCode=s.ResponseCode;f(Error.create(a,l),null)}else{var o=s.Attachments[0];t.g(o.AttachmentId);i.Id=o.AttachmentId.RootItemId;i.ChangeKey=o.AttachmentId.RootItemChangeKey;t.f(o.Size||0);t.j(o.ContentType);t.a()&&t.m(o.ContentId);u(e)}}else{_j.e.c(_at.n.a,"Got no response message in the body; assuming it is a fault response");var c=e;f(Error.create(c.Body.FaultMessage),c.Body)}else{_j.e.c(_at.n.a,"Got no response or response without body");f(Error.create(""),null)}}catch(h){_j.e.c(_at.n.a,"Got exception processing response: {0}, exception: {1}",n,h);n===""&&(h=Error.create(""));f(h,null)}};_at.n.c=function(n,t,i,r){if(!n.IsCancelled){n.Attachments.length>0&&t.g(n.Attachments[0].AttachmentId);if(r){t.a()&&t.m(n.Attachments[0].ContentId);n.Attachments[0].Size>0&&t.f(n.Attachments[0].Size);i.Id=n.Attachments[0].AttachmentId.RootItemId;i.ChangeKey=n.Attachments[0].AttachmentId.RootItemChangeKey}}};_at.n.prototype={u:!1,k:null,o:0,j:null,q:null,e:null,s:null,r:0,l:0,p:null,h:null,f:null,t:null,D:!1,bk:function(){if(this.G||!this.Q||!this.Q.response){_j.e.a(_at.n.a,"No success response because there's an error, or action is not complete.  Error: {0}",this.G);return null}return this.Q.response.result},ba:function(){return this.t&&_at.n.b()?this.bm():_h.cj.prototype.ba.call(this)},bg:function(){var n=null;!_j.h.a(this.p)&&this.u?n=this.p:this.e.Body&&this.e.Body.ParentItemId&&_a.ce.a(this.e.Body.ParentItemId.Id)&&(n=_g.a.a().c().bD.DefaultPublicFolderMailbox);return n},bm:function(){var n=new XMLHttpRequest;var t=this;n.onreadystatechange=function(){if(n.readyState===4)if(n.status===200){var i=Sys.Serialization.JavaScriptSerializer.deserialize(n.responseText);t.bh(t.Q,i)}else{var r=Error.create(String.format('CreateAttachment XHR failed with statusCode: "{0}", response body: "{1}"',n.status,n.responseText));t.bb(r)}};var r=this;var u=function(n){var t=Math.round(n.loaded*100/n.total);r.t(t)};n.upload.onprogress=u;n.open("POST",_g.C.n(),!0);this.e=this.bc();this.bn(n);var i=Sys.Serialization.JavaScriptSerializer.serialize(this.e);if(_dg.d.isInstanceOfType(this.j)&&this.D){n.setRequestHeader("X-OWA-UrlPostData",encodeURI(i));n.send(this.j.c)}else n.send(i);return 1},bn:function(n){n.setRequestHeader("X-OWA-Action","CreateAttachmentFromLocalFile");n.setRequestHeader(_a.w.c(),_a.w.d());var t=this.bg();_j.h.a(t)||n.setRequestHeader("X-OWA-ExplicitLogonUser",t)},K:function(n){this.e=this.bc();if(this.s){this.h=new _gg.oA(this.L);this.h.explicitLogonUser=this.bg();this.h.clientStoreItem=this.o;this.h.isQueued=!1;this.h.palContext=new _g.eV(!1);_j.h.a(this.k)||(this.h.actionName="CreateAttachmentFromLocalFileAction"+this.k);n.bk(this.e,this.h,this.J,this.H)}else{this.f=new _gg.lB(this.L);this.f.explicitLogonUser=this.bg();this.f.clientStoreItem=this.o;this.f.isQueued=!1;this.f.palContext=new _g.eV(!1);_j.h.a(this.k)||(this.f.actionName="CreateAttachmentAction"+this.k);n.d(this.e,this.f,this.J,this.H)}},cI:function(n){this.bj(n)},bj:function(n){_at.n.c(n,this.j,this.q,this.l<=this.r+1)},bc:function(){var i=new _g.e(this.q.Id);i.ChangeKey=this.q.ChangeKey;var t=this.j.v();var n=new _gg.dH(i);n.Attachments=[t];n.RequireImageType=t.IsInline;n.IncludeContentIdInResponse=t.IsInline;n.ClientSupportsIrm=!0;n.CancellationId=this.s;if(this.l!==1){n.SliceNumber=this.r;n.TotalSlices=this.l}return new _gg.dG(this.M(),n)}};_at.bw=function(n,t,i,r,u,f){_at.bw.initializeBase(this,[n,t,i,r,u,f,null,!1,0,1,null]);var e=t.c;this.bi=e};_at.bw.prototype={bi:null,K:function(n){var r=this.bc();var t=new _gg.lB(this.L);this.u&&(t.explicitLogonUser=this.p);t.clientStoreItem=this.o;t.isQueued=!0;for(var u=r.Body.Attachments,f=u.length,i=0;i<f;++i){var e=u[i];if(e.IsInline){t.isQueued=!1;break}}t.palContext=new _g.eV(!0);t.dataFile=this.bi.g();n.d(r,t,this.J,this.H)},cI:function(n){this.bj(n)}};_at.T=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){_at.T.initializeBase(this);this.p=n;this.h=t;this.q=i;this.e=u;this.t=f;this.j=r;this.k=e;this.l=o;this.D=s;this.s=h;this.o=c;this.u=l;this.r=a;this.f=v};_at.T.prototype={p:null,h:null,q:null,e:null,t:null,j:null,k:null,l:null,D:null,s:null,o:!1,u:!1,r:null,f:null,n:null,K:function(n){var t=new _gg.oP(this.L);this.u&&(t.explicitLogonUser=this.e);t.actionName=_j.h.a(this.e)?"CreateReferenceAttachmentFromAttachmentDataProviderAction":"CreateReferenceAttachmentFromAttachmentDataProviderInGroupAction";_j.h.a(this.f)||(t.actionName=t.actionName+this.f);n.bo(this.p,this.h,this.q,this.j,this.k,this.t,t,this.J,this.H,this.l,this.D,this.s,this.o,this.r)},cS:function(n,t,i){try{_a.b.a(n,"result");this.n=n;t()}catch(r){i(r)}}};_at.bx=function(n,t,i){_at.bx.initializeBase(this);this.j=n;this.f=t;this.e=i;this.h=t.bD.AttachmentId||t.bD.TemporaryId};_at.bx.prototype={j:0,f:null,h:null,e:null,cI:function(n){this.e.Id=n.RootItemId.RootItemId;this.e.ChangeKey=n.RootItemId.RootItemChangeKey;this.f.bD.TemporaryId&&this.f.g(this.f.bD.TemporaryId)},K:function(n){var i=new _gg.dL;i.ClientSupportsIrm=!0;var r=new _gg.pf(this.L);r.itemContexts=new Array(1);var t=new _gg.Em;t.clientStoreItem=this.j;t.parentItemId=new _g.e(this.e.Id);t.parentItemId.ChangeKey=this.e.ChangeKey;i.AttachmentIds=[new _g.bh(this.h.Id)];var u=new _gg.gi(this.M());u.Body=i;r.itemContexts[0]=t;n.r(u,r,this.J,this.H)}};_at.by=function(n){_at.by.initializeBase(this);this.f=n};_at.by.prototype={f:null,e:null,K:function(n){var t=new _gg.qS(this.L);n.bC(this.f,t,this.J,this.H)},cS:function(n,t,i){if(_j.h.b(n))i(Error.create("AddIns is null or empty."));else{this.e=n;t()}}};_at.G=function(n,t,i){_at.G.initializeBase(this);this.f=n;this.h=t;this.R=i};_at.G.prototype={f:null,e:null,h:!1,M:function(){return this.W("Exchange2015")},K:function(n){var i=new _dg.dg(this.L);i.explicitLogonUser=this.R;var t=new _gg.gS(this.M());t.Body.AttachmentIds=[new _g.bh(this.f)];t.Body.ShapeName="ItemAttachment";t.Body.AttachmentShape=_h.b.Y();if(this.h){t.Header.ManagementRole=new _g.cW;t.Header.ManagementRole.UserRoles=["MailboxSearch"]}n.bE(t,i,this.J,this.H)},cI:function(n){var t=null;var i=n.Attachments.length;i!==1&&(t="GetAttachment response length = "+i);var r=n.Attachments[0];r||(t="GetAttachment response contained null attachment");var u=_a.n.c(_dg.k,r);this.e=u.k();this.e||(t="GetAttachment response contained null item");t?_j.e.b(_a.a.c,t):_j.e.a(_a.a.c,"GetAttachment succeeded for '{0}' on '{1}'",u.bD.Name,this.e.bD.Subject)}};_at.bz=function(n,t,i){_at.bz.initializeBase(this);this.f=n;this.e=t;this.j=i;this.h=t.bD.AttachmentId||t.bD.TemporaryId;if(!_dg.d.isInstanceOfType(t)&&!_dg.k.isInstanceOfType(t)&&!_g.D.isInstanceOfType(t))throw Error.notImplemented("Only FileAttachment, ItemAttachment and ItemIdAttachment are supported to get content.");};_at.bz.prototype={f:null,e:null,h:null,j:null,ba:function(){if(_dg.d.isInstanceOfType(this.e)){var n=this.e;if(_a.fC.isInstanceOfType(n.c)&&!n.u){var r=n.c;var u=new _at.bf;var f=u.a();var t=this,i=this;f.a(r,function(i,r,u,f){n.k(t.k(i));t.X(null)},function(){var t=String.format("Unable to read content of file {0}.",n.bD.Name);_j.e.b(i.f,t);i.X(Error.create(t))},this.f,!1);return 1}else if(n.u&&n.bD.Content&&n.bD.Content.length>0){this.X(null);return 1}else return this.l()}else return _dg.k.isInstanceOfType(this.e)?this.l():_h.cj.prototype.ba.call(this)},cS:function(n,t,i){var r=this.e;if(_j.h.a(n))i(Error.create(String.format("The MIME content of item {0} cannot be retrieved.",r.bD.ItemId.Id)));else{r.t(this.k(n));t()}},K:function(n){var t=new _g.e(this.e.bD.ItemId.Id);n.ce(t,null,this.J,this.H)},l:function(){var n=new XMLHttpRequest;var r=_dg.k.isInstanceOfType(this.e)?_g.C.a():_g.C.g();var i=String.format(r,encodeURIComponent(this.h.Id));_j.h.a(this.j)||(i=String.format("{0}/{1}",this.j,i));var t=this;n.onreadystatechange=function(){if(n.readyState===4)if(n.status===200){var i=t.k(n.responseText);_dg.d.isInstanceOfType(t.e)?t.e.k(i):_dg.k.isInstanceOfType(t.e)&&t.e.t(i);t.X(null)}else{var r=String.format("Unable to get file attachment content.\nAttachmentId = {0}\nResponseBody = {1}\nStatusText = {2}",t.h.Id,n.responseText,n.statusText);_j.e.c(t.f,r);t.X(Error.create(r))}};n.open("GET",i,!0);_a.m.T(n);n.send(null);return 1},k:function(n){if(n.startsWith("data:")){var t=";base64,";var i=n.indexOf(t);return n.substr(i+t.length)}else return n}};_at.m=function(n){_at.m.initializeBase(this);this.e=n};_at.m.e=function(n){var t=_at.m.c(n);return t?t.FolderName:null};_at.m.d=function(n){var t=_at.m.c(n);return t?t.FolderId:null};_at.m.f=function(){return _at.m.b>=2?!0:!1};_at.m.c=function(n){if(_j.h.a(n)){_j.e.a(_a.a.c,"An invalid key was passed in as an argument.");return null}if(!_at.m.a||!(n in _at.m.a)){_j.e.a(_a.a.c,String.format("No response objects were cached with the given key: {0}",n));return null}return _at.m.a[n]};_at.m.prototype={e:null,h:null,f:null,K:function(n){var t=new _gg.rg(this.L);t.explicitLogonUser=this.e;n.bI(t,this.J,this.H);this.e||_at.m.b++},cS:function(n,t,i){if(!n){i(Error.create("Failed to get valid properties of the default upload folder."));return}var r=this.e||"PersonalOneDriveKey";_at.m.a||(_at.m.a={});this.f=n.FolderName;this.h=n.FolderId;_at.m.a[r]=n;t()}};_at.bA=function(n,t,i,r,u,f,e){_at.bA.initializeBase(this,[n,t,i,r,u,f]);this.f="GetSuiteExtensionsAttachmentInfo";this.p=_j.h.b(e)?null:e};_at.bA.prototype={p:null,K:function(n){var t=new _gg.ri(this.L);this.k&&(t.explicitLogonUser=this.k);this.f+=this.n?"Cloudy":"Classic";this.f+=this.h?"Edit":"Preview";t.actionName=this.f;this.l&&(t.isDiscovery=!0);n.eP(this.j,this.h,this.o,t,this.J,this.H,this.p)},cS:function(n,t,i){this.e=n;if(this.e)if(this.e.Status){var u=Error.create("GetAttachmentInfo was not successful.");i(u)}else{this.h||_at.u.a().a(this.j,this.e);t()}else{var r=new _dg.bu;r.Status=1;r.WacUrl="";this.e=r;i(Error.create("Server unavailable."))}}};_at.bW=function(n,t,i,r,u,f){_at.bW.initializeBase(this);this.j=n;this.h=t;this.o=i;this.n=r;this.k=u;this.l=f};_at.bW.prototype={e:null,f:"GetAttachmentInfo",j:null,h:!1,o:null,n:!1,k:null,l:!1};_at.bd=function(n,t,i,r,u,f,e){_at.bd.initializeBase(this,[n,t,i,r,u,f]);this.f="GetWacAttachmentInfo";_j.h.a(e)||(this.f=this.f+e)};_at.bd.prototype={K:function(n){var t=new _gg.vd(this.L);this.k&&(t.explicitLogonUser=this.k);this.f+=this.n?"Cloudy":"Classic";this.f+=this.h?"Edit":"Preview";t.actionName=this.f;this.l&&(t.isDiscovery=!0);n.cC(this.j,this.h,this.o,t,this.J,this.H,null)},cS:function(n,t,i){this.e=n;if(this.e)if(this.e.Status){this.h||this.e.Status!==9||_at.u.a().a(this.j,this.e);var u=Error.create("GetWacAttachmentInfo was not successful. The status is "+this.e.Status.toString());i(u)}else{this.h||_at.u.a().a(this.j,this.e);t()}else{var r=new _dg.bu;r.Status=1;r.WacUrl="";this.e=r;i(Error.create("Server unavailable."))}}};_at.J=function(n,t,i,r,u,f,e,o){_at.J.initializeBase(this,[_at.i.f(n),t,i,r,f,e]);this.q=n;this.f="GetWacInfoAction";this.p=o};_at.J.prototype={q:null,p:null,K:function(n){var t=new _gg.vf(this.L);this.k&&(t.explicitLogonUser=this.k);this.f+=this.n?"Cloudy":"Classic";this.f+=this.h?"Edit":"Preview";_j.h.a(this.p)||(this.f+=this.p);t.actionName=this.f;this.l&&(t.isDiscovery=!0);var i=new _gg.il;i.Url=this.j;i.IsEdit=this.h;i.ProviderType=0;n.gE(i,t,this.J,this.H)},cS:function(n,t,i){this.e=n;if(this.e)if(this.e.Status){this.h||this.e.Status!==9||_at.u.a().a(this.j,this.e);var u=Error.create("GetWacInfo was not successful. The status is "+this.e.Status.toString());i(u)}else{this.h||_at.u.a().a(this.j,this.e);t()}else{var r=new _dg.bu;r.Status=1;r.WacUrl="";this.e=r;i(Error.create("Server unavailable."))}}};_at.U=function(n,t,i,r,u){_at.U.initializeBase(this);this.e=new _gg.ju;this.e.subscriptionId=i;this.e.ewsAttachmentId=n;this.e.channelId=_no.a.a;this.e.itemId=t;this.e.groupSmtpAddress=r;this.f=u};_at.U.prototype={e:null,f:null,K:function(n){var t=new _gg.zt(this.L);t.actionName="SaveAttachmentsToCloud";if(!_j.h.a(this.e.groupSmtpAddress)){t.explicitLogonUser=this.e.groupSmtpAddress;t.actionName+="_Group"}_j.h.a(this.f)||(t.actionName+=this.f);n.cS(this.e,t,this.J,this.H)},cS:function(n,t,i){try{_a.b.a(n,"result");t()}catch(r){i(r)}}};_at.be=function(n,t,i,r){_at.be.initializeBase(this);this.h=n;this.j=t;this.f=i;this.l=r};_at.be.prototype={h:null,j:0,k:!1,f:null,l:!1,n:null,e:!1,K:function(n){var i=new _gg.Ae(this.L);var t=new _gg.eQ;t.AttachmentIds=this.h;t.PermissionLevel=this.j;t.NewAttachLongPathNames=this.f;t.SetToOriginalPermissionLevel=this.l;n.cY(t,i,this.J,this.H)},cS:function(n,t,i){this.k=!0;if(n&&n.OperationSucceeded){this.n=n;t()}else i(Error.create("Error setting attachment permissions"))}};_at.bX=function(){};_at.bX.prototype={changePermission:0,convertLocalToRef:1,convertRefToLocal:2,copyLinkToClipboard:3,download:4,importIcsAttachment:5,moveAttachmentToInline:6,openInNewTab:7,preview:8,saveToCloud:9,viewInProvider:10,openInASeparateWindow:11,openInClient:12};_at.bX.registerEnum("_at.bX",!1);_at.cb=function(){};_at.cb.registerInterface("_at.cb");_at.bk=function(){};_at.bk.registerInterface("_at.bk");_at.ce=function(){};_at.ce.registerInterface("_at.ce");_at.bP=function(){};_at.bP.prototype={wacPreview:0,documentPreview:1};_at.bP.registerEnum("_at.bP",!1);_at.cd=function(){};_at.cd.registerInterface("_at.cd");_at.bl=function(){};_at.bl.registerInterface("_at.bl");_at.bm=function(){};_at.bm.registerInterface("_at.bm");_at.q=function(){};_at.q.registerInterface("_at.q");_at.bj=function(){};_at.bj.registerInterface("_at.bj");_at.R=function(){};_at.R.registerInterface("_at.R");_at.F=function(){};_at.F.registerInterface("_at.F");_at.cc=function(){};_at.cc.registerInterface("_at.cc");_at.t=function(n,t){this.d=new _at.ba;this.b=new _at.ba;this.f=t;this.e=n};_at.t.c=function(n,t){var i;var r,u;return(u=_at.t.b(t,r={val:i}),i=r.val,u)?_at.t.a(n,i):null};_at.t.a=function(n,t){switch(t){case 0:return new _at.y(n,_u.n.Ey);case 1:return new _at.E(n,_u.n.LM);case 2:return new _at.P(n,_u.n.PK);case 3:return new _at.O(n,_u.n.Db);case 5:return new _at.x(n,_u.n.Fl);case 4:return new _at.X(n,_u.n.BM);case 6:return new _at.bi(n,_u.n.Ny);case 7:return new _at.Q(n,_u.n.Db);case 8:return new _at.Q(n,_u.n.D);default:_j.e.b(_a.a.c,"TryParseDataProviderType: unimplemented data provider type: {0}",t);return null}};_at.t.b=function(n,t){try{t.val=_j.u.b(_g.q,n);return!0}catch(i){t.val=null;_j.e.b(_a.a.c,"TryParseDataProviderType: unknown data provider type: {0}",n);return!1}};_at.t.prototype={f:!1,e:null,h:function(){return this.b.f()>0},i:function(n){this.b!==n&&(this.b=n);return n},a:function(){return this.f?this.c(1):this.c(0)},g:function(n){var t;var i,r;return(r=_at.t.b(n,i={val:t}),t=i.val,r)?this.c(t):null},c:function(n){if(this.d.d(n))return this.d.e(n);var t=_at.t.a(this.e,n);t&&this.d.b(n,t);return t}};_at.H=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.k=n;this.f=t;this.m=i;this.g=r;this.c=u;this.d=f;this.p=e;this.l=o;this.i=s;this.a=h;this.h=c;this.j=l;this.e=a;this.o=v;this.n=y;this.b=p};_at.H.prototype={k:null,f:null,m:null,g:null,c:null,d:null,p:null,l:null,i:null,a:null,h:null,j:null,e:null,o:null,n:null,b:null};_at.I=function(n,t){this.a=n;this.b=t};_at.I.c=function(n,t){var i;i=t?_at.I.b(n):_at.I.a(n);return new _at.I(i,t)};_at.I.a=function(n){var t=!1;if(_at.d.isInstanceOfType(n)){var i=n;t=i.bN.a()}if(!n.bp.e||t||n.bp.f||n.bl.bD.IsSmimeDecoded)return n.bV;switch(n.bp.a){case 3:return n.gw;case 2:return n.bV;case 1:return n.bV;case 0:default:return n.bV}};_at.I.b=function(n){if(n.bl.bD.IsSmimeDecoded)return n.bV;switch(n.br()){case 5:return n.ex;case 3:return n.da;case 1:case 2:return n.bp.a===3?new _j.g(function(){n.bm&&n.bm.cx(n)},_a.a.c):n.bV;default:return _at.I.a(n)}};_at.I.prototype={a:null,b:!1};_at.C=function(n,t,i,r,u){this.c=n;this.e=t;this.d=i;this.b=r;this.a=u};_at.C.prototype={c:null,a:!1,e:null,d:0,b:0};_at.bK=function(n,t,i,r,u){_at.bK.initializeBase(this,[1,"AttachmentUploadDatapoint"]);this.a.S=n;this.a.T=t.toString();this.a.E=i;this.a.X=r;this.a.Z=u.toString()};_at.W=function(n){_at.W.initializeBase(this);this.e=n;var t=this;this.d=new _j.g(function(){t.a(!1)},_a.a.c)};_at.W.prototype={b:!1,e:!1,d:null,c:function(){return this.b},a:function(n){if(this.b===n)return n;this.b=n;this.eH("IsShown");return n},p:function(){return 600},q:function(){return 300},h:function(){return!0}};_at.a=function(n,t,i,r,u,f,e,o,s,h,c){this.gZ=Function.createDelegate(this,this.ju);this.ha=Function.createDelegate(this,this.jv);this.ho=Function.createDelegate(this,this.kz);this.hp=Function.createDelegate(this,this.kA);this.hm=Function.createDelegate(this,this.kx);this.hn=Function.createDelegate(this,this.ky);this.fp=Function.createDelegate(this,this.jC);this.fs=Function.createDelegate(this,this.kC);this.hi=Function.createDelegate(this,this.kl);this.hj=Function.createDelegate(this,this.km);this.hh=Function.createDelegate(this,this.jD);this.gT=Function.createDelegate(this,this.jn);this.gU=Function.createDelegate(this,this.hJ);this.fn=Function.createDelegate(this,this.hK);this.dP=Function.createDelegate(this,this.ij);this.dN=Function.createDelegate(this,this.cp);this.dO=Function.createDelegate(this,this.dZ);this.hk=Function.createDelegate(this,this.ku);this.he=Function.createDelegate(this,this.jz);this.hf=Function.createDelegate(this,this.jA);this.hs=Function.createDelegate(this,this.kD);this.ht=Function.createDelegate(this,this.kE);this.fq=Function.createDelegate(this,this.kn);this.hc=Function.createDelegate(this,this.hL);this.hr=Function.createDelegate(this,this.kB);this.hd=Function.createDelegate(this,this.jy);this.fl=Function.createDelegate(this,this.dT);this.hE=Function.createDelegate(this,this.lG);this.gW=Function.createDelegate(this,this.js);this.hD=Function.createDelegate(this,this.ln);this.hl=Function.createDelegate(this,this.kw);this.hz=Function.createDelegate(this,this.it);this.hw=Function.createDelegate(this,this.kH);this.hv=Function.createDelegate(this,this.kG);this.hF=Function.createDelegate(this,this.lI);this.hb=Function.createDelegate(this,this.jw);this.gS=Function.createDelegate(this,this.jm);this.hy=Function.createDelegate(this,this.kJ);this.gV=Function.createDelegate(this,this.jo);this.gY=Function.createDelegate(this,this.O);this.gX=Function.createDelegate(this,this.jt);this.hB=Function.createDelegate(this,this.iz);this.hg=Function.createDelegate(this,this.jB);this.hA=Function.createDelegate(this,this.iv);this.hx=Function.createDelegate(this,this.ir);this.hC=Function.createDelegate(this,this.ld);this.hu=Function.createDelegate(this,this.kF);this.fL=new _at.bf;_at.a.initializeBase(this);this.bS=c.k;this.iB=c.n;this.bo=c.c;this.ev=c.d;this.fF=f;this.gk=e;this.cZ=o;this.fA=c.h;this.dn=c.j;this.bK=c.e;this.dC=c.o;c.b&&c.b.a&&(this.gy=c.b.a.bD.SPO_RootSiteUrl);this.eo=n.bD.ContentType==="image/gif";if(this.bo){this.en=this.bo.a().b().Enabled;this.gc=this.bo.a().et().Enabled;this.gb=this.bo.a().cr().Enabled;this.cT=this.bo.a().t().Enabled;this.dw=this.bo.a().bQ().Enabled;this.fX=this.bo.a().dH().Enabled;this.er=this.bo.a().jH().Enabled}n||_j.e.c(_at.a.a,"Attachment is null in AttachmentViewModel ctor");var l="";var a,v;if(!_j.h.a(n.bD.Name)&&(v=_at.a.o(n.bD.Name,a={val:l}),l=a.val,v)){n.e(l);this.dh=!0}this.gr(n);this.bF=t;this.bq=c.f;this.cW=c.l;this.bJ=c.g;this.cY=c.m;this.cX=c.a;this.cv=!1;this.dF=!1;this.bm&&this.bm.d()&&(this.es=this.bm.d().h());if(_dg.d.isInstanceOfType(n)){this.bP=n.bD.Content;this.go=!_j.h.a(n.bD.AttachmentOriginalUrl)}this.bw=i;this.bL=r;this.bW=h;this.by=s;this.eA(!this.bw);this.iC(_a.bd.a(n.bD.Name));this.bE=_at.i.d(u);this.iH(this.by.a(this.bu,this.bl.bD.ContentType,!0,this.cO(),!!this.bn(),this.dw,this.dh));this.bl&&this.bl.bD.AttachmentId&&this.eC(this.bp.b);this.cK();this.de();this.fb();this.gE();this.cJ();this.bV=new _j.g(this.hu,_at.a.a);var y=this;this.ed=new _j.g(function(){y.dm(0)},_at.a.a);this.gw=new _j.g(this.hC,_at.a.a);this.ex=new _j.g(this.hx,_at.a.a);this.da=new _j.g(this.hA,_at.a.a);this.ee=new _j.g(this.hg,_at.a.a);this.gp=new _j.g(this.hB,_at.a.a);this.fG=new _j.g(this.gX,_at.a.a);this.fI=new _j.g(this.gY,_at.a.a);this.fD=new _j.g(this.gV,_at.a.a);this.gf=new _j.g(this.hy,_at.a.a);this.fz=new _j.g(this.gS,_at.a.a);this.fJ=new _j.g(this.hb,_at.a.a);this.df=new _j.g(this.hF,_at.a.a);this.gl=new _ff.q(this.hv,_at.a.a);this.gm=new _j.g(this.hw,_at.a.a);this.gn=new _j.g(this.hz,_at.a.a);this.gg=new _j.g(this.hl,_at.a.a);if(this.bo&&this.bo.a().bO().Enabled){this.gB=new _j.g(this.hD,_at.a.a);this.dY=new _j.g(this.gW,_at.a.a)}if(_dg.b.isInstanceOfType(n)&&!i){this.bM=new _at.bO(this.bo);this.bM.c(this.cF(),this.w())}this.kW(u);this.bo&&this.bo.a().gQ().Enabled&&this.hM();this.dg=new _y.bC;this.gx=c.p;this.fH();this.bw||this.ek(null);this.io()&&this.ip()};_at.a.p=function(){return"AttachmentViewModelSaveToCloudNotification"+(_a.d.a().h()+_ff.p.a(0,1e6)).toString()};_at.a.m=function(n,t){if(n.bD.IsSmimeDecoded){t.val=6;return!1}var i=!1;var r=_a.bd.a(n.bD.Name);r&&(i=_at.a.c.g(r.toLowerCase()));if(!i){t.val=6;return!1}var u=_dg.b.isInstanceOfType(n);_j.e.a(_at.a.a,"Attachment Type: {0}",u?"Cloudy":"Local");t.val=7;return!0};_at.a.n=function(n,t){if(n.bD.IsSmimeDecoded||_dg.b.isInstanceOfType(n)){t.val=6;return!1}var i=!1;var r=_a.bd.a(n.bD.Name);r&&(i=_at.a.g.g(r.toLowerCase()));if(!i){t.val=6;return!1}t.val=8;return!0};_at.a.o=function(n,t){t.val=n;if(n.endsWith(".7397C898-8104-4E2E-8926-98082ABAE229.PendingScan")){t.val=n.replace(".7397C898-8104-4E2E-8926-98082ABAE229.PendingScan","");return!0}return!1};_at.a.l=function(n,t){if(n.bD.IsSmimeDecoded){t.val=6;return!1}if(_dg.b.isInstanceOfType(n)){t.val=6;return!1}var i=!1;var r=_a.bd.a(n.bD.Name);r&&(i=_at.a.f.g(r.toLowerCase()));if(!i){t.val=6;return!1}_j.e.a(_at.a.a,"Attachment Type: Local");t.val=9;return!0};_at.a.prototype={bo:null,eo:!1,gc:!1,gb:!1,dw:!1,bE:null,cW:null,fA:null,bV:null,ed:null,gw:null,ex:null,da:null,ee:null,gp:null,fz:null,fG:null,fI:null,fD:null,ec:null,gi:null,gj:null,gf:null,fJ:null,df:null,gl:null,gm:null,gn:null,gg:null,dg:null,bw:!1,bL:!1,en:!1,bF:null,bq:null,cX:null,bO:null,ev:null,bS:null,bJ:null,cY:null,dn:null,fX:!1,er:!1,bl:null,bz:null,eP:null,bx:0,go:!1,bR:0,bC:0,bD:0,et:!1,cf:!1,fE:!1,dU:!1,gG:!1,iq:!1,bp:null,bm:null,ge:!1,cI:!1,eN:null,eG:null,cA:0,cq:null,cL:0,fc:null,cQ:null,dr:null,dW:!1,dX:!1,cm:null,dA:!1,bA:!1,cn:!1,cl:0,fB:null,dt:!1,eq:!1,cv:!1,dF:!1,bu:null,db:null,bZ:null,cx:!1,eF:!1,ds:null,dj:null,du:!1,bP:null,eu:null,cz:null,bB:null,cw:null,dB:null,dk:null,dl:null,cG:!1,ea:null,bt:null,bU:!1,em:!1,fF:null,cZ:null,dH:null,gx:null,cR:!1,bT:!1,dV:null,cB:null,bH:0,cc:1,dG:0,bQ:null,es:!1,bW:null,bK:null,dC:null,by:null,cU:!1,ey:null,dz:null,dy:null,bY:0,bX:0,eR:null,cu:null,di:null,gy:null,bG:null,gk:null,fd:null,gA:!1,dd:!1,ci:!1,gB:null,dY:null,cg:0,bM:null,iB:null,bs:null,cT:!1,cV:null,ch:function(n){if(this.cg!==n&&this.cd()){this.cg=n;this.eH("ProgressBarValue");this.eH("ShowProgressBar");this.cg||this.dI()}return n},dh:!1,kh:function(){return!!this.cg},gz:function(){_j.e.a(_at.a.a,"Starting attachment upload.");var t=this,n=this;_g.k.a.E("CreateAttachment",this.hE,this.jx(),function(n){_j.e.a(_at.a.a,"Upload attachment enqueued. UploadOnlineOnlyAttachment will be called when we have connection to the server.")},function(t){_j.e.b(_at.a.a,"Enqueueing upload attachment failed: {0}",t.message);n.ck(1,_at.r.a(t),!0);n.dS(null)})},kU:function(n){this.dv=n;this.cj();return n},fw:!1,ft:null,fv:!1,dQ:null,fy:null,bg:function(n){this.fy=n;return n},N:function(n){this.eM("OnUploadCompleteEvent",n)},B:function(n){this.eO("OnUploadCompleteEvent",n)},jk:function(n){this.eM("OnUploadFailedEvent",n)},ba:function(n){this.eO("OnUploadFailedEvent",n)},K:function(n){this.eM("OnDeleteCompleteEvent",n)},Y:function(n){this.eO("OnDeleteCompleteEvent",n)},L:function(n){this.eM("OnDownloadCompleteEvent",n)},Z:function(n){this.eO("OnDownloadCompleteEvent",n)},J:function(n){this.eM("OnCancelCompleteEvent",n)},kN:function(n){this.eO("OnCancelCompleteEvent",n)},M:function(n){this.eM("OnSetSharingSettings",n)},A:function(n){this.eO("OnSetSharingSettings",n)},dc:function(n){if(n!==this.eR){this.eR=n;this.eQ(["ThumbnailInfo","IsThumbnailImage","ShowDefaultImage","IsSuiteExtensionIconSupported"])}return n},ca:function(n){if(this.bx!==n){this.bx=n;this.eQ(["ShouldShowSaveToCloudLabel","SaveFileToCloudStatus","SaveToCloudLabel","ShouldShowSaveToCloudCompletedClickableLabel","SaveToCloudCompletedClickableLabel","ShouldSizeBeHidden","ShouldAffordanceMenuBeHidden","ShouldShowContextMenuOnClick","IsViewHovered","ShouldShowCompletedStatusIcon","ShouldShowFailedStatusIcon","ShouldShowActivityIndicatorInline"])}return n},gs:function(n){if(this.bR!==n){this.bR=n;this.eQ(["ShouldShowAddToCalendarLabel","AddToCalendarLabel","ShouldSizeBeHidden","ShouldAffordanceMenuBeHidden","ShouldShowContextMenuOnClick","IsViewHovered","ShouldShowCompletedStatusIcon","ShouldShowFailedStatusIcon","ShouldShowActivityIndicatorInline"])}return n},kc:function(){return this.cf&&!!this.bx&&this.bx!==1&&!this.id()},id:function(){return this.cT&&this.bx===3},jV:function(){return this.bR===2||this.bR===1},jR:function(){if(!this.bn()||!this.b())return"";switch(this.n()){case 3:return _nbs.a.kf;case 4:return _nbs.a.vx;case 6:return _nbs.a.OF;case 5:return _nbs.a.aE;case 1:return this.b().t();case 2:return this.b().g();default:return""}},hY:function(){switch(this.bx){case 1:return _j.h.a(this.bE)?String.format(_nbs.a.tk,this.bm.i()):_nbs.a.GQ;case 2:return _j.h.a(this.bE)?String.format(_nbs.a.Jb,this.bm.i(),this.bm.g()):String.format(_nbs.a.nr,this.bm.g());case 3:return String.format(_nbs.a.hn,this.bm.g());case 4:return String.format(_nbs.a.YA,this.bm.g());case 5:return _nbs.a.ty;default:return null}},jS:function(){return String.format(_nbs.a.vV,this.bm.i())},jE:function(){if(this.bR===2)return _nbs.a.EL;else if(this.bR===1)return _nbs.a.Mp;return null},jU:function(){return this.bx===2||this.bR===1||this.dp()},ib:function(){if(this.cd())return!1;var n=!1;(this.cv||this.bl&&!this.bl.bD.AttachmentId)&&(n=!0);if(n!==this.dF){this.dF=n;this.dI()}return this.dF},dp:function(){return this.bC===2||this.bC===4||this.bD===2||this.bD===4},fS:function(){return this.fX&&!this.bw},jP:function(){return this.fS()&&this.bm.z()===3},jO:function(){return this.fS()&&this.bm.z()===4},kM:function(n){this.es=n;this.cj()},cd:function(){var n=new XMLHttpRequest;if(_at.n.b()&&this.bo)return _dg.b.isInstanceOfType(this.bl)?this.bo.a().dG().Enabled:this.bo.a().hq().Enabled;else{_j.e.a(_at.a.a,"AttachmentViewModel.IsProgressBarEnabled: Unable to find Progress support in XHR");return!1}},hM:function(){var t=this;var i=function(){return t.bW.a(t.bl.bD.AttachmentId,t.bL,_g.C.a(),t.bE)};if(_dg.d.isInstanceOfType(this.bl)){var n=_a.bd.a(this.bl.bD.Name).toLowerCase();if(this.bl.bD.IsSmimeDecoded)this.bs=new _at.bg;else if(this.cS(this.bl.bD.Name))this.bs=new _at.bE;else if(this.bp.b)this.bs=new _at.bJ;else if(this.bo.a().bV().Enabled&&SuiteExtensions.ControlFactory.CreateControl(n,1)){var r=!!SuiteExtensions.ControlFactory.CreateControl(n,0);this.bs=new _at.bH(r)}else this.bs=this.cs()?new _at.bG:this.ep()?new _at.bF:_at.a.c.g(n)?new _at.bD:_at.a.g.g(n)?new _at.bI:_at.a.f.g(n)?new _at.bh:new _at.bg}else _dg.b.isInstanceOfType(this.bl)?this.bs=null:(_dg.k.isInstanceOfType(this.bl)||_g.D.isInstanceOfType(this.bl))&&(this.bs=new _at.bh);this.bs&&this.bs.o(this.bq,this.bF.a(),this.bo,this.bL,this.bw,i,this.bm)},eX:function(n){this.cv=n;this.cv||this.eB(!1);this.eL("ShouldShowActivityIndicator","IsViewHovered")},iM:function(){this.eQ(["ShouldShowFailedStatusIcon","ShouldShowActivityIndicatorInline","ShouldAffordanceMenuBeHidden","ShouldShowContextMenuOnClick","ShouldSizeBeHidden","ShowDeleteButton","ShowCancelButton","IsConvertAttachmentInProgress"]);this.cJ();this.hM()},p:function(n){if(this.bC!==n){this.bC=n;this.gE();this.eL("ShouldShowConvertLocalToRefAttachmentLabel","ConvertLocalToRefAttachmentLabel");this.iM()}return n},i:function(n){if(this.bD!==n){this.bD=n;this.eL("ShouldShowConvertRefToLocalAttachmentLabel","ConvertRefToLocalAttachmentLabel");this.iM()}return n},hQ:function(){if(this.bC){if(this.bC===3)return String.format(_nbs.a.YA,this.bm.g());else if(this.bC===2)return String.format(_nbs.a.EQ,this.bm.i(),this.bm.g());else if(this.bC===4)return _nbs.a.Gd}else return null;return String.format(_nbs.a.ai,this.bm.i())},hR:function(){if(this.bD){if(this.bD===3)return _u.n.Ja;else if(this.bD===2)return _u.n.SB;else if(this.bD===4)return _nbs.a.Gd}else return null;return _u.n.NC},jZ:function(){return this.eh()&&!!this.bC&&this.bC!==1},ka:function(){return this.ei()&&!!this.bD&&this.bD!==1},eh:function(){return!!this.bm&&!this.bm.e()&&!_dg.b.isInstanceOfType(this.bl)&&this.br()!==4&&!this.bl.a()&&this.bm.y()&&!this.bm.c()&&!_j.h.a(this.bm.i())&&!!this.by.e&&this.by.e.ReferenceAttachmentsEnabled&&!this.eg()},ei:function(){return!!this.bm&&!!this.by.e&&this.by.e.ClassicAttachmentsEnabled&&!this.bm.e()&&_dg.b.isInstanceOfType(this.bl)&&!this.bl.k()&&this.br()!==4&&this.bm.y()&&!this.bm.c()&&!_j.h.a(this.bm.i())&&!this.kt()&&!this.eg()&&!this.H()&&!!this.b()},bj:function(){this.dk=_a.c.b(_a.a.c,"ConvertLocalAttachmentToReferenceAttachment",!1,null);this.dk.r=new _a.bu(103,2,!0)},bk:function(){this.dl=_a.c.b(_a.a.c,"ConvertRefToLocalAttachment",!1,null);this.dl.r=new _a.bu(104,2,!0)},Q:function(){_a.c.a(this.dk);this.dk=null},R:function(){_a.c.a(this.dl);this.dl=null},v:function(n,t){if(!this.bM){_j.e.b(_a.a.c,"Cannot add sharing link. The handler is null.");return}this.bM.c(n,t)},hG:function(n,t){if(!this.bM){_j.e.b(_a.a.c,"Cannot add sharing capability. The handler is null.");return}this.bM.d(n,t)},h:function(n){if(!this.bM){_j.e.b(_a.a.c,"Cannot get sharing link. The handler is null.");return null}return this.bM.h(n,this.bn().bD.ProviderType)},s:function(n){if(!this.bM){_j.e.b(_a.a.c,"Cannot get sharing capability. The handler is null.");return!1}return this.bM.g(n)},jQ:function(){this.cf&&this.bx&&this.bx!==1?this.cU=!0:this.ib()&&(this.cU=!0);return this.cU},eB:function(n){if(n!==this.cU){this.cU=n;this.eH("IsViewHovered")}return n},bb:function(n){this.cz=n;return n},br:function(){this.cA||(this.cA=this.ej());return this.cA},a:function(){return this.bl},gr:function(n){var t=this.bl;if(t!==n){t&&t.F(this.fl);this.bl=n;var i=!n;if(!i){n.I(this.fl);_j.e.a(_a.a.c,"Attachment: {0}",n.bD.Name)}this.ih(i?null:n.bD.AttachmentId);this.eQ(["Attachment","ReferenceAttachment","ReferenceAttachmentUrlHostName","ShowReferenceAttachmentsColorTreatment","ShowRegularAttachmentsColorTreatment"]);this.cJ();this.dI();this.eL("ShouldShowActivityIndicator","IsViewHovered")}return n},n:function(){return this.bn()?this.bn().t():0},q:function(n){this.bn()&&this.bn().t()!==n&&this.bn().E(n);this.cJ();this.cj();return n},fR:function(){return this.bn()?this.bn().H():0},w:function(){return this.bn()?this.bn().bD.AttachLongPathName:null},C:function(n){this.bn()&&this.bn().bD.AttachLongPathName!==n&&this.bn().z(n);return n},kO:function(n){this.dX=n;this.dX&&(this.dW=!0);return n},bn:function(){return _dg.b.isInstanceOfType(this.bl)?this.bl:null},jF:function(){var n=null;if(this.bn())n=this.hX();else{var t=new _b.ba;n=t.a(this.bl.b(),null)}return String.format("{0} {1}",this.bl.bD.Name,n)},hX:function(){if(this.bn()&&!_j.h.b(this.bG)){var t=new RegExp("^https?\\:\\/\\/([\\w\\.-]+)(?:\\:[0-9]{1,4})?.*$");var n=t.exec(this.bG);return n&&n.length>1?n[1].toLowerCase():this.bG}return""},b:function(){return this.bn()&&!_j.h.a(this.bn().bD.ProviderType)?this.bK.g(this.bn().bD.ProviderType):null},fx:null,r:function(){return this.fx},bv:function(){return this.bl&&this.bl.bD.AttachmentId?this.bl.bD.AttachmentId.Id:null},cN:function(){if(!this.bn())return!1;if(this.bn().bD.ProviderType===_g.q.toString(5))return!!this.bn().bD.ContentType&&_db.m.f.g(this.bn().bD.ContentType.toLowerCase());else{var n=_a.bd.a(this.bn().bD.Name);return _j.h.a(n)?!1:_db.m.d.g(n.toLowerCase())}},cs:function(){return this.br()===1||this.br()===2||this.cN()},jM:function(){return this.cN()&&this.bq.c()},dD:function(n){this.ge=n;this.eH("IsSelected");return n},hT:function(){if(this.bs)return this.bs.c()===6;if(this.bp.b||!this.bo||!this.bo.a().bV().Enabled)return!1;if(this.bl&&!(this.dz!=null)){var n=_a.bd.a(this.bl.bD.Name).replace(".","");this.dz=!!SuiteExtensions.ControlFactory.CreateControl(n,1)}return this.dz!=null?this.dz:!1},fO:function(){if(this.bs)return this.bs.k();if(this.bp.b||this.z()||!this.bo||!this.bo.a().bV().Enabled)return!1;if(this.bl&&!(this.dy!=null)){var n=_a.bd.a(this.bl.bD.Name).replace(".","");this.dy=!!SuiteExtensions.ControlFactory.CreateControl(n,0)}return this.dy!=null?this.dy:!1},jK:function(){return this.b()?this.b().h():!1},cH:function(n){if(this.bz!==n){this.bz=n;_j.e.a(_at.a.a,"Attachment download URL: {0}",this.bz);this.eH("DownloadUrl")}return n},bh:function(n){if(this.et!==n){this.et=n;this.eH("IsTriggeredPolicyTip")}return n},eA:function(n){this.fE=n;this.eL("CanDelete","ShowDeleteButton");return n},dR:!1,D:function(n){this.dR=n;return n},bc:function(n){this.dU=n;this.eL("AttachmentWellPendingRefresh","ShowDeleteButton");return n},kg:function(){return(this.fE||this.dU)&&!this.dp()},ke:function(){return this.bC===2&&this.bC!==4||this.bD===2&&this.bD!==4},gv:function(n){this.bw||this.ef()||this.eA(!n);this.gG=n;this.eH("UploadInProgress");return n},eC:function(n){this.iq=n;this.eH("OpenDocumentInBrowserLinkVisible");return n},iH:function(n){this.bp=n;this.cA=this.ej();this.dE();return n},X:function(){return this.bm},kW:function(n){if(n!==this.bm){this.bm=n;this.bm&&this.kp();this.eH("ParentWell")}return n},c:function(){return this.cI},eD:function(n){if(this.cI!==n){this.cI=n;this.bm&&this.bm.bU(this);this.eH("ShouldBeHidden")}return n},gu:function(n){if(this.dA!==n){this.dA=n;this.eH("PendingNonHtml5Upload")}return n},fU:function(){this.cf&&this.bx&&this.bx!==1&&(this.cx=!0);this.eh()&&this.bC&&this.bC!==1&&(this.cx=!0);this.ei()&&this.bD&&this.bD!==1&&(this.cx=!0);this.bR&&(this.cx=!0);return this.cx},kY:function(n){if(this.cx!==n){this.cx=n;this.eH("ShouldSizeBeHidden")}return n},kb:function(){return this.bC===3||this.bD===3||this.bx===4||this.bR===3},jX:function(){return this.bx===3&&!this.go||this.bR===2},hZ:function(){return this.bR===1||this.cf&&this.bx===2||(this.eh()||this.ei())&&this.dp()||this.cv||!this.bl||!this.bl.bD.AttachmentId||!this.cr()||!this.cr().p.x.length},kX:function(n){if(this.bG!==n){this.bG=n;this.eH("ReferenceAttachmentOpenUrl")}return n},ct:function(){return!1},hV:function(){return!1},iI:function(n){if(this.eF!==n){this.eF=n;this.eH("ShowPermissionsTextInCompose")}return n},iC:function(n){if(this.bu!==n){this.bu=n;this.eH("FileExtension")}return n},la:function(n){this.eN=n;this.eH("SubmitUploadFormCommand");return n},kZ:function(n){this.eG=n;this.eH("SubmitUploadAndShareFormCommand");return n},o:function(){this.eP||(this.eP=_at.a.p());return this.eP},W:function(){return this.bV},x:function(){return this.ec},kS:function(n){this.cq=n;_j.e.b(_at.a.a,"Attachment form upload error: {0}",this.cq);this.eH("FormUploadError");return n},kR:function(n){this.cL=n;_j.e.b(_at.a.a,"Attachment form upload error code: {0}",this.cL);this.eH("FormUploadAttachmentError");return n},iJ:function(n){this.fc=n;this.eH("UploadSuccessResponse");return n},fQ:function(){return!1},m:function(){return this.bA},S:function(){return this.cl},j:function(){return this.bZ},g:function(n){this.bZ=n;return n},fN:function(){var n;n=this.eo?this.fV(_at.a.d,this.bl.bD.AttachmentId,_g.C.a()):this.fV(_at.a.d,this.bl.bD.AttachmentId,_g.C.f());_j.e.a(_at.a.a,"Image preview URL: {0}",n);return n},hU:function(){return this.bn()&&this.bG?this.bG:null},V:function(){var n=this.bW.a(this.bl.bD.AttachmentId,this.bL,_g.C.a(),this.bE);_j.e.a(_at.a.a,"Image preview URL: {0}",n);return n},fP:function(){var n=this.bW.a(this.bl.bD.AttachmentId,this.bL,_g.C.a(),this.bE);_j.e.a(_at.a.a,"Media URL: {0}",n);return n},cE:function(){return this.fV(_at.a.h,this.bl.bD.AttachmentId,_g.C.d())},lb:function(n){if(this.dd!==n){this.dd=n;this.eL("ThumbnailLoadSucceeded","ShouldShowThumbnailPlaceholder")}return n},kd:function(){return this.z()&&!this.dd},z:function(){var n=this.cN()&&!!this.b()&&(!_j.h.a(this.bn().bD.AttachmentThumbnailUrl)||this.b().l());return n||this.ig()?this.bp.a===3:!1},kf:function(){return!this.z()&&!this.fO()},jJ:function(){if(this.ds)return this.ds;var n;n=this.bs?this.bs.a()===1:_a.g.b&&this.br()===5?!1:this.cC()?this.br()===5||!this.ce()&&(!this.bL||this.bL&&this.br()!==3):this.br()===5||this.bF.a()==="Mouse"&&this.br()!==3;_j.e.a(_at.a.a,"IconLinkViewModel preview = {0}",n);this.ds=_at.I.c(this,n);return this.ds},cr:function(){if(!this.dj){var n=new Array(0);this.dj=new _fm.e(n)}return this.dj},kP:function(n){this.dj=n;this.eH("ContextMenu");return n},T:function(){return this.bO},iF:function(n){if(this.du!==n){this.du=n;this.de()}return n},y:function(){return this.dt},iE:function(n){if(this.dt!==n){this.dt=n;this.eH("IsDeleted")}return n},jI:function(){if(this.bn())if(_j.h.b(this.bG)){if(this.bn().bD.AttachLongPathName)return this.bl.bD.Name+"\n \n"+this.bn().bD.AttachLongPathName}else return this.bl.bD.Name+"\n \n"+this.bG;return this.bl.bD.Name},kT:function(n){this.bT!==n&&(this.bT=n);return n},gt:function(n){if(this.cR!==n){this.cR=n;this.eH("IsCancelling")}return n},fM:function(){_a.b.d(this.br()===5,"Invalid Operation: EmbeddedItemClass should only be invoked when the Attachment is an ItemAttachment");return this.bl.y()},U:function(){return this.bP},bd:function(n){this.bP=n;return n},jL:function(){return!!this.bo&&!!this.by&&!!this.by.e&&this.bo.a().bb().Enabled&&this.by.e.AttachmentDataProviderAvailable},cC:function(){return this.bn()&&!this.b()?!1:this.bp.a===2?!1:this.bq.e()?!1:this.cO()?!1:this.bs?this.bs.b():this.jM()?!1:this.dx()&&!this.gd()?!1:this.im()||this.ga()||this.ep()||this.hT()||this.br()===1||this.br()===2||this.br()===7||this.br()===10||this.br()===8||this.br()===12||this.kq()},ce:function(){return this.bq.e()||!this.bw&&this.bF.a()==="TouchWide"||!!this.bo&&this.bo.a().hC().Enabled},l:function(){return this.cG},t:function(n){this.cG=n;n&&this.eC(!1);return n},iG:function(n){if(this.bU!==n){this.bU=n;this.eQ(["IsOpenedInLightBox","ShowReferenceAttachmentsColorTreatment","ShowRegularAttachmentsColorTreatment"])}return n},kj:function(){return!this.bU&&!this.hS()},ki:function(){return!this.bU&&this.hS()},hS:function(){return!!this.bo&&this.bo.a().ji().Enabled&&!!this.bn()},eg:function(){_j.e.a(_a.a.a,"AttachementName={4}, IsComposedInLightBox={5}, ParentWellIsNULL={0}, isOpenedInLightBox = {1}, this.parentWell.IsReadOnly={2}, WacEdit={3}",!this.bm,this.bU,this.bm.e(),this.bp.d,this.bl?this.bl.bD.Name:"null",this.bU&&!this.bm.e()&&this.bp.d);return this.bm?this.bU&&!this.bm.e()&&this.bp.d&&this.em:!1},iD:function(n){if(this.em!==n){this.em=n;this.eH("IsComposedInLightBox");this.eg()?this.eA(!1):this.eA(!this.bw);this.bm.e()||this.cj()}return n},bI:function(){!this.dV&&this.ef()&&(this.dV=(new Date).getTime().toString());return this.dV},lc:function(n){if(this.fd!==n){this.fd=n;this.eH("WacStaticAssetsPreloadUrl")}return n},jY:function(){return this.dq()&&!this.hZ()},f:function(){return this.bY},bf:function(n){this.bY=n;return n},e:function(){return this.bX},be:function(n){this.bX=n;return n},iK:function(n){if(this.cT&&!_j.h.a(n)){this.bl.G(n);this.cj()}},ef:function(){var n=!!this.bo&&this.bo.a().iM().Enabled;return!n||this.bq.c()||this.bq.t()?!1:!this.bm.c()||!!this.cW&&this.cW.a(this.bm.c(),"AttachmentUploadCancellation")},cM:function(){var n=!!this.bl.bD.AttachmentId;var t=n?this.bl.bD.AttachmentId.Id:null;var i=t?_bc.h.b(t):!1;var r=this.bp.c();_j.e.a(_at.a.a,"UpdateUrl: idExists={0}, isClientId={1}, policyInfo: {2}",n,i,this.bp.toString());return n&&r&&!i&&!this.bl.p()},cP:function(){return!this.bm.d()||this.bm.d().i()!==1},dq:function(){return this.bp.a===2&&this.bF.a()==="Mouse"},jH:function(){return!_dg.b.isInstanceOfType(this.bl)&&!_j.h.a(this.bl.bD.AttachmentOriginalUrl)},hP:function(){return this.bn()?this.b()?this.b().b(this.cF()):[7]:_at.a.i},ig:function(){return!_a.g.b&&!!this.bo&&this.bo.a().dq().Enabled&&this.jN()&&!this.bl.a()&&!this.bn()&&(this.bl.b()<10485760||this.bo.a().kZ().Enabled)},jN:function(){return this.cs()||this.bw&&this.cS(this.bl.bD.Name)&&this.bo.a().jI().Enabled},jT:function(){return!!this.bo&&this.bo.a().dq().Enabled&&!!this.dC&&!this.en},ie:function(){return!!this.bo&&this.bo.a().dq().Enabled&&this.en&&!_a.g.b&&!this.bn()},kp:function(){this.bO=this.bm.Z();this.kV(this.jr());this.de();this.cJ();if(!!this.bm){this.ec=new _j.g(this.hd,_at.a.a);this.gi=new _j.g(this.hr,_at.a.a);this.gj=new _j.g(this.hc,_at.a.a)}this.cj();this.iu()},kV:function(n){this.cf=this.bm.ch(n);this.bl.a()&&!this.bn()?this.bx=6:this.cf&&!_j.h.a(this.bl.bD.AttachmentOriginalUrl)&&(this.bx=3);return n},jG:function(){_j.e.a(_at.a.a,"Attachment class: {0}",this.cA);var n;switch(this.br()){case 0:case 11:case 9:n=!0;break;case 5:_j.e.a(_at.a.a,"Embedded item class: {0}",this.fM());switch(this.fM()){case 6:case 3:case 1:case 2:case 5:case 7:n=!0;break;default:n=!1;break}break;default:n=!1;break}_j.e.a(_at.a.a,"Can open: {0}",n);return n},jW:function(){return this.bm.bc()&&this.bn()&&this.bn().k()?!1:!!this.b()&&Array.contains(this.b().b(this.cF()),0)&&this.jL()&&!!this.bn()&&!this.bw},fT:function(){return this.bs?this.bs.d():this.b()?Array.contains(this.hP(),8)?this.dx()&&!this.gd()?!1:!0:!1:!0},ic:function(){return!this.bn()||!!this.b()&&Array.contains(this.b().b(this.cF()),4)&&!this.bn().k()&&!this.H()},ia:function(){if(this.dv||this.dx()&&!this.gd())return!0;var n=!!this.b()&&(this.b().m()||!this.bK.b.c(this.bn().bD.ProviderType));!n&&this.cD()&&(n=!this.bl.bD.ContentType||!this.cD().g(this.bl.bD.ContentType));return n},cD:function(){return this.b()?this.b().u(this.bq):null},H:function(){return this.dw?!!this.bn()&&!this.bn().k()&&_j.h.a(this.bu)&&(_j.h.b(this.bn().bD.ContentType)||this.bn().bD.ContentType==="application/onenote"||this.bn().bD.ContentType==="image/png"):!!this.bn()&&!this.bn().k()&&_j.h.a(this.bu)&&(!this.cD()||!this.cD().g(this.bl.bD.ContentType))},cO:function(){return!!this.bl&&(this.bl.bD.IsSmimeDecoded||this.bl.p())},de:function(){this.bm?this.eD(this.du||this.bl.a()&&this.bm.bL()&&!_dg.b.isInstanceOfType(this.bl)):this.eD(this.du||this.bl.a());this.eD(this.cI||this.bl.o)},kt:function(){return this.bl&&!_j.h.a(this.bl.bD.Name)?this.bl.bD.Name.endsWith(".one")||this.bl.bD.Name.endsWith(".onepkg"):!1},kB:function(){_j.e.a(_at.a.a,"File selected.");this.iF(!1);this.bm&&this.bm.bY(this)},iz:function(){if(this.cf){_j.e.a(_at.a.a,"Saving attachment with Id:{0} to Cloud.",this.bv());this.dB=_a.c.b(_a.a.c,"SaveSingleAttachmentToCloud",!1,null);this.dB.r=new _a.bu(102,2,!0);this.ca(2);_db.m.b(this.cY,this.o(),this.fq,"AttachmentViewModel",String.format("NotificationHandler is NULL for AttachmentID:{0}",this.cm));var n=new _at.U(this.bv(),null,this.o(),this.bE,null);n.b(this.ht);n.c(this.hs);this.bJ.a(n);var t=_y.bO.isInstanceOfType(this.bm)?"ConversationAttachmentWellContextMenu.SaveToCloud":"AttachmentContextMenu.SaveToCloud";_a.c.c(_a.a.c,t)}},lF:function(){_j.e.a(_at.a.a,"submitting upload to server");this.bA=!1;if(_dg.d.isInstanceOfType(this.bl)){var n=this.bl;this.gF(n)}else(_g.D.isInstanceOfType(this.bl)||_dg.k.isInstanceOfType(this.bl)||_dg.b.isInstanceOfType(this.bl))&&this.gz()},ll:function(){_j.e.a(_at.a.a,"submitting delete to server");this.bA=!1;if(!this.bm.b()){this.cb(_nbs.a.KL);this.il(null,"ParentItemId is null");return}var n=new _at.bx(2,this.bl,this.bm.b());n.c(this.hf);n.a(this.he);_a.g.a.a(n)},kk:function(){var r=this.bl;var u=r.c;var n=this.fL.a();var t=this;n.f(function(){if(n.b())_j.e.b(_at.a.a,"HTML5 file reader attach failed with error code {0}",n.b());else{var i=n.c().indexOf(",");var r=n.c().substring(i+1,n.c().length);t.bP=n.c().substring(0,i).indexOf("base64")!==-1?r:_a.bh.b(r);t.eT("OnUploadCompleteEvent",t)}});try{n.e(u)}catch(i){this.bq.f()&&i.name==="NS_ERROR_FILE_ACCESS_DENIED"?_j.e.a(_at.a.a,"Firefox: failed to read an attachment. Exception: {0}",i.message):_j.e.d(_at.a.a,i,"Unexpected exception was thrown by FileReader.ReadAsDataURL.")}},kL:function(){this.bP=null;this.eT("OnDeleteCompleteEvent",this);if(this.bt){this.bt.m=this.eb(1);_a.c.a(this.bt);this.bt=null}},lo:function(){this.cw=_a.c.b(_a.a.c,"AttachmentUploadQueue",!1,null)},eU:function(n){if(this.cw){this.cw.n=n;this.cw.m=this.hN(!1);_a.c.a(this.cw);this.cw=null}},lp:function(){this.eU("");this.gC();if(this.cz){this.bB=_a.c.b(_a.a.c,this.cz,!1,null);this.bB.r=new _a.bu(100,2,!0);this.bB.r.a(1,this.cz)}},gC:function(){if(this.bB){var n="";this.bA&&(n=this.fB);var t=n.match(new RegExp("[a-zA-Z]+Exception"));if(t&&t.length>0){this.bB.n=t[0];this.bB.p=n}else if(this.cl){this.bB.n=_y.bl.toString(this.cl);this.bB.p=n}else this.bB.n=n;this.bB.m=this.hN(!0);_a.c.a(this.bB);var i=this.bB.s.l&1024?(new Date).getTime():this.bB.s.i;var r=new _at.bK(this.bB.e(),i-this.bB.s.k,n,this.bu,this.bl.b());_a.z.b.a(r);this.bB=null}},P:function(){_j.e.a(_at.a.a,"Getting attachment content from server");this.bA=!1;var n=new _at.bz(_at.a.a,this.bl,this.bE);var t=this;n.a(function(){t.eT("OnDownloadCompleteEvent",t);t.eC(!1)});var i=this;n.c(function(){_j.e.b(_at.a.a,"Download failed with error: {0}",n.G.message);i.bA=!0;i.cG||i.dZ(n)});_a.g.a.a(n)},jC:function(n,t){n&&this.dm(3)},lf:function(n){var t=n.a();if(_g.D.isInstanceOfType(t)&&!t.bD.AttachmentId)this.cV=t;else{var i=new _g.D;i.z(t.bD.AttachmentId.Id);i.e(t.bD.Name);i.h(!1);i.y(n.b());_dg.k.isInstanceOfType(t)?i.k(!0):_dg.d.isInstanceOfType(t)?i.k(!1):_g.D.isInstanceOfType(t)&&i.k(t.bD.IsAttachmentItemAttachment);i.I(this.hk);this.cV=i}},ep:function(){return this.br()===6&&!!this.bu&&_at.a.k.g(this.bu.toLowerCase())},el:function(n){if(this.cV){_j.e.a(_at.a.a,"Uploading id attachment.");this.iP(this.cV)}else if(_g.D.isInstanceOfType(this.bl)||_dg.k.isInstanceOfType(this.bl)){_j.e.a(_at.a.a,"Uploading item or id attachment.");this.iP(this.bl)}else if(_dg.d.isInstanceOfType(this.bl)){var t=this.bl;if(this.bP){_j.e.a(_at.a.a,"Uploading file attachment with pasted image from clipboard.");this.ez(this.bP)}else if(t.bD.Content){_j.e.a(_at.a.a,"Uploading file attachment with content.");this.ez(null)}else if(t.a()&&_a.cD.isInstanceOfType(this.bl.c)&&_at.d.isInstanceOfType(this)){_j.e.a(_at.a.a,"Uploading inline PAL image with content.");this.iR()}else if(this.bq.q()){_j.e.a(_at.a.a,"Uploading HTML5 file attachment.");this.bQ=t.c;this.iO()}else{_j.e.a(_at.a.a,"Uploading Non-HTML5 file attachment.");this.gH()}}else if(_dg.b.isInstanceOfType(this.bl)){this.eq=!0;if(this.bq.q()){_j.e.a(_at.a.a,"Uploading HTML5 reference attachment.");var i=this.bl;this.bQ=i.c;this.iO()}else{_j.e.a(_at.a.a,"Uploading Non-HTML5 reference attachment.");this.gH()}}else{_j.e.c(_at.a.a,"Unsupported upload type.");n(null)}},ej:function(){if(this.bs)return this.bp.a===1?4:this.bs.j();var n=0;if(_dg.d.isInstanceOfType(this.bl))if(this.bp.a===1)n=4;else if(this.ga())n=10;else if(this.cS(this.bl.bD.Name)&&this.er)n=12;else if(this.bp.b)n=3;else{var t,i;if(i=_db.m.e(this.bl,t={val:n}),n=t.val,!i){var r,u,f,e;if((u=_at.a.m(this.bl,r={val:n}),n=r.val,!u)&&(e=_at.a.n(this.bl,f={val:n}),n=f.val,!e)){var o,s;(s=_at.a.l(this.bl,o={val:n}),n=o.val,s)||(n=6)}}}else n=_dg.k.isInstanceOfType(this.bl)?5:_g.D.isInstanceOfType(this.bl)?11:4;return n},cK:function(){if(!this.bW){_j.e.c(_a.a.c,"DownloadAuthenticator is NULL.");return}if(this.cM()){this.cH(this.bW.a(this.bl.bD.AttachmentId,this.bL,null,this.bE));this.hH()&&this.cH(this.bz+"&isDocumentPreview=True")}else this.cH(null)},dZ:function(n){this.ck(1,_at.r.c(n),!0)},hK:function(n){this.bH<this.cc-1&&!this.bT&&this.iQ()},ck:function(n,t,i){this.bA=!0;this.eX(!1);if(this.bT)_j.e.a(_at.a.a,"Attachment create failed callback after cancellation with cancellationId:{0} error: {1}, {2}",this.bI(),n,t);else{_j.e.b(_at.a.a,"Attachment create failed with cancellationId: {0} error: {1}, {2}",this.bI(),n,t);this.cl=n;this.fB=t;if(this.bm&&this.bm.r(this.bO)){this.bm.n(this,!1);this.dR&&this.bm.G()}}this.eT("OnUploadFailedEvent",this)},cp:function(n){if(_at.n.isInstanceOfType(n)){var t=n;if(t.r<t.l-1)return}this.ch(100);var i=this;_j.m.a().a(_at.a.a,"CreateAttachmentActionCompleted",function(){i.ch(0)},500);this.dS(n)},fb:function(){this.gu(!this.bw&&this.bq.t()&&!this.bl.bD.AttachmentId&&!_g.D.isInstanceOfType(this.bl))},lD:function(n){this.bl.e(n);this.dT(this.bl,"Name");this.eH("Attachment")},dT:function(n,t){if(t==="Thumbnail"){this.dE();return}t==="ProviderType"&&this.eQ(["PermissionsTextInCompose","ReferenceAttachmentUrlHostName","DataProviderInfo"]);if(t==="ContentType"||t==="Name"||t==="AttachmentId"||t==="ProviderType"||t==="AttachLongPathName"){t==="Name"&&this.iC(_a.bd.a(this.bl.bD.Name));if(t==="ContentType"||t==="Name"){this.iH(_at.l.a().a(this.bu,this.bl.bD.ContentType,!0,this.cO(),!!this.bn(),this.dw,this.dh));this.de()}if(t==="AttachmentId"){this.ih(this.bl.bD.AttachmentId);this.fb();this.dI();this.dE()}this.io()&&(!_j.h.a(this.bl.bD.ContentType)&&t===this.bl.bD.ContentType||this.bn()&&!_j.h.a(this.bn().bD.AttachLongPathName)&&t===this.bn().bD.AttachLongPathName)&&this.ip();this.cK();this.cj()}},ku:function(n,t){t==="AttachmentId"&&this.bl.g(this.cV.bD.AttachmentId)},ez:function(n){var r=this.bl;if(n){r.k(n);if(this.bH===this.cc-1&&this.bl.a()){var t=0;var i=0;var u,f;_at.h.c(this.bl.bD.ContentType,n,u={val:t},f={val:i});t=u.val;i=f.val;this.bY=t;this.bX=i;this.bZ=this.bm.B(this.bl.bD.Name,this.bY,this.bX)}}this.iA(r,!1)},gq:function(n){var t=this.bl;if(n){t.c=n;t.k("")}this.iA(t,!0)},gH:function(){this.eN.a()},hL:function(){_j.h.a(this.cq)||this.ck(this.cL,this.cq,!1);this.dS(null)},cb:function(n){this.dn.a(_a.u,new _a.u([n],1,null,0,!1,_nbs.a.T,null,null,this.cZ,null))},gF:function(n){this.gz()},iR:function(){_j.e.a(_at.a.a,"Submitting action for PAL attachment upload.");var n=new _at.bw(2,this.bl,this.bm.b(),this.bI(),this.bm.c(),this.cP());n.c(this.dO);n.a(this.dN);_a.g.a.a(n)},fK:function(n){_j.e.a(_at.a.a,"Not a PAL file attachment.")},ew:function(n,t){this.fW(n,t)},gh:function(n,t){this.cm=t;this.iu();_j.e.a(_at.a.a,"Attachment ID: {0}",this.cm?this.cm.Id:"null")},cF:function(){return this.bw?this.fR():this.n()},fW:function(n,t){_j.e.b(_at.a.a,"Opening attachment with URL {0}",n);this.bS&&this.bm&&this.bm.b()&&this.bS.c(this.bm.b(),"Downloaded",this.bu,!!this.bn());if(this.bq.c())if(this.cX.b(this.cX.d())&&this.cX.d().b().a()){_j.e.a(_at.a.a,"Launch URL from nativeBridge");this.cX.d().a(n)}else{_j.e.a(_at.a.a,"Creating an anchor element to download file as OpenInTarget doesn't work in PAL");var r=document.createElement("a");r.href=n;var i=document.createEvent("MouseEvent");i.initMouseEvent("click",!1,!1,window.self,0,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,0,null);r.dispatchEvent(i)}else t?this.dg.a(n,"_self"):this.dg.a(n,"_blank")},cj:function(){for(var n=new _fm.e(new Array(0)),i=this.hP(),t=0;t<i.length;t++){switch(i[t]){case 0:this.lq(n);break;case 1:this.lr(n);break;case 2:this.ls(n);break;case 3:this.lt(n);break;case 4:this.lu(n);break;case 5:this.lv(n);break;case 6:this.es||this.lw(n);break;case 7:this.ly(n);break;case 8:this.lA(n);break;case 9:this.lB(n);break;case 10:this.lC(n);break;case 11:this.lx(n);break;case 12:this.lz(n);break}this.dI()}this.bo&&this.bo.a().bO().Enabled&&n.K(this.dY);this.kP(n)},jl:function(n){!this.bq.c()&&this.ic()&&n.p.a(new _fm.c(_nbs.a.KQ,null,this.ed))},kI:function(n){this.bq.c()?n.p.a(new _fm.c(_nbs.a.Wd,null,this.ed)):this.bn()&&n.p.a(new _fm.c(_nbs.a.Uo,null,this.gn))},kJ:function(){this.bm.ca(this);_a.c.c(_a.a.c,"AttachmentContextMenu.ManagePermission")},iA:function(n,t){_j.e.a(_at.a.a,"Submitting server action for file attachment with content.");var r=null;if(this.cd()){r=this.dP;this.bH||this.ch(10)}var i=new _at.n(2,n,this.bm.b(),this.bI(),this.bm.c(),this.cP(),r,t,this.bH,this.cc,null);i.c(this.dO);i.b(this.fn);i.a(this.dN);_a.g.a.a(i)},ij:function(n){var t=65;if(this.bQ){var i=this.bQ.b();var r=this.bH*14680064;var u=this.bH<this.cc-1?14680064:i-r;var f=u*n/100;var e=(r+f)*t/i;n===100&&this.bH===this.cc-1?this.lj():this.ch(10+e)}else this.ch(10+t*n/100)},lj:function(){var n=this;var t=_j.m.a().e(_at.a.a,"HandleUploadProgress.ShowFakeProgress",function(){n.cg>0&&n.cg<95&&n.ch(n.cg+1)},500);var i=this;_j.m.a().a(_at.a.a,"HandleUploadProgress.CancelFakeProgressTask",function(){_j.m.a().b(t)},1e4)},bi:function(n){this.ey=n;return n},jy:function(){if(!this.bw&&!this.ii(0)){_j.e.a(_at.a.a,"Deleting attachment.");this.bt=_a.c.b(_a.a.c,"AttachmentDeleteAttachment",!1,null);this.iE(!0);var n="";var t=!!this.bl.bD.AttachmentId&&!!this.bl.bD.AttachmentId.Id&&!this.bl.bD.AttachmentId.Id.startsWith("smime-")&&!this.cv;if(t){_j.e.a(_at.a.a,"Deleting attachment from server.");this.bm.n(this,!1);this.bm.cd(this)}else if(this.gG)if(this.ef())this.fC();else{_j.e.c(_at.a.a,"Somehow a user was able to try to delete an attachment in the process of being uploaded.");this.bt.n=n="DeleteInProcess"}else{if(_dg.d.isInstanceOfType(this.bl)){var i=this.bl;this.fK(i)}else _j.e.a(_at.a.a,"Not a file attachment.");this.bm.n(this,!0);n="DeletedWhileInQueue"}this.cw&&this.eU(n)}},fC:function(){if(!this.cR){_j.e.a(_at.a.a,"Cancel attachment with cancellationId {0}",this.bI());this.cn=!1;this.gt(!0);var n=new _at.bp(this.bI());n.b(this.gU);n.c(this.gT);_a.g.a.a(n)}},lG:function(n,t,i){this.gv(!0);if(this.dt){_j.e.a(_at.a.a,"Attachment skipped because it's been deleted while it was pending.",this.bl.bD.Name);t(null);return}var u=n;var r=u.Body.ParentItemId;this.bm.b().Id=r.Id;this.bm.b().ChangeKey=r.ChangeKey;this.db=t;this.el(t)},iO:function(){this.ea=this.fL.a();this.cd()&&this.ch(3);if(this.bq.q()&&this.bI()){this.bH=-1;this.dG=_dg.b.isInstanceOfType(this.bl)?10485760:14680064;this.cc=Math.ceil(this.bQ.b()/this.dG);_dg.b.isInstanceOfType(this.bl)||this.eX(!0);this.iQ()}else this.cd()&&!this.bl.a()?this.gq(this.bQ):this.iS(this.bQ)},iQ:function(){if(!this.bm||!this.bm.j()){_j.e.a(_at.a.a,"The attachment upload seems to have been stopped. Aborting further uploads.");return}var n=this.bQ;this.bH++;var t=this.dG*this.bH;var r=Math.min(t+this.dG,n.c.size);var i=n.c.slice(t,r,n.c.type);this.cd()&&!this.bl.a()?this.gq(i):this.iS(new _db.by(i))},iS:function(n){var t=this;this.ea.a(n,function(n,i,r,u){t.ez(n)},this.hh,_at.a.a,!1)},jD:function(){this.ck(2,_at.r.f(this.ea),!1);this.dS(null)},iP:function(n){_j.e.a(_at.a.a,"Submitting action for item or id attachment.");var i=null;if(this.cd()){i=this.dP;this.ch(10)}var t=new _at.n(2,n,this.bm.b(),this.bI(),this.bm.c(),this.cP(),this.dP,!1,0,1,this.bm.p());t.c(this.dO);t.a(this.dN);_a.g.a.a(t)},jx:function(){var n=this.bm.b();var t=new _g.e(n.Id);t.ChangeKey=n.ChangeKey;var i=new _gg.dH(t);return new _gg.dG(null,i)},dS:function(n){var h=this.bA?_y.bl.toString(this.cl):"";_j.e.a(_at.a.a,"Attachment create completed. Status: {0} CancellationId: {1}",h,this.bI());this.eX(!1);if(!this.bT){if(this.db){n&&_at.n.isInstanceOfType(n)&&this.iJ(n.bk());this.db(this.fc)}this.gv(!1);this.eC(!this.bA&&this.bp.b);if(_dg.k.isInstanceOfType(this.bl)){this.bm.n(this,!1);this.gr(n.j);this.cK();this.bm.W(this)}if(this.lg()){_j.e.a(_at.a.a,"Incrementing parent well size.");(!n||this.bm.r(this.bO))&&this.bm.bW(this.bl.b());this.gE()}if(_dg.b.isInstanceOfType(this.bl)){var u=this.bn().c;if(_y.F.isInstanceOfType(u)){var r=u;this.fx=r.c();!_j.h.a(r.j())&&this.cN()&&this.dc(new _at.C(r.j(),null,200,150,!0))}if(n){var t=null;var i=null;if(_at.T.isInstanceOfType(n)){i=n.N;var f,e;(e=this.iL(i,f={val:t}),t=f.val,e)&&this.bl.j(t.Attachments[0].ContentType)}else if(_at.n.isInstanceOfType(n)){i=n.N.Body;var o,s;if(s=this.iL(i,o={val:t}),t=o.val,s){this.le(this.bl,t.Attachments[0]);this.ek(i.SharingInformation)}}}}this.cj()}this.eT("OnUploadCompleteEvent",this)},ek:function(n){if(this.bo&&this.bo.a().fa().Enabled&&this.bn()&&this.bn().bD.ProviderType&&!_j.h.a(this.bn().bD.AttachLongPathName)){if(n){_j.e.a(_a.a.c,"We already possess the sharing information of the file for the user, so do not dispatch another Action.");this.iN(n);return}if(this.b().k())this.lm();else if(this.b().d()){this.hG(4,!0);this.hG(3,!0)}}},lm:function(){if(!this.cQ&&!_db.m.a(this.n())){this.dr=_a.c.b(_a.a.c,"AttachmentsGetSharingInfoAction",!1,null);this.dr.r=new _a.bu(101,2,!0);this.cQ=new _db.U(this.bn().bD.AttachLongPathName);this.cQ.b(this.hj);this.cQ.c(this.hi);this.bJ.a(this.cQ)}},km:function(n){_j.e.a(_a.a.c,"GetSharingInfoAction succeeded for attachment id {0}.",this.bv());_a.c.a(this.dr);if(_db.U.isInstanceOfType(n)){var t=n;this.iN(t.f)}},iN:function(n){if(n&&this.bm&&this.bm.a().w(this)&&!_j.h.a(this.bv())){n.CanShareInternally||this.kO(!0);n.CanShareExternally||(this.dW=!0);this.bm&&this.bm.T(!0);if(this.bM){this.bM.i(n);this.eS("OnSetSharingSettings")}}},kl:function(n){_a.c.a(this.dr);_j.e.a(_a.a.c,"GetSharingInfoAction failed for attachment Id: {0}",this.bv())},lg:function(){if(this.bA||this.bT)return!1;if(this.bq.t()||_g.D.isInstanceOfType(this.bl)||_dg.b.isInstanceOfType(this.bl))return!0;if(_dg.d.isInstanceOfType(this.bl)){var n=this.bl.c;if(_y.cP.isInstanceOfType(n))return!0;if(_y.F.isInstanceOfType(n))return n.m()}return!1},hJ:function(n){_j.e.a(_at.a.a,"Cancel attachment succeeded with cancellationId {0}",this.bI());this.gv(!1);this.bm&&this.bm.r(this.bO)&&this.bm.n(this,!1);this.hI(n)},jn:function(n){_j.e.b(_at.a.a,"cancel failed with error: {0} and cancellationId: {1}",n&&n.G?n.G.message:"N/A",this.bI());this.cn=!0;this.hI(n)},hI:function(n){this.db&&this.db(null);this.gt(!1);this.kT(!this.cn);this.bT&&this.cv&&this.eX(!1);this.eT("OnCancelCompleteEvent",this);if(this.bt){this.bt.n=this.cn&&n?n.O():null;this.bt.m=this.eb(2);this.bt.o=n?n.P():null;_a.c.a(this.bt);this.bt=null}},jA:function(n){this.il(n,"")},il:function(n,t){_j.e.b(_at.a.a,"delete failed with error: {0}",n?n.G.message:t);this.bA=!0;this.iE(!1);this.bm.r(this.bO)&&!this.cG&&this.bm.W(this);if(this.bt){this.bt.n=n?n.O():t;this.bt.m=this.eb(1);this.bt.o=n?n.P():null;_a.c.a(this.bt);this.bt=null}},jz:function(n){this.eT("OnDeleteCompleteEvent",this);if(this.bt){this.bt.m=this.eb(1);this.bt.o=n?n.P():null;_a.c.a(this.bt);this.bt=null}},ld:function(){_y.cp.a=this.bF.a()==="Mouse"&&this.bF.b()&&!this.ct();this.bS&&this.bm&&this.bm.b()&&this.bS.c(this.bm.b(),"Downloaded",this.bu,!!this.bn())},kF:function(){if((this.bw||this.bl.bD.AttachmentId)&&!this.ii(1)){if(_db.m.a(this.cF())&&!this.dv&&this.cr().p&&this.cr().p.x.length>0){var n=this.cr().p.x[0];n.k.a();return}if(this.fT()&&this.cC()&&!this.ce()&&!this.ia())this.iv();else if((_dg.k.isInstanceOfType(this.bl)||_g.D.isInstanceOfType(this.bl)||this.br()===9)&&this.bF.a()!=="TouchNarrow")this.ir();else if(this.bn()&&(this.ia()||this.bn().k()||this.H()))this.it();else if(this.dq())return;else this.dm(2)}},ii:function(n){if(this.dU&&this.ey){_j.e.a(_at.a.a,"AttachmentWellPendingRefresh was true, so triggering refresh of the attachment well with operation: "+n);this.bc(!1);this.ey(this.bl,n);return!0}return!1},dm:function(n){_y.cp.a=this.bF.a()==="Mouse"&&this.bF.b()&&!this.ct();var t=this.bw&&!this.bn();var i=this.bz?this.bz.replace("&isDocumentPreview=True","&isDocumentPreview=False"):null;if(this.bl.bD.AttachmentId){_a.g.b&&_j.e.a(_at.a.a,"GenericMailMode, always download the attachment.");this.iy(i,4,t)}this.kv(n)},kv:function(n){var t="";switch(n){case 2:t=_y.bO.isInstanceOfType(this.bm)?"ConversationAttachmentWell.Download":"AttachmentView.Download";break;case 0:t=_y.bO.isInstanceOfType(this.bm)?"ConversationAttachmentWellContextMenu.Download":"AttachmentContextMenu.Download";break;case 4:t="AttachmentHubListItemContextMenu.Download";break;case 1:t="AttachmentWellBarButton.Download";break;case 3:t="AttachmentPreview.Download";break;default:_j.e.c(_at.a.a,"Unhandled AttachmentDownloadSource:{0}",n);break}_a.c.c(_a.a.c,t)},ir:function(){if(!this.jG()){_j.e.a(_at.a.a,"Unsupported item.");this.cb(_nbs.a.CV);return}this.bS&&this.bm&&this.bm.b()&&this.bS.c(this.bm.b(),"Downloaded",this.bu,!!this.bn());if(this.bl.p()){var n=this;this.hO(function(t){t.a();n.is()})}else this.is()},jm:function(){this.di=_a.c.b(_at.a.a,"AddIcsToCalendarFromDropDownMenu",!0,null);if(this.cu)this.ik();else{var n=this;this.fA.a(function(t){n.cu=t.a();n.ik()})}_a.c.c(_a.a.c,"AttachmentContextMenu.ImportIcsAttachment")},ik:function(){this.cu.e(this.bl.bD.Name);this.cu.a(this.bl.bD.AttachmentId.Id);this.cu.b(this.fs);this.gs(1);this.cu.c()},kC:function(n){if(_j.h.a(n)){this.gs(2);_a.c.a(this.di)}else{this.gs(3);this.di.p=n;_a.c.a(this.di)}this.cu.d(this.fs)},is:function(){var n={};n.AttachmentItemID=this.bl.bD.AttachmentId.Id;this.bL&&(n.IsDiscovery="1");_j.e.a(_at.a.a,"Opening item attachment in pop-out window.");this.bF.s(_y.gq,null,n,_bc.d.a())},iy:function(n,t,i){this.lE();this.bl?this.bl.bD.AttachmentId?_j.e.a(_at.a.a,"SafeOpenAttachment: Name={0}, ID={1}",this.bl.bD.Name,this.bl.bD.AttachmentId.Id):_j.e.b(_at.a.a,"SafeOpenAttachment: AttachmentId is null"):_j.e.b(_at.a.a,"SafeOpenAttachment: Attachment is null");_j.e.a(_at.a.a,"SafeOpenAttachment: Policy={0}",this.bp.toString());if(this.bp.f&&t!==7){_j.e.a(_at.a.a,"Attachment policy forces browser viewing.");this.bF.a()==="Mouse"?this.cb(_nbs.a.aJ):this.cb(_nbs.a.mz);return}if(!this.bp.e){this.cb(_nbs.a.UG);return}if(this.bp.a===1){this.cb(_nbs.a.XZ);return}if(this.cO()){var r=this;this.hO(function(n){r.bS&&r.bm&&r.bm.b()&&r.bS.c(r.bm.b(),"Downloaded",r.bu,!!r.bn());n.c()});return}if(this.bp.a===2&&this.bF.a()!=="Mouse"){this.lk();return}this.bl&&this.cM()&&!_j.h.a(n)&&this.ew(n,i)},lk:function(){_j.e.a(_at.a.a,"Attachment policy forces save, but device doesn't support download.");this.cb(_nbs.a.HZ)},iv:function(){this.ix(!1);var n=_y.bO.isInstanceOfType(this.bm)?"ConversationAttachmentWell.Preview":"Attachment.Preview";_a.c.c(_a.a.c,n)},jB:function(){this.ix(!0);_a.c.c(_a.a.c,"AttachmentPreview.Edit")},ix:function(n){if(this.bl){if(!this.bm||!this.bm.b()){_j.e.a(_at.a.a,"this.parentWell.ParentItemId is null - compose form is not upgraded.");this.cb(_nbs.a.hu);return}this.bS&&this.bS.c(this.bm.b(),"Previewed",this.bu,!!this.bn());if(this.kr(this.bl.bD.Name)&&this.bl.b()>10485760){this.dn.a(_a.u,new _a.u([_nbs.a.ma],1,this.fp,1,!1,_nbs.a.KQ,_nbs.a.p,_nbs.a.Ms,this.cZ,null));return}if(this.cA===8&&this.bl.b()>1048576){this.dn.a(_a.u,new _a.u([_nbs.a.OR],1,this.fp,1,!1,_nbs.a.KQ,_nbs.a.p,_nbs.a.Ms,this.cZ,null));return}this.kK(n)}},kK:function(n){if(this.ev)if(this.eu)this.iw(n);else{var t=this;this.ev.a(function(i){t.eu=i;t.iw(n)})}},iw:function(n){if(!this.eZ){var t=this.bm.d();var i=!0;t&&(i=!!t.a()&&t.a().fe());var r=this.eu.a(this.cZ,this.gk,this.fF,this.bE,this.bL,i,!1,null,!1,null);r.e(this,n);if(t){t.c()&&t.c().c(this.bv())&&t.n(t.c().b[this.bv()].bD.ItemId);r.b(t.b(),t.d(),t.j()||this.bm.b(),!1,!1,null)}r.a(i)}},kE:function(n){_j.e.a(_at.a.a,"Save to cloud action succeeded with Id:{0}.",this.bv());if(!this.cT||!_j.h.a(this.bE)){this.ca(3);this.gD()}},kD:function(n){_j.e.a(_at.a.a,"Failed to save attachment with Id:{0} to Cloud.",this.bv());this.ca(4);this.gD()},kn:function(n){var t=n;if(t)if(t.ResultCode){_j.e.b(_a.a.c,String.format("Saving attachmentID: {0} failed with ResultCode: {1}. Exception: {2}",this.bv(),t.ResultCode,t.Exception));this.ca(4)}else{this.ca(3);this.iK(t.Item.Location);this.cT&&this.bm.cq(!1)}else _j.e.b(_a.a.c,String.format("Received NULL payload while saving attachment: {0} to cloud",this.bv()));this.gD()},gD:function(){_a.c.a(this.dB);this.dB=null;_db.m.c(this.cY,this.o(),this.fq)},jt:function(){if(this.bm){this.cB=(_a.d.a().h()+_ff.p.a(0,1e6)).toString();this.bm.bE(this,this.cB)}_a.c.c(_a.a.c,"AttachmentContextMenu.ConvertLocalToRef")},O:function(){if(this.bm&&this.bl&&this.bn()&&!_j.h.a(this.bn().bD.AttachLongPathName)){this.cB=(_a.d.a().h()+_ff.p.a(0,1e6)).toString();this.bm.bF(this,this.bn().bD.AttachLongPathName,this.cB)}_a.c.c(_a.a.c,"AttachmentContextMenu.ConvertRefToLocal")},jo:function(){this.bn()?this.jq():this.jp()},jp:function(){if(this.bv()){_j.e.a(_a.a.c,"Canceling convert local to reference attachment. Attachment Id: {0}.",this.bv());var n=new _at.bq(this.cB);n.b(this.hn);n.c(this.hm);this.bJ.a(n);this.p(4);this.eH("ShowCancelButton")}},ky:function(n){_j.e.a(_a.a.c,"Cancel convert local to reference action succeeded for attachment id {0}.",this.bv())},kx:function(n){_j.e.a(_a.a.c,"Cancel convert local to reference action failed for attachment id {0}.",this.bv())},jq:function(){if(this.bv()){_j.e.a(_at.a.a,"Canceling convert reference to local attachment. Attachment Id:{0}.",this.bv());var n=new _at.br(this.cB);n.b(this.hp);n.c(this.ho);this.bJ.a(n);this.i(4);this.eH("ShowCancelButton")}},kA:function(n){_j.e.a(_a.a.c,"Cancel convert reference to local action succeeded for attachment id {0}.",this.bv())},kz:function(n){_j.e.a(_a.a.c,"Cancel convert reference to local action failed for attachment id {0}.",this.bv())},jw:function(){window.clipboardData?window.clipboardData.setData("Text",this.bG):prompt(_nbs.a.DF,this.bG);var n=_y.bO.isInstanceOfType(this.bm)?"ConversationAttachmentWellContextMenu.CopyLinkToClipboard":"AttachmentContextMenu.CopyLinkToClipboard";_a.c.c(_a.a.c,n)},lI:function(){var n=null;_dg.b.isInstanceOfType(this.bl)?n=_at.i.h(this.bG):this.bK&&this.bK.a()&&(n=this.bK.a().O(this.bl.bD.AttachmentOriginalUrl));if(_j.h.a(n)){_j.e.b(_a.a.c,"In order to view in provider, path name must be valid.");return}this.fW(n,!1);_a.c.c(_a.a.c,"AttachmentContextMenu.ViewInProvider")},kG:function(n){n.d();n.c();var t=this.bl.bD.AttachmentOriginalUrl;var i=this.bl.bD.AttachmentOriginalUrl.indexOf("?");i===-1&&(t+="?web=1");this.fW(t,!1)},kH:function(){if(this.bn()&&!_j.h.a(this.bn().bD.AttachLongPathName)&&this.bu in this.b().a()){var n=this.b().a()[this.bu].c(this.w());this.ew(n,!1)}},ih:function(n){var t=this.cm;t!==n&&this.gh(t,n)},gE:function(){this.kY(this.dA||!!this.bl&&!this.bl.b())},cJ:function(){if(this.bn())if(!this.bl.bD.AttachmentId||this.bC===3||this.bD===3||this.dp())this.iI(!1);else{this.iI(!!this.n());this.eH("PermissionsTextInCompose")}},lE:function(){if(!this.cO()&&this.fQ()){var n=_g.k.a.q(this.bl.bD.AttachmentId);this.bl.bD.AttachmentId.Id!==n.Id&&this.bl.g(n)}},hN:function(n){var t=new _a.l;if(this.bn()){var i=this.bn().y?this.bn().y:this.bn().c?this.bn().c.b():0;t.a("S",i)}else t.a("S",this.bl.b());t.a("W",this.bm.c()?1:0);t.a("C",this.bT?1:0);t.b("E",this.bu);if(n){_j.h.a(this.dQ)||t.b("DP",this.dQ);t.c("H",this.fw);t.b("P",this.ft);t.c("O",this.fv);this.bn()&&t.a("SL",this.cF())}return t.toString()},eb:function(n){var t=new _a.l;t.a("S",this.bl.b());var i="A";this.bn()?i="C":this.br()===5?i="T":this.bl.a()&&(i="I");t.b("T",i);t.a("O",n);t.a("W",this.bm.c()?1:0);this.cz&&t.b("Q",this.cz);t.b("E",this.bu);if(this.bn()){var r=-1;try{r=_j.u.b(_g.q,this.bn().bD.ProviderType)}catch(u){}t.a("DP",r)}return t.toString()},dI:function(){this.eL("ShouldAffordanceMenuBeHidden","ShouldShowContextMenuOnClick")},hO:function(n){if(this.cO()){_j.e.a(_a.a.k,"[AttachmentViewModel] Creating Smime command factory.");var t=this;this.gx.a(function(i){if(!t.dH){_j.e.a(_a.a.k,"[AttachmentViewModel] Creating smimeAttachmentViewModelCommand instance.");t.dH=i.d();t.dH.b(t.bl)}_j.e.a(_a.a.k,"[AttachmentViewModel] Executing smime operation.");n(t.dH)})}},jr:function(){var n=!!this.bm.d()&&this.bm.d().b()===2;var t=this.by.k(this.bu,this.bl.bD.ContentType);return this.by.e.SaveAttachmentsToCloudEnabled&&t!==1&&!this.bm.bc()&&this.bm.y()&&!_dg.b.isInstanceOfType(this.bl)&&!this.bl.a()&&this.bm.e()&&(!_j.h.a(this.bm.i())||n)},dE:function(){if(this.bl&&!this.dd){if(this.cN()){_j.h.a(this.bl.bD.AttachmentThumbnailUrl)||this.dc(new _at.C(this.bl.bD.AttachmentThumbnailUrl,null,200,150,!0));return}if(this.ig()){if(!this.bl.bD.AttachmentId)return;if(!this.jT()){this.dc(new _at.C(this.cE(),null,0,0,!1));return}this.lH()}}},lH:function(){var u=this.bl.bD.AttachmentId.Id;var o=_a.d.a();var f=this.dC.a(u);if(!_j.h.a(f)){this.dc(new _at.C(f,null,0,0,!1));return}var r=document.createElement("canvas");var e=r.getContext("2d");var n=new Image;n.crossOrigin="Anonymous";var t=this;n.onload=function(){if(t&&!t.eZ){var f=n.width,o=n.height;r.width=f;r.height=o;var i=null;try{if(f>0&&o>0){e.drawImage(n,0,0,f,o);i=r.toDataURL("image/jpeg",.5)}}catch(s){_j.e.b(_at.a.a,"Failed to get thumbnail via canvas error={0}",s.message)}t.bl&&t.dc(new _at.C(i?i:t.cE(),null,f,o,!1));if(i)try{t.dC.b(u,i)}catch(h){_j.e.b(_at.a.a,"Failed to save thumbnailinfo into session storage, error={0}",h.message)}}};var i=this;n.onerror=function(){i&&!i.eZ&&i.bl&&i.dc(new _at.C(i.cE(),null,0,0,!1))};n.src=this.cE()},ip:function(){if(this.bn()&&!_j.h.a(this.bn().bD.AttachLongPathName)&&!_j.h.a(this.bl.bD.ContentType)&&(this.cs()||this.bl.bD.ContentType==="application/pdf")){var t=this.bl.bD.ContentType==="application/pdf"?!1:!0;var i=_at.s.f(this.bn().bD.AttachLongPathName);if(!_j.h.a(i)){var n=this;_at.s.e(i,t,function(i){if(t){n.bn().B(i+"2");n.bn().C(i);n.dE()}else{i=i.substring(0,i.length-8);n.cH(i+"open")}},null)}}},iu:function(){if(this.cm&&this.bp&&this.im()&&!_dg.k.isInstanceOfType(this.bl)&&this.fT()){if(this.bl&&this.bl.bD.Name&&!_dg.b.isInstanceOfType(this.bl)&&this.by&&this.by.e&&this.by.e.WacPreloadMappings&&this.by.e.WacPreloadMappings.length>0){if(!_at.a.b){_at.a.b={};for(var t=0;t<this.by.e.WacPreloadMappings.length;t++)_at.a.b[this.by.e.WacPreloadMappings[t][0]]=this.by.e.WacPreloadMappings[t][1]}var i=_a.bd.a(this.bl.bD.Name);if(i in _at.a.b){var s=_at.a.b[i];delete _at.a.b[i];this.lc(s)}}var r=this.cm.Id;var u=this;var f=function(n){if(n&&(n.Status===9||n.Status===6)){u.gA=!0;u.cj()}};var e=_at.u.a().c(r);if(e){f(e);return}if(this.bm){if(this.bm.cv())return;var o;(o=this.bm).cr(o.bS()+1)}var n=this;_j.m.a().d(_a.a.c,"AttachmentViewModel.PreloadWacAttachmentInfo",function(){if(n.bm){var t=new _at.bd(r,!1,null,!!n.bn(),n.bm.c(),n.bL,n.bm.p());t.c(function(n){f(t.e)});n.bJ.a(t)}})}},fV:function(n,t,i){var r=t.Id+_a.d.bJ(_a.d.a());if(!this.ie()||!n.c(r)){var u=this.bW.a(t,this.bL,i,this.bE);if(!this.ie())return u;n.a(r,u)}return n.b[r]},ko:function(){try{var n=new ActiveXObject("AcroPDF.PDF");return!0}catch(t){return!1}},li:function(){return this.bq.d().a()===1&&(!this.cS(this.bl.bD.Name)||this.ko())},lh:function(){if(this.bq.d().a()!==2)return!1;if(!this.er||!this.cS(this.bl.bD.Name))return!0;for(var n=0;n<window.navigator.plugins.length;n++)if(window.navigator.plugins[n].name==="Chrome PDF Viewer")return!0;return!1},kr:function(n){var t=_a.bd.a(n).toLowerCase();switch(t){case".xls":case".xlsx":case".xlsm":case".xlsb":return!0;default:return!1}},kq:function(){return(this.br()===5||this.br()===9)&&this.gc&&!this.ks()},im:function(){return!this.gA&&this.bp.b&&!(this.cS(this.bl.bD.Name)&&(this.bn()||this.bF.a()==="TouchNarrow"))&&!(this.bq.c()&&this.bF.a()==="TouchNarrow")&&!this.cD()},ga:function(){if(this.bq&&this.bq.d()&&(this.lh()||this.bq.d().a()===6||this.bq.d().a()===4||this.li())&&this.bp.c()){var n=_at.a.e.g(this.bu.toLowerCase());return this.cD()?!!this.bl.bD.ContentType&&this.cD().g(this.bl.bD.ContentType):n}return!1},hH:function(){return this.bq&&this.bq.d()&&(this.bq.d().a()===2||this.bq.d().a()===6||this.bq.d().a()===4||this.bq.d().a()===1)?_at.a.e.g(this.bu.toLowerCase()):!1},cS:function(n){return _a.bd.a(n).toLowerCase()===".pdf"},ks:function(){return!!this.bm&&!!this.bm.d()&&!!this.bm.d().a()&&this.bm.d().a().fe()},it:function(){this.iy(this.bG,7,!1);var n=_y.bO.isInstanceOfType(this.bm)?"ConversationAttachmentWellContextMenu.OpenInNewTab":"AttachmentContextMenu.OpenInNewTab";_a.c.c(_a.a.c,n)},kw:function(){var n=new _at.bt(this.bl.bD.AttachmentId,this.bm.b().Id);n.b(this.ha);n.c(this.gZ);this.bY=320;this.bX=220;if(_dg.d.isInstanceOfType(this.bl)&&this.bl.bD.Content){var t,i;_at.h.c(this.bl.bD.ContentType,this.bl.bD.Content,t={val:this.bY},i={val:this.bX});this.bY=t.val;this.bX=i.val}this.bZ=this.bm.B(this.bl.bD.Name,this.bY,this.bX);this.bJ.a(n);_a.c.c(_a.a.c,"AttachmentContextMenu.MoveAttachmentToInline")},ju:function(n){_j.e.b(_at.a.a,"AttachmentViewModel: ConvertToInlineAttachmentFailed. Deleting placeholder image");this.bm.bI(this.bZ)},jv:function(n){var t=n.f;this.bl.h(!0);this.bl.m(t);this.de();this.bm.cg(this.bZ,this.bz,t,this.bl.b(),this.bl.bD.ContentType)},lq:function(n){this.jW()&&n.p.a(new _fm.c(this.b().c(),null,this.gf))},ls:function(n){if(this.ei()){this.i(1);n.p.a(new _fm.c(this.hR(),null,this.fI))}},lr:function(n){if(this.eh()){this.p(1);n.p.a(new _fm.c(this.hQ(),null,this.fG))}},lu:function(n){this.dx()||(this.bp.c()&&this.bp.a!==2&&!this.ce()||this.dq()||this.ce())&&this.jl(n)},ly:function(n){(this.bp.c()&&this.bp.a!==2&&!this.ce()||this.dq()||this.ce())&&this.kI(n)},lA:function(n){(this.br()===4||this.bp.a===2||this.ce())&&(this.dq()||!this.ce())||this.cC()&&this.fT()&&!this.dv&&n.p.a(new _fm.c(_nbs.a.MK,null,this.da))},lB:function(n){if(this.cf&&!this.jH()){this.bx=1;n.p.a(new _fm.c(this.hY(),null,this.gp))}},lC:function(n){if(!this.dx())if(this.bn())this.bE?n.p.a(new _fm.c(this.b().j(),null,this.df)):n.p.a(new _fm.c(this.b().r(),null,this.df));else if(this.bl&&!_j.h.a(this.bl.bD.AttachmentOriginalUrl)){if(!this.bK||!this.bK.a()){_j.e.b(_a.a.c,"DefaultDataProviderInfo must be available when the attachment has been saved to cloud.");return}this.bE?n.p.a(new _fm.c(this.bK.a().j(),null,this.df)):n.p.a(new _fm.c(this.bK.a().r(),null,this.df));return}},lz:function(n){if(this.bu in this.b().a()&&this.bq.z()){var t=String.format(_nbs.a.pR,this.b().a()[this.bu].b);n.p.a(new _fm.c(t,null,this.gm))}},lt:function(n){this.bn()&&n.p.a(new _fm.c(_nbs.a.Dt,null,this.fJ))},lv:function(n){this.ep()&&n.p.a(new _fm.c(_nbs.a.JQ,null,this.fz))},lw:function(n){this.bm&&this.bm.e()||!this.cs()||this.cN()||n.p.a(new _fm.c(_nbs.a.IE,null,this.gg))},lx:function(n){this.cC()&&(_dg.k.isInstanceOfType(this.bl)||this.br()===9)&&this.bF.a()!=="TouchNarrow"&&n.p.a(new _fm.c(_u.n.Lg,null,this.ex))},dx:function(){if(!this.bn()||_j.h.a(this.bn().bD.AttachLongPathName))return!1;try{var n=new _a.P(this.bn().bD.AttachLongPathName);var t=n.a;if(t.indexOf("safelinks.protection.outlook.com")>0||!_j.h.a(n.f)&&n.f.toLowerCase().indexOf(_at.a.j)>0)return!0}catch(i){}return!1},gd:function(){return this.bn()?this.bn().bD.ProviderType?this.bn().bD.ProviderType!==_g.q.toString(1)?!1:this.cs()?!0:!1:!1:!1},io:function(){return _dg.b.isInstanceOfType(this.bl)&&!!this.bn()&&this.bn().bD.ProviderType===_g.q.toString(5)},co:null,dv:!1,kQ:function(n){if(this.co!==n){this.co&&this.co.d(!1);this.co=n;this.co&&this.co.d(!0);this.eH("ContextMenuSelectedItem")}return n},eE:function(n){if(this.ci!==n){this.ci=n;this.eH("ShowConversationAttachmentContextMenu")}return n},ln:function(){this.eE(!this.ci);this.ci&&this.cr().n(null)},js:function(){this.eE(!1)},le:function(n,t){n.D(t.ProviderType);n.z(t.AttachLongPathName);n.J(t.ProviderEndpointUrl);n.m(t.ContentId);n.C(t.AttachmentThumbnailUrl);n.B(t.AttachmentPreviewUrl);n.P(t.OriginalPermissionType);n.E(t.PermissionType);this.cJ()},iL:function(n,t){if(n&&n.ResponseMessages&&n.ResponseMessages.Items&&n.ResponseMessages.Items.length>0&&n.ResponseMessages.Items[0].ResponseClass!=="Error"){t.val=n.ResponseMessages.Items[0];if(t.val&&t.val.Attachments&&t.val.Attachments.length>0)return!0}_j.e.c(_a.a.c,"An error happened while trying to get a valid response in TryGetValidAttachmentInfoResponseMessage(). Error: {0}, Message: {1}",n.ResponseMessages.Items[0].ResponseCode,n.ResponseMessages.Items[0].MessageText);t.val=null;return!1}};_at.bL=function(n,t,i,r,u,f,e,o){this.n=_at.a;_a.b.a(n,"owaShell");_a.b.a(t,"palDownloadManager");_a.b.a(o,"attachmentDependencies");_a.b.a(o.f,"userAgent");_a.b.a(o.a,"nativeBridge");_a.b.a(r,"itemStoreGetterFactory");this.c=n;this.i=t;this.b=i;this.g=e;this.a=o;this.h=r;this.j=u;this.f=f};_at.bL.prototype={c:null,a:null,i:null,h:null,b:null,e:null,j:null,g:null,n:null,f:null,k:function(n,t,i,r,u,f,e){n||_j.e.c(_a.a.c,"AttachmentViewModelFactory.Create passing null as attachment");if(this.m()&&(_dg.b.isInstanceOfType(n)||_dg.d.isInstanceOfType(n)&&_y.F.isInstanceOfType(n.c))){if(!this.e&&this.b){var o=this;this.b.a(function(n){o.e=n})}_a.b.b(this.e,"attachmentProviderItemViewModelFactory");return this.e.a(n,this.c,t,i,r,u,f,e)}else if(_dg.d.isInstanceOfType(n)&&_y.cP.isInstanceOfType(n.c)){_a.b.b(this.j,"uriFileAttachmentViewModelFactory");return this.j.a(n,this.c,t,i,r,u,f,e)}else{var s=_at.w.a(this.g,this.a,r);return new _at.d(n,this.c,t,i,r,this.i,this.h,u,f,e,this.f,s,this.a)}},d:function(n,t,i,r,u,f,e,o){n||_j.e.c(_a.a.c,"AttachmentViewModelFactory.CreateAsync passing null as attachment");if(this.m()&&this.b&&(_dg.b.isInstanceOfType(n)||_dg.d.isInstanceOfType(n)&&_y.F.isInstanceOfType(n.c))){var s=this;var h=function(h){var c=h.a(n,s.c,t,i,r,f,e,o);u(c)};this.b.a(h)}else{this.b||_j.e.c(_a.a.c,"attachmentProviderItemViewModelFactoryLazy is null");_dg.b.isInstanceOfType(n)&&_j.e.b(_a.a.c,"We shall not construct PALAttachmentViewModel for ReferenceAttachment.");var c=_at.w.a(this.g,this.a,r);var l=new _at.d(n,this.c,t,i,r,this.i,this.h,f,e,o,this.f,c,this.a);u(l)}},p:function(n,t,i,r,u,f,e,o,s){if(this.b&&_dg.b.isInstanceOfType(t)){var h=this;var c=function(c){var l=c.b(t,h.c,i,r,u,n,e,o,s);f(l)};this.b.a(c)}},o:function(n,t,i,r,u,f,e,o){if(!n){u(null);return}if(!n.length){u(new Array(0));return}this.l(n,0,new Array(0),t,i,r,u,f,e,o)},l:function(n,t,i,r,u,f,e,o,s,h){var c=this;this.d(n[t],r,u,f,function(l){Array.add(i,l);t<n.length-1?c.l(n,t+1,i,r,u,f,e,o,s,h):e(i)},o,s,h)},m:function(){return this.a.c?this.a.c.a().bb().Enabled:!1}};_at.N=function(n){this.a=n};_at.N.prototype={a:null};_at.O=function(n,t){_at.O.initializeBase(this,[n,t])};_at.O.b=function(){return _fm.d.a("box48.png")};_at.O.prototype={D:function(){return _at.O.b()},z:function(){return!1},m:function(){return!0},r:function(){return""},j:function(){return""},t:function(){return _nbs.a.kf},g:function(){return""},A:function(){return""},y:function(){return _nbs.a.cF},i:function(){return""},f:function(){return""},q:function(){return""},s:function(){return""},c:function(){return""},e:function(n,t,i,r){return t},b:function(n){return _at.O.a}};_at.bi=function(n,t){_at.bi.initializeBase(this,[n,t])};_at.bi.a=function(){return _fm.d.a("facebook48.png")};_at.bi.prototype={D:function(){return _at.bi.a()},m:function(){return!1},b:function(n){return null},e:function(n,t,i,r){return null},z:function(){return!0},H:function(){return!0},r:function(){return""},j:function(){return""},t:function(){return""},g:function(){return""},A:function(){return""},y:function(){return""},i:function(){return""},f:function(){return""},q:function(){return""},s:function(){return""},c:function(){return""}};_at.P=function(n,t){_at.P.initializeBase(this,[n,t])};_at.P.b=function(){return _fm.d.a("dropbox48.png")};_at.P.prototype={D:function(){return _at.P.b()},z:function(){return!1},m:function(){return!0},r:function(){return""},j:function(){return""},t:function(){return _nbs.a.kf},g:function(){return""},A:function(){return""},y:function(){return _nbs.a.cF},i:function(){return""},f:function(){return""},q:function(){return""},s:function(){return""},c:function(){return""},e:function(n,t,i,r){var u=t.lastIndexOf("?");var f=t.substring(0,u);return f+"?dl=1"},b:function(n){return _at.P.a}};_at.x=function(n,t){_at.x.initializeBase(this,[n,t]);this.S()};_at.x.e=function(){return _fm.d.a("gdrive48.png")};_at.x.prototype={E:null,D:function(){return _at.x.e()},z:function(){return!0},n:function(){return!1},o:function(){return!0},m:function(){return!1},h:function(){return!0},d:function(){return!0},r:function(){return""},j:function(){return""},t:function(){return _nbs.a.kf},g:function(){return _nbs.a.vx},A:function(){return""},y:function(){return _nbs.a.QH},i:function(){return _nbs.a.KX},f:function(){return""},q:function(){return""},s:function(){return""},c:function(){return _nbs.a.Np},l:function(){return!0},F:function(){return new _db.C(null,11031,null)},v:function(n){n=n.toLowerCase();var t=_nbs.a.Uo;n in this.E&&(t=String.format(_nbs.a.pR,this.E[n]));return t},e:function(n,t,i,r){return t.replace("&rm=embedded","").replace("?rm=embedded","")},b:function(n){return _at.x.c},u:function(n){return n.h()?_at.x.b:_at.x.a},N:function(){return _at.x.d},S:function(){this.E={"application/vnd.google-apps.document":_nbs.a.po,"application/vnd.google-apps.spreadsheet":_nbs.a.XE,"application/vnd.google-apps.presentation":_nbs.a.Vh}}};_at.X=function(n,t){_at.X.initializeBase(this,[n,t])};_at.X.prototype={z:function(){return!0},I:function(){return!0},L:function(){return!0},K:function(){return!0},J:function(){return!1},m:function(){return!0},r:function(){return""},j:function(){return""},t:function(){return""},g:function(){return""},A:function(){return""},y:function(){return""},i:function(){return""},f:function(){return""},q:function(){return""},s:function(){return""},c:function(){return""},e:function(n,t,i,r){return""},b:function(n){return _at.X.a}};_at.E=function(n,t){_at.E.initializeBase(this,[n,t])};_at.E.c=function(){return _fm.b.b(_fm.a.Z,null,[_fm.WebfontSizes.a.i],null,null,null,null,null)};_at.E.prototype={D:function(){return _at.E.c()},z:function(){return this.E()},m:function(){return!this.E()},r:function(){return String.format(_nbs.a.Oa,_nbs.a.dJ)},j:function(){return""},t:function(){return _nbs.a.kf},g:function(){return _nbs.a.vx},A:function(){return _nbs.a.jB},y:function(){return _nbs.a.HG},i:function(){return _nbs.a.k},f:function(){return _nbs.a.pE},q:function(){return _nbs.a.vx},s:function(){return _nbs.a.kf},c:function(){return _nbs.a.Np},l:function(){return!0},e:function(n,t,i,r){n=encodeURIComponent(n);t=encodeURIComponent(t);return String.format(_g.C.j(),n,t)},b:function(n){return this.E()?_at.E.a:_at.E.b},E:function(){return _g.a.a().B}};_at.y=function(n,t){_at.y.initializeBase(this,[n,t])};_at.y.prototype={D:function(){return _fm.b.b(_fm.a.Z,null,[_fm.WebfontSizes.a.i],null,null,null,null,null)},a:function(){this.E();return _at.y.a},b:function(n){switch(n){case 4:case 3:return _at.y.c;case 6:case 5:return _at.y.d;default:return _at.y.b}},x:function(){return _nbs.a.dJ},p:function(){return!0},d:function(){return!0},z:function(){return!0},G:function(){return!0},k:function(){return!0},m:function(){return!1},r:function(){return String.format(_nbs.a.Oa,_nbs.a.dJ)},j:function(){return _nbs.a.hT},t:function(){return _nbs.a.Gb},g:function(){return _nbs.a.oY},A:function(){return _nbs.a.NX},y:function(){return _nbs.a.Jd},i:function(){return _nbs.a.Uk},f:function(){return _nbs.a.kM},q:function(){return _nbs.a.CI},s:function(){return _nbs.a.uE},c:function(){return _nbs.a.Np},w:function(n){switch(n){case 2:case 1:case 6:case 5:return!0;default:return!1}},l:function(){return!!this.C&&this.C.a().fD().Enabled},e:function(n,t,i,r){n=encodeURIComponent(n);t=encodeURIComponent(t);var u=null;u=this.C&&this.C.a().bj().Enabled?String.format(_g.C.r(),n,t,r):String.format(_g.C.j(),n,t);return _j.h.a(i)?u:String.format("{0}/{1}",i,u)},M:function(n,t,i,r,u){var f=n.t()?n.t():n.H();var e=_db.m.a(f);if(e&&!_j.h.a(i)){var o=this;_at.e.o(i,n.bD.AttachLongPathName,e,r,function(i){_j.e.b(_a.a.c,"Error getting download url for ref. attachment. "+i.toString());var e=o.e(n.bD.AttachmentId.Id,n.bD.AttachLongPathName,t,f);r(e,null,null);u&&u()})}else{_j.e.a(_a.a.c,"Avoiding client side metadata call, falling back to OWS.");var s=this.e(n.bD.AttachmentId.Id,n.bD.AttachLongPathName,t,f);r(s,null,null)}},O:function(n){return _at.i.h(n)},E:function(){if(!_at.y.a){var n=new _at.Z(_nbs.a.Is,"ms-word:ofv|u|");var t=new _at.Z(_nbs.a.mA,"ms-PowerPoint:ofv|u|");var i=new _at.Z(_nbs.a.Yj,"ms-excel:ofv|u|");_at.y.a={".docx":n,".doc":n,".pptx":t,".ppt":t,".xlsx":i,".xls":i}}}};_at.Q=function(n,t){_at.Q.initializeBase(this,[n,t])};_at.Q.prototype={z:function(){return!1},m:function(){return!0},r:function(){return""},j:function(){return""},t:function(){return _nbs.a.kf},g:function(){return""},A:function(){return""},y:function(){return _nbs.a.cF},i:function(){return""},f:function(){return""},q:function(){return""},s:function(){return""},c:function(){return""},e:function(n,t,i,r){return""},b:function(n){return _at.Q.a}};_at.ca=function(){};_at.ca.prototype={b:null};_at.Z=function(n,t){_at.Z.initializeBase(this);this.b=n;this.a=t};_at.Z.prototype={a:null,c:function(n){var t=n.indexOf("?d=");var i;i=t!==-1?this.a+n.substr(0,t):this.a+n;return i}};_at.r=function(){};_at.r.c=function(n){var i;if(n){if(_h.bO.isInstanceOfType(n)&&(i=n.d())){var r=i.responseCode;if(r&&r!=="NoError")return r;var t=i.response;if(t){var u=t.fault;if(u){var f=_at.r.d(u);if(f)return f}if(t.statusCode)return"HTTP_"+t.statusCode}}if(n.G)return _at.r.a(n.G)}return"UnknownError_Action"};_at.r.a=function(n){if(n){var t;if((t=n.responseCode)&&t!=="NoError")return t.toString();if(t=n.StackTrace)return _at.r.e(t.toString());if(t=n.ErrorCode)return"HTTP_"+t;if(t=n.name){var i=t.toString();if(i!=="Error")return i;else if(n.message)return n.message}}return"UnknownError_Exception"};_at.r.d=function(n){if(n){if(n.ResponseCode&&n.ResponseCode!=="NoError")return n.ResponseCode;if(n.StackTrace)return _at.r.e(n.StackTrace);if(n.ErrorCode)return"HTTP_"+n.ErrorCode}return null};_at.r.e=function(n){var t;var i;if((t=n.indexOf(":"))!==-1||(t=n.indexOf("\n"))!==-1){i=n.substr(0,t);if((t=n.indexOf("\n"))!==-1){var u=new RegExp("[_a-zA-Z0-9.]+\\(");var r=u.exec(n.substr(t));r&&(i=i+"@"+r[0].substr(0,r[0].length-1))}}else i=n;return i};_at.r.f=function(n){var t=n.b();if(t){var i;i=Number.isInstanceOfType(t)?t:t.code;return i>=1&&i<_at.r.b.length?_at.r.b[i]:_at.r.a(t)}return n.d()?_at.r.a(n.d()):"UnknownError_FileReader"};_at.Y=function(n,t,i,r,u,f,e,o,s,h,c){this.fe=Function.createDelegate(this,this.lK);this.gI=Function.createDelegate(this,this.lJ);_at.Y.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c])};_at.Y.a=function(n){if(n){if(n.ResultCode===10)return 5;if(n.ResultCode===17||n.ResultCode===20||n.ResultCode===21)return 6;if(n.ResultCode===15)return 7}return 1};_at.Y.prototype={ff:function(){_db.m.b(this.cY,this.o(),this.gI,this.gJ(),"NULL NotificationHandler passed in from ExternalSourceAttachmentViewModel.")},iU:function(){_db.m.c(this.cY,this.o(),this.gI)},cp:function(n){this.iU();_at.a.prototype.cp.call(this,n)},lK:function(n){this.dZ(n);this.cp(null)},lJ:function(n){var i=null;var t=n;i=n?_j.h.a(t.Exception)?this.gK(t.Response):String.format("Exception from Server: "+t.Exception):"The notification received is null";if(i){t&&(i+=". AttachmentProviderResultCode = "+t.ResultCode);this.ck(_at.Y.a(t),i,!0)}else this.iT(t);this.cp(null)},iT:function(n){},gK:function(n){var i=null;if(n&&n.ResponseMessages&&n.ResponseMessages.Items&&n.ResponseMessages.Items.length)if(n.ResponseMessages.Items[0].ResponseCode!=="NoError")i="ResponseMessages response code = "+n.ResponseMessages.Items[0].ResponseCode;else{var t=n.ResponseMessages.Items[0];this.bl.f(t.Attachments[0].Size);_at.n.c(t,this.bl,this.bm.b(),!0);if(_dg.b.isInstanceOfType(this.bl)&&t.Attachments.length>=1&&t.ResponseCode==="NoError"){var u=t.Attachments[0];this.lM(u);this.ek(n.SharingInformation)}if(_dg.d.isInstanceOfType(this.bl)&&this.bl.a()){var r=t.Attachments[0];this.bl.m(r.ContentId);this.bl.j(r.ContentType)}}else i="The response message received is null";return i},lM:function(n){if(n.PermissionType){this.bl.E(n.PermissionType);this.cJ()}if(n.AttachLongPathName){this.bl.D(n.ProviderType);this.bl.z(n.AttachLongPathName);this.bl.J(n.ProviderEndpointUrl);this.bl.m(n.ContentId);this.bl.C(n.AttachmentThumbnailUrl);this.bl.B(n.AttachmentPreviewUrl)}this.bl.e(n.Name);this.lL()},lL:function(){this.bm.T(!0)}};_at.bY=function(n,t){this.B=t;this.C=n};_at.bY.prototype={C:null,B:null,D:function(){return null},x:function(){return this.B},p:function(){return!1},d:function(){return!1},H:function(){return!1},G:function(){return!1},h:function(){return!1},k:function(){return!1},I:function(){return!1},L:function(){return!1},K:function(){return!1},J:function(){return!0},F:function(){var n=this.C.a().bQ().Enabled?11032:11030;return new _db.C(null,n,[this.x()])},R:function(){return String.format(_nbs.a.Ov,this.B)},P:function(){return String.format(_nbs.a.Qp,this.B)},Q:function(){return String.format(_nbs.a.Qh,this.B)},a:function(){return null},l:function(){return!1},u:function(n){return null},N:function(){return null},w:function(n){return!1},n:function(){return this.z()},o:function(){return!1},v:function(n){return""},M:function(n,t,i,r,u){var f=this.e(n.bD.AttachmentId.Id,n.bD.AttachLongPathName,t,0);r(f,null,null)},O:function(n){return n}};_at.h=function(){};_at.h.c=function(n,t,i,r){var u=_a.c.b(_a.a.c,"MailComposeImageSizeDecode",!1,null);i.val=r.val=0;if(!t){u.n="EmptyContent";_a.c.a(u);return}if(n==="image/png")_at.h.o(t,i,r,u);else if(n==="image/jpeg")_at.h.n(t,i,r,u);else if(n==="image/gif")_at.h.m(t,i,r,u);else if(n==="image/bmp")_at.h.l(t,i,r,u);else{u.n="UnsupportedImage";u.p=String.format("Image type {0} is not supported.",n);_a.c.a(u)}};_at.h.k=function(n){var t=_a.bd.a(n);return _db.m.d.g(t.toLowerCase())};_at.h.o=function(n,t,i,r){var p=n.length>100?100:n.length;var w=n.substring(0,p);var u=_at.h.b(_a.bh.a(w));if(u.length>24){for(var f=0,e=0,a=new Array(8),o=0;o<8;o++)a[o]=u[o];if(_at.h.a(a,_at.h.j)){for(var s=16,h=4,v=new Array(h),c=0;c<h;c+=1){v[c]=u[s];s+=1}for(var y=new Array(h),l=0;l<h;l+=1){y[l]=u[s];s+=1}f=_at.h.d(v);e=_at.h.d(y);if(f<=0||e<=0){_j.e.b(_a.a.c,"Width and height of a png image have to be > 0.");r.n="IllegalDimensions";r.p="png";f=e=0}}else{_j.e.b(_a.a.c,"The png image has unexpected headers, exiting.");r.n="InvalidHeaders";r.p="png"}t.val=f;i.val=e}else{r.n="NotEnoughData";r.p="png"}_a.c.a(r)};_at.h.m=function(n,t,i,r){var p=n.length>20?20:n.length;var w=n.substring(0,p);var u=_at.h.b(_a.bh.a(w));if(u.length>10){for(var f=0,e=0,c=new Array(6),o=0;o<6;o++)c[o]=u[o];if(_at.h.a(c,_at.h.h)||_at.h.a(c,_at.h.i)){for(var s=6,h=2,v=new Array(h),l=0;l<h;l+=1){v[l]=u[s];s+=1}for(var y=new Array(h),a=0;a<h;a+=1){y[a]=u[s];s+=1}f=_at.h.e(v);e=_at.h.e(y);if(f<=0||e<=0){_j.e.b(_a.a.c,"Width and height of a gif image have to be > 0.");r.n="InvalidDimensions";r.p="gif";f=e=0}}else{_j.e.b(_a.a.c,"The gif image has unexpected headers, exiting.");r.n="InvalidHeaders";r.p="gif"}t.val=f;i.val=e}else{r.n="NotEnoughData";r.p="gif"}_a.c.a(r)};_at.h.l=function(n,t,i,r){var p=n.length>50?50:n.length;var w=n.substring(0,p);var u=_at.h.b(_a.bh.a(w));if(u.length>26){for(var f=0,e=0,a=new Array(2),o=0;o<2;o++)a[o]=u[o];if(_at.h.a(a,_at.h.g)){for(var s=18,h=4,v=new Array(h),c=0;c<h;c+=1){v[c]=u[s];s+=1}for(var y=new Array(h),l=0;l<h;l+=1){y[l]=u[s];s+=1}f=_at.h.f(v);e=_at.h.f(y);if(f<=0||e<=0){_j.e.b(_a.a.c,"Width and height of a bmp image have to be > 0.");r.n="InvalidDimensions";r.p="bmp";f=e=0}}else{_j.e.b(_a.a.c,"The bmp image has unexpected headers, exiting.");r.n="InvalidHeaders";r.p="bmp"}t.val=f;i.val=e}else{r.n="NotEnoughData";r.p="bmp"}_a.c.a(r)};_at.h.n=function(n,t,i,r){for(var f=_at.h.b(_a.bh.a(n)),h=f.length,c=!1,a=!1,u=0,o=0,s=0;!c&&!a&&u+1<h;){u+=1;var l=f[u];u+=1;var e=0;switch(l){case 216:case 217:e=0;break;case 221:e=2;break;default:if(u+2<h){var v=f[u];u+=1;var y=f[u];u+=1;e=(v<<8|y)-2}else{_j.e.b(_a.a.c,"Malformed jpeg.");r.n="MalformedJpeg";_a.c.a(r);return}break}l===217&&(a=!0);if(e>0){if(l===192){if(u+4<h){o=f[u+3]<<8|f[u+4];s=f[u+1]<<8|f[u+2]}else{_j.e.b(_a.a.c,"Malformed segment in jpeg.");r.n="MalformedJpeg";_a.c.a(r);return}c=!0}u+=e}}if(o<=0||s<=0){if(c){_j.e.b(_a.a.c,"Width and height of a jpeg image have to be > 0.");r.n="InvalidDimensions";r.p="jpeg"}else{_j.e.b(_a.a.c,"Image dimension segment not found for jpeg image.");r.n="MissingDimension";r.p="jpeg"}o=s=0}t.val=o;i.val=s;_a.c.a(r)};_at.h.b=function(n){for(var i=n.length,r=new Array(i),t=0;t<i;t++)r[t]=n.charCodeAt(t);return r};_at.h.d=function(n){for(var t=0,i=0;i<4;i++)t=(t<<8)-0+n[i];return t};_at.h.e=function(n){for(var t=0,i=1;i>=0;i--)t=(t<<8)-0+n[i];return t};_at.h.f=function(n){for(var t=0,i=3;i>=0;i--)t=(t<<8)-0+n[i];return t};_at.h.a=function(n,t){if(n.length!==t.length)return!1;for(var i=0;i<t.length;i++)if(n[i]!==t[i])return!1;return!0};_at.bM=function(n){this.g=n;this.c={};this.a=new _j.q};_at.bM.prototype={g:null,c:null,a:null,b:function(n){_a.b.c(n,"attachmentId");return n in this.c},h:function(n){this.d(n);if(!this.b(n.a)){this.a.c(n);this.c[n.a]=""}},e:function(n,t){this.d(t);if(!this.b(t.a)){this.a.k(n,t);this.c[t.a]=""}},i:function(){if(this.a.d.length>0){var n=this.a.d[0];this.f(n);return n}else return null},f:function(n){this.d(n);if(this.b(n.a)){delete this.c[n.a];for(var i=-1,t=0;t<this.a.d.length;t++)if(this.a.d[t].a===n.a){i=t;break}i!==-1&&this.a.j(i)}},d:function(n){_a.b.a(n,"parameter");_a.b.a(n.a,"AttachmentId")}};_at.v=function(){};_at.v.e=function(n,t,i,r,u,f,e){_a.b.a(n,"initNativeBridge");_a.b.a(t,"initClientStore");_a.b.a(i,"initAttachmentInfoRecord");_a.b.c(r,"initMimeType");_a.b.c(u,"fileName");_a.b.a(f,"initOnOpenAttachmentSuccess");_a.b.a(e,"initOnOpenAttachmentError");if(_at.v.b){_j.e.a(_at.v.a,"Already opening an attachment so returning.");return}_j.e.a(_at.v.a,"OpenAttachment with record DataID {0}, Size {1}, id {2}",i.AttachmentId,i.DataID,i.Size);_at.v.b=!0;n.d().f(i.DataID,r,u,function(n){_at.v.d(n,i,t,f,e)});t.l(i.AttachmentId,function(n){},null)};_at.v.c=function(n){var t=null;switch(n){case 0:break;case 1:case 3:t=_nbs.a.mR;break;case 2:t=_nbs.a.BN;break;default:break}_j.e.a(_at.v.a,"OpenPalAttachment error code {0}, string: {1}",n,t);return t};_at.v.d=function(n,t,i,r,u){_at.v.b=!1;var f=!0;switch(n){case 0:f=!1;break;case 1:case 3:break;case 2:i.g(t.AttachmentId);break;default:break}if(f){_j.e.b(_at.v.a,"OnOpenDocument failed with errorCode {0}",n);u(n)}else{_j.e.a(_at.v.a,"OnOpenDocument succeeded");r()}};_at.g=function(n,t,i){this.r=Function.createDelegate(this,this.A);this.s=Function.createDelegate(this,this.B);this.t=Function.createDelegate(this,this.w);_a.b.a(n,"initNativeBridge");var r=t?t.j():null;this.l=n;this.q=i;this.k=n.q().a(r);this.v(t)};_at.g.prototype={k:!1,g:null,f:null,h:null,m:0,j:null,l:null,q:null,n:null,a:function(){if(!this.k&&_g.k.a){var n=_bc.n.isInstanceOfType(_g.k.a)?_g.k.a:null;this.k=this.l.q().a(n?n.h():null);this.v(n?n.d().j():null)}return this.k},d:function(n,t){_a.b.c(n,"attachmentId");_a.b.a(t,"callbacks");if(this.a()){this.j[n]=t;this.y(n,t)}else _j.e.a(_at.g.a,"PAL does not support download.")},b:function(n){_a.b.c(n,"attachmentId");this.a()&&n in this.j&&delete this.j[n]},c:function(n){_a.b.a(n,"parameters");_a.b.a(n.a,"AttachmentId");_a.b.a(n.e,"DownloadUrl");_j.e.a(_at.g.a,"DownloadAttachment:Begin download Attachment for parameters {0}",n);if(this.a()){if(!(n.a in this.j))throw Error.invalidOperation("Subscribe must be called before calling DownloadAttachment.");var t=this.C(n);if(_j.h.a(t)){if((!this.f||this.f.a!==n.a)&&!this.g.b(n.a)){_j.e.a(_at.g.a,"Starting download for {0}",n);if(n.h){this.g.e(0,n);if(this.f){this.u();this.g.e(1,this.h);this.i(this.h,2)}else{this.i(n,2);this.p()}}else{this.g.h(n);this.i(n,2);this.p()}}}else this.x(n,t)}},e:function(n){_a.b.a(n,"parameters");_a.b.a(n.a,"AttachmentId");_j.e.a(_at.g.a,"Cancel download for parameters {0}",n);if(this.a())if(this.g.b(n.a)){this.g.f(n);_j.e.a(_at.g.a,"Found and removed from queue {0}. Pending Items in queue {1}",n,this.g.a.d.length);this.i(n,1)}else if(this.f&&this.f.a===n.a){_j.e.a(_at.g.a,"Current Download was canceled. {0}",this.f);this.u();this.i(this.h,1)}},z:function(n){var t=null;switch(n){case 0:break;case 7:break;case 8:break;case 9:t=_nbs.a.rU;break;case 2:t=_nbs.a.Kf;break;default:break}return t},v:function(n){if(this.k){this.n=n;this.g=new _at.bM(_at.g.a);this.j={};this.h=null;this.f=null;this.m=0}},u:function(){_j.e.a(_at.g.a,"CancelCurrentDownload, canceling the current download");this.l.l().d();this.h=this.f;this.f=null},p:function(){_j.e.a(_at.g.a,"Inside StartDownloadInternal");if(this.h)_j.e.a(_at.g.a,"Still waiting for the canceled download to get canceled.");else if(this.f)_j.e.a(_at.g.a,"Still waiting for the current download to finish.");else{_j.e.a(_at.g.a,"StartDownloadInternal, pending items in queue {0}",this.g.a.d.length);this.f=this.g.i();this.m=0;if(this.f){_j.e.a(_at.g.a,"Starting download {0}",this.f);this.i(this.f,3);var n=this;this.q.c(this.n,this.l,this.t,function(t){_j.e.b(_at.g.a,"Scheduled cleanup failed due to error {0}",t);n.w()})}else _j.e.a(_at.g.a,"Download queue is empty.")}},w:function(){_j.e.a(_at.g.a,"Starting the download now for {0}",this.f);if(this.h){this.h=null;this.p()}else this.l.l().e(this.f.e,1,this.f.f,this.f.b,this.s,this.r)},B:function(n){if(this.f){this.m+=n;var t=this;this.o(this.f,function(n){n.E(t.m)})}},i:function(n,t){var i=this;this.o(n,function(n){n.d(t)})},x:function(n,t){var i=this;this.o(n,function(i){_j.e.b(_at.g.a,"Raising OnError event with error {0} for attachment {1}",t,n);i.G(t)})},o:function(n,t){var i=this.j[n.a];i&&t(i)},A:function(n,t,i){_j.e.a(_at.g.a,"OnDownloadComplete with errorCode = {0} httpStatusCode = {1} dataID = {2} for attachment {3}",n,t,i,this.f);if(this.h)this.h=null;else if(n||t!==200){var f=this.z(n);_j.h.a(f)||this.x(this.f,f);this.i(this.f,1)}else{var r=this.f;var u=new AttachmentInfoRecord(this.f.a,i,this.f.d,_a.d.get_utcNow().h(),this.f.g,0,_a.d.m(_a.d.get_utcNow()),!0);var e=this,o=this;this.n.q(u,function(n){_j.e.a(_at.g.a,"Successfully saved attachment in DB with dataID {0} and parameters {1}",i,r)},function(n){_j.e.b(_at.g.a,"Unable to save the attachment in DB with parameters {0} error {1}",r,n)});this.i(r,4);var s=this;this.o(r,function(n){_j.e.a(_at.g.a,"Raising OnAttachmentInfoRecordAvailable with record {0} for attachment {1}",u,r);n.u(u)})}this.f=null;this.p()},C:function(n){var t=null;if(_bc.h.b(n.a)){_j.e.a(_at.g.a,"The attachment is not uploaded to the server yet. {0}",n);t=_nbs.a.Lc}else if(_j.h.a(n.g)){_j.e.a(_at.g.a,"Attachment is a quick message {0}",n);t=_nbs.a.Lc}else if(_j.h.a(n.b)){_j.e.a(_at.g.a,"Attachment does not have content type set. {0}",n);t=_nbs.a.Kf}else if(_j.h.a(n.f)){_j.e.a(_at.g.a,"Attachment does not have a valid file name {0}.",n);t=_nbs.a.Kf}else if(this.g.a.d.length===10){_j.e.a(_at.g.a,"download queue max size reached. Rejecting attachment with params {0}.",n);t=String.format(_nbs.a.QG,10)}return t},y:function(n,t){if(this.f&&n===this.f.a){_j.e.a(_at.g.a,"FindStatusAndFireCallback. currently downloading attachment with id {0}",n);t.d(3)}else if(this.g.b(n)){_j.e.a(_at.g.a,"FindStatusAndFireCallback. Found in the queue. attachment with id {0}",n);t.d(2)}else{var i=this,r=this;this.n.p(n,function(i){if(i){_j.e.a(_at.g.a,"FindStatusAndFireCallback Found the record in db {0} and AttachmentId {1}",i.DataID,i.AttachmentId);t.d(4);t.u(i)}else{_j.e.a(_at.g.a,"FindStatusAndFireCallback. Did not find attachment with id {0} in the db.",n);t.d(1)}},function(i){_j.e.b(_at.g.a,"FindStatusAndFireCallback. Got error {0} from DB while retreiving record with id {1}",i,n);t.d(1)})}}};_at.S=function(){};_at.S.b=function(n){_a.b.a(n,"viewModel");_a.b.a(n.bz,"DownloadUrl should not be empty");var t=null;n.bm&&n.bm.b()&&(t=n.bm.b().Id);return _at.S.a(n.bl,n.bl.bD.Name,n.bl.bD.ContentType,n.bz,t,!1)};_at.S.a=function(n,t,i,r,u,f){_a.b.a(n,"attachment");_a.b.a(n.bD.AttachmentId,"attachmentId");_a.b.a(r,"downloadUrl");_a.b.a(r,"destinationFileName");var e=new _at.S;e.a=n.bD.AttachmentId.Id;e.d=n.b();e.c=t;e.f=_a.bd.a(e.c);e.b=i;e.e=_a.P.a(r);e.g=u;e.h=f;_j.h.a(e.b)&&!_a.o.a().M&&(e.b="fakeMimeType");return e};_at.S.prototype={b:null,c:null,f:null,a:null,g:null,e:null,d:0,h:!1,toString:function(){return String.format("Attachment with Name {0} Size {1} ContentType {2} AttachmentId{3}",this.c,this.d,this.b,this.a)}};_at.d=function(n,t,i,r,u,f,e,o,s,h,c,l,a){_at.d.initializeBase(this,[n,t,i,r,u,o,s,h,c,l,a]);_a.b.b(f,"palDownloadManager");_a.b.b(a.a,"nativeBridge");_a.b.b(e,"itemStoreGetter");this.bN=f;this.cy=a.a;this.dK=e;this.bl&&this.fg(null,this.bl.bD.AttachmentId)};_at.d.prototype={cy:null,bN:null,dK:null,dL:null,dJ:0,dM:null,fe:function(n){this.dJ=n;this.eH("PALAttachmentDownloadStatus");return n},fj:function(n){this.dM=n;this.eH("PALAttachmentCurrentDowloadedBytes");return n},fQ:function(){return _at.a.prototype.fQ.call(this)||_dg.d.isInstanceOfType(this.bl)&&_a.cD.isInstanceOfType(this.bl.c)},cC:function(){var n=_at.a.prototype.cC.call(this);if(n&&this.cy&&this.cy.b(this.cy.d())){var t=this.cy.h(_a.fv,2);_j.e.a(_at.d.a,"SetOneTimeAllowedUrlSupported is {0}",t);n=!!(n&t)}return n},hV:function(){return this.bq.c()&&this.bw},fh:function(){return this.cC()&&!this.ce()?!1:this.bN.a()&&this.bw},gI:function(){this.fk()},d:function(n){_j.e.a(_at.d.a,"Got attachment status {0}",n);this.fe(n)},E:function(n){this.fj(String.format(_nbs.a.FE,this.ff(n,1),this.ff(this.bl.b(),0)))},G:function(n){_j.e.b(_at.d.a,"Unable to download attachment with name {0} and error is {1}",this.bl.bD.Name,n);this.cb(n)},u:function(n){_j.e.a(_at.d.a,"Found/Saved the record in offline db {0} {1}",n.DataID,n.AttachmentId);this.dL=n},gF:function(n){_a.cD.isInstanceOfType(n.c)?n.a()?this.gz():this.iR():_at.a.prototype.gF.call(this,n)},fK:function(n){if(_a.cD.isInstanceOfType(n.c)){_j.e.a(_at.d.a,"Deleting file attachment via PAL.");var t=n.c;this.cy.i().a(t.c())}else _at.a.prototype.fK.call(this,n)},ew:function(n,t){if(this.bN.a()){_j.e.a(_at.d.a,"Will use PAL to open attachment.");this.fi()}else _at.a.prototype.ew.call(this,n,t)},gh:function(n,t){this.fg(n,t);_at.a.prototype.gh.call(this,n,t)},fi:function(){_j.e.a(_at.d.a,"OpenAttachmentUsingPAL, download status={0}",this.dJ);if(!this.bm.r(this.bO)){_j.e.b(_at.d.a,"The context has changed from "+this.bO+" to "+this.bm.Z()+", opening attachment using PAL has been skipped.");return}if(this.bm.bd()||!this.bw){_j.e.a(_at.d.a,"Returning because the attachment is a fake message. IsComposeReadOnlyWell = {0} and IsReadOnly {1}",this.bm.bd(),this.bw);return}this.gJ();var n=_at.S.b(this);_j.e.a(_at.d.a,"PAL attachment download parameters: {0}",n.toString());switch(this.dJ){case 0:case 1:this.E(0);_j.e.a(_at.d.a,"Starting PAL attachment download.");this.bN.c(n);break;case 3:case 2:_j.e.a(_at.d.a,"Canceling PAL attachment download.");this.bN.e(n);break;case 4:_j.e.a(_at.d.a,"PAL attachment download complete.");var t=this;this.dK.a(function(){var i=t.dK.b().a(_g.a.a().a().bD.TimeZone);_at.v.e(t.cy,i.j(),t.dL,n.b,n.c,function(){_j.e.a(_at.d.a,"Attachment opened successfully.")},function(n){_j.e.b(_at.d.a,"Attachment open failed with errorCode {0}",n);n===2&&t.fe(1);var i=_at.v.c(n);t.cb(i)})});break;default:break}},fg:function(n,t){if(this.bN)if(_dg.k.isInstanceOfType(this.bl)){_j.e.a(_at.d.a,"ItemAttachment for PAL status:Downloaded");this.fe(4)}else if(this.bN.a()){n&&n.Id&&this.bN.b(n.Id);t&&t.Id&&this.bN.d(t.Id,this)}},fk:function(){if(this.bN.a()&&this.bl&&this.bl.bD.AttachmentId&&!_dg.k.isInstanceOfType(this.bl)){_j.e.a(_at.d.a,"Unsubscribing for attachment with name {0} and id {1}",this.bl.bD.Name,this.bl.bD.AttachmentId);this.bN.b(this.bl.bD.AttachmentId.Id)}},ff:function(n,t){var i;var r=n;if(n>=1073741824){r/=1073741824;i=_u.R.GM}else if(n>=1048576){r/=1048576;i=_u.R.MM}else if(n>=1024){r/=1024;i=_u.R.HX}else i=_u.R.q;return String.format(i,Math.round(r*Math.pow(10,t))/Math.pow(10,t))},gJ:function(){if(this.bq.e()&&(_j.h.b(this.bl.bD.ContentType)||_at.d.d===this.bl.bD.ContentType.toLowerCase())){var t=_a.bd.a(this.bl.bD.Name);var n;if(_j.h.b(t))n=_at.d.d;else{n=_at.d.f[t.toLowerCase()];_j.h.a(n)&&(n=_at.d.d)}_j.e.a(_at.d.a,"PAL GetMimeType File(Name:'{0}', Ext='{1}'), MimeType:(original:'{2}' is replaced with:'{3}')",this.bl.bD.Name||"<NULL>",t||"<NULL>",this.bl.bD.ContentType||"<NULL>",n);this.bl.j(n)}}};_at.bN=function(){};_at.bN.prototype={a:function(){return!1},d:function(n,t){throw Error.invalidOperation("This method is not implemented for BOWA.");},b:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},c:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},e:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");}};_at.bO=function(n){this.e=!!n&&n.a().eZ().Enabled;this.f=!!n&&n.a().bj().Enabled};_at.bO.prototype={e:!1,f:!1,a:null,b:null,c:function(n,t){if(!_j.h.a(t)){this.a||(this.a={});switch(n){case 4:case 3:case 5:case 6:case 2:case 1:this.a[n.toString()]=t;break;default:_j.e.b(_a.a.c,String.format("Cannot add sharing link for permission type: {0}",n));break}}},d:function(n,t){this.b||(this.b={});switch(n){case 4:case 3:case 5:case 6:this.b[n.toString()]=t;break;default:_j.e.b(_a.a.c,"Cannot create link of this type. Skip adding to dictionary");break}},h:function(n,t){var i=null;if(this.a)switch(n){case 4:case 3:case 5:case 6:n.toString()in this.a&&(i=this.a[n.toString()]);break;case 2:case 1:if(t&&t===_g.q.toString(0)&&"2"in this.a){i=this.a["2"];break}n.toString()in this.a&&(i=this.a[n.toString()]);break;default:break}return i},g:function(n){if(this.b)switch(n){case 4:case 3:case 5:case 6:return n.toString()in this.b?this.b[n.toString()]:!1;case 1:case 2:return!0;default:_j.e.b(_a.a.c,String.format("Cannot create link of permission type: {0}. Returning false.",n));return!1}return!1},i:function(n){if(this.e){_j.h.a(n.AnonymousEditLink)?this.d(4,n.CanCreateAnonymousEditLink):this.c(4,n.AnonymousEditLink);_j.h.a(n.AnonymousViewLink)?this.d(3,n.CanCreateAnonymousViewLink):this.c(3,n.AnonymousViewLink)}if(this.f){_j.h.a(n.OrganizationEditLink)?this.d(6,n.CanCreateOrganizationEditLink):this.c(6,n.OrganizationEditLink);_j.h.a(n.OrganizationViewLink)?this.d(5,n.CanCreateOrganizationViewLink):this.c(5,n.OrganizationViewLink)}}};_at.bn=function(n,t,i,r,u,f,e,o,s,h,c){_at.bn.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c])};_at.bn.a=function(){return"UriFileAttachmentNotification"+(_a.d.a().h()+_ff.p.a(0,1e3)).toString()};_at.bn.prototype={d:null,o:function(){this.d||(this.d=_at.bn.a());return this.d},gJ:function(){return"UriFileAttachmentViewModel"},ef:function(){return!1},el:function(n){if(_dg.d.isInstanceOfType(this.bl)&&_y.cP.isInstanceOfType(this.bl.c)){_j.e.a(_a.a.i,"Uploading attachment from URL");var t=this.bl.c;this.ff();var i=new _at.bT(this.bm.b(),t.c(),t.a(),this.o(),this.bl.a(),this.bl.bD.ContentId);i.c(this.fe);this.bJ.a(i)}else{_j.e.c(_a.a.i,"Unsupported upload type detected in addFileAttachment");n(null)}},fb:function(){this.gu(!1)}};_at.bo=function(n,t,i){this.c=n;this.d=t;this.b=i};_at.bo.prototype={c:null,d:null,b:null,a:function(n,t,i,r,u,f,e,o){var s=_at.w.a(this.d,this.b,u);return new _at.bn(n,t,i,r,u,f,e,o,this.c,s,this.b)}};_at.bI=function(){_at.bI.initializeBase(this)};_at.bI.prototype={a:function(){return 1},c:function(){return 8},b:function(){return!0},d:function(){return!0}};_at.bZ=function(){};_at.bZ.prototype={n:null,f:0,g:null,l:!1,m:!1,i:null,e:null,j:function(){Error.invalidOperation("Not supported");return 6},a:function(){return 2},c:function(){return 0},b:function(){return!1},k:function(){return!1},d:function(){return!1},o:function(n,t,i,r,u,f,e){this.n=n;this.f=t;this.g=i;this.l=r;this.m=u;this.i=f;this.e=e}};_at.bD=function(){_at.bD.initializeBase(this)};_at.bD.prototype={a:function(){return 1},c:function(){return 7},b:function(){return!0},d:function(){return!0}};_at.bE=function(){_at.bE.initializeBase(this)};_at.bE.prototype={j:function(){return 10},a:function(){return 1},c:function(){return 4},b:function(){return!0},d:function(){return!0}};_at.bH=function(n){_at.bH.initializeBase(this);this.h=n};_at.bH.prototype={h:!1,a:function(){return 1},c:function(){return 6},b:function(){return!0},k:function(){return this.h},d:function(){return!0}};_at.bJ=function(){_at.bJ.initializeBase(this)};_at.bJ.prototype={a:function(){return 1},c:function(){return 5},b:function(){return!0},d:function(){return!0}};_at.bg=function(){_at.bg.initializeBase(this)};_at.bg.prototype={a:function(){return 2}};_at.bF=function(){_at.bF.initializeBase(this)};_at.bF.prototype={a:function(){return 1},c:function(){return 3},b:function(){return!0},d:function(){return!0}};_at.bG=function(){_at.bG.initializeBase(this)};_at.bG.prototype={a:function(){return 1},c:function(){return 1},b:function(){return!0},d:function(){return!0}};_at.bh=function(){_at.bh.initializeBase(this)};_at.bh.prototype={a:function(){return _a.g.b?2:1},c:function(){return 2},b:function(){return this.f==="TouchNarrow"?!1:this.e.e()?this.g.a().et().Enabled&&!this.h():!1},d:function(){return!0},h:function(){return!!this.e&&!!this.e.d()&&!!this.e.d().a()&&this.e.d().a().fe()}};_at.B=function(n){this.n=Function.createDelegate(this,this.x);_at.B.initializeBase(this,[n])};_at.B.prototype={b:null,e:0,i:!1,d:!1,g:!1,q:function(n){if(this.d!==n){this.d=n;this.bw("ImageLoadSucceeded")}return n},p:function(n){if(n!==this.b){this.b=n;this.k()}return n},r:function(n){if(n!==this.e){this.e=n;this.k()}return n},f:function(n){_j.k.c(this.z,"error");this.a(_y.c.a.p(_y.e.a().c));this.v();this.i=!0},P:function(){_b.W.prototype.P.call(this);_j.k.b(this.z,"load",this.n);this.k();this.u()},bx:function(){_j.k.c(this.z,"load");_j.i.prototype.bx.call(this)},x:function(n){this.q(!this.i);this.d&&!this.g&&this.w(this.z)},u:function(){var t=_a.c.b(_a.a.c,"AttachmentExternalImage",!1,null);var n=new _a.l;n.c("L",!0);this.b?n.c("U",this.b.a):n.c("N",!0);t.m=n.toString();_a.c.a(t)},v:function(){var t=_a.c.b(_a.a.c,"AttachmentExternalImage",!1,null);var n=new _a.l;n.c("E",!0);this.b?n.c("U",this.b.a):n.c("N",!0);t.m=n.toString();_a.c.a(t)},k:function(){this.b&&this.e&&this.a(this.b.c)},w:function(n){this.g=!1;var f=n;if(_at.B.a){f=window.document.createElement("img");f.src=n.src}var i=f.naturalHeight;i||(i=f.height);var r=f.naturalWidth;r||(r=f.width);i||(i=this.b.b);r||(r=this.b.d);if(!i||!r){_j.e.b(_a.a.c,"Stopping processing image since either imageHeight or width is 0");return}var c=0;var l=1;var a=0;var v=1;var t=this.b.e;if(t&&t.b()>=4)if(t.a(0)<t.a(2)&&t.a(1)<t.a(3)){_j.e.a(_a.a.c,"Top={0}, Left={1}, Bottom={2}, Right={3}",t.a(0),t.a(1),t.a(2),t.a(3));var h=255;c=t.a(0)/h;a=t.a(1)/h;l=t.a(2)/h;v=t.a(3)/h}else _j.e.b(_a.a.c,"Something wrong with the salient region, Top={0}, Left={1}, Bottom={2}, Right={3}",t.a(0),t.a(1),t.a(2),t.a(3));else _j.e.b(_a.a.c,"Using default value as the salient regions");var k=r/i;var o;var s;var y,p;_at.bb.a(this.e,y={val:s},p={val:o});s=y.val;o=p.val;var d=o/s;var e;var w=0,b=0;if(k>d){e=s/i;w=this.o(e,r,o,(a+v)/2)}else{e=o/r;b=this.o(e,i,s,(c+l)/2)}var g=Math.round(r*e);var nt=Math.round(i*e);var tt=w*-1;var it=b*-1;var u={};u.width=g.toString()+"px";u.height=nt.toString()+"px";u.top=it.toString()+"px";u[_fc.m.a()]=tt.toString()+"px";this.z.style.cssText="width: "+u.width+"; "+"height"+": "+u.height+"; "+"top"+": "+u.top+"; "+_fc.m.a()+": "+u[_fc.m.a()]+"; "+"position"+": "+"absolute"+";";this.g=!0},o:function(n,t,i,r){var e=.5;var u=t*n;var f=(u-i)/u;var o;o=r-e>=f/2?Math.round(u*f):e-r>=f/2?0:Math.round((r-e+f/2)*u);return o}};_at.bb=function(){};_at.bb.a=function(n,t,i){switch(n){case 3:i.val=160;t.val=120;break;case 4:i.val=200;t.val=150;break;case 5:i.val=260;t.val=195;break;case 6:i.val=40;t.val=40;break;default:i.val=50;t.val=50;break}};_at.bc=function(n){_at.bc.initializeBase(this,[n])};_at.bc.prototype={G:function(){_j.i.prototype.G.call(this);var n=this.V();if(n&&n.bl&&n.fO()){var t=_a.bd.a(n.bl.bD.Name).replace(".","");var i=SuiteExtensions.ControlFactory.CreateControl(t,0);i.Render(this.z)}}};_at.f=function(n){this.s=Function.createDelegate(this,this.bq);this.r=Function.createDelegate(this,this.be);this.u=Function.createDelegate(this,this.bQ);this.v=Function.createDelegate(this,this.bR);this.t=Function.createDelegate(this,this.br);_at.f.initializeBase(this,[n]);this.a("about:blank");this.A(-1);_j.i.d(this.z,"load",this.t,"hiddenAttachmentUpload",!1)};_at.f.prototype={b:null,d:null,e:0,k:!1,n:null,m:0,p:null,h:!1,l:null,i:function(){return this.eK(_at.f.c)},bt:function(n){this.eI(_at.f.c,n);return n},j:function(){return this.eK(_at.f.e)},bH:function(n){this.eI(_at.f.e,n);return n},bC:function(n){n||(this.e=-1);this.eI(_at.f.g,n);return n},bf:function(){return this.eK(_at.f.d)},bv:function(n){this.eI(_at.f.d,n);return n},bh:function(){return this.eK(_at.f.b)},bM:function(n){this.eI(_at.f.b,n);return n},D:function(n){if(this.l===n)return n;this.l=n;this.bw("UploadAndShareAttachmentCommand");return n},bk:function(){return this.eK(_at.f.f)},bN:function(n){this.eI(_at.f.f,n);return n},y:function(n){this.n=n;this.bw("Error");return n},x:function(n){this.m=n;this.bw("AttachmentError");return n},B:function(n){this.p=n;this.bw("SuccessResponse");return n},Y:function(){_j.i.prototype.Y.call(this);this.eI(_at.f.b,new _j.g(this.v,_at.f.a));this.D(new _j.g(this.u,_at.f.a))},br:function(n){if(this.e){if(this.e===2){_j.e.a(_at.f.a,"Response received.");var t="";try{t=this.z.contentWindow.document.body.innerText}catch(i){if(!(_a.o.a().I&&i.number===-2146828218)){_j.e.d(_at.f.a,i,"Unhandled exception while executing HandleCreateAttachmentResponse");return}}if(this.k)_j.h.a(t)&&this.o(null,"Error sending the attachment upload form",1);else{var u=this,r=this;_at.n.d(t,this.i(),this.j(),_g.k.a,function(n){_j.e.a(_at.f.a,"HandleCreateAttachmentResponse completed.");u.o(n,null,0)},function(n,t){_j.e.a(_at.f.a,"HandleCreateAttachmentResponse failed: {0}",n.message);var i=1;if(n.ResponseCode){var u=n.ResponseCode.toString();r.i().a()&&u==="ErrorInvalidOperation"?i=4:u==="ErrorMessageSizeExceeded"&&(i=3)}var f=_at.r.d(t)||_at.r.a(n);r.o(null,f,i)})}}}else{_j.e.a(_at.f.a,"Initializing.");this.e=1;this.bs();_j.m.a().a(_at.f.a,"ExecuteOpenFilePicker",this.r,0)}},o:function(n,t,i){this.B(n);this.y(t);this.x(i);this.e=3;this.bk().a();this.h=!1},bs:function(){var n=this.z;n.contentWindow.document.body.innerHTML="";this.b=n.contentWindow.document.createElement("form");this.b.method="POST";this.b.encType="multipart/form-data";this.b.encoding="multipart/form-data";this.bc(this.b);this.d=n.contentWindow.document.createElement("input");this.d.type="file";this.d.name="fileInput";_j.k.b(this.d,"change",this.s);this.b.appendChild(this.d)},bc:function(n){this.z.contentWindow.document.body.appendChild(n)},bq:function(n){if(!this.h){this.h=!0;var t=this.d.value;if(!_j.h.a(t)){this.i().e(this.bP(t));this.bf().a()}}},bP:function(n){var t=n.lastIndexOf("\\");return n.substr(t+1)},be:function(){this.d.click()},bR:function(){this.k=!1;this.b.action=_g.C.h();this.w()},bQ:function(){this.k=!0;this.b.action=_g.C.l();this.f("subscriptionId",this.V().o());this.w()},w:function(){_j.e.a(_at.f.a,"Uploading attachment via form submit.");this.f("parentItemId",this.j().Id);this.f("parentChangeKey",this.j().ChangeKey);this.f("isInline",this.i().a().toString());this.f("cancellationId",this.V().bI());this.f(_a.w.c(),_a.w.d());this.b.submit();this.e=2},f:function(n,t){var i=this.b.ownerDocument.createElement("input");i.type="hidden";i.name=n;i.value=t;this.b.appendChild(i)}};_at.z=function(n,t,i,r,u,f){this.p=Function.createDelegate(this,this.y);this.n=Function.createDelegate(this,this.w);this.o=Function.createDelegate(this,this.x);this.f=-1;this.g=-1;this.a=n;this.l=f;f&&this.z(i,r,u);var e=this.C();var o=this.v(t);_j.k.b(this.a,"load",this.o,"InlineImageAttachment");_j.k.b(this.a,"error",this.n,"InlineImageAttachment");e||(this.d?this.t():o&&(this.a.src=this.c))};_at.z.c=function(n,t){return t?n.getNamedItem("blockedimagesrc").value:n.getNamedItem("src").value};_at.z.a=function(n,t,i,r,u,f){var e=new _a.l;e.a("C",n);e.c("F",t);e.c("FS",i);e.a("BL",r);f!==-1&&e.a("AL",f);u&&e.b("U",u);_a.c.c(_a.a.c,"BingProxyForExternalImages",e.toString(),0)};_at.z.d=function(n){return!n.search(_at.z.b)};_at.z.prototype={l:!1,k:null,a:null,e:null,h:0,m:null,j:!1,b:null,c:null,d:null,i:!1,D:function(){if(this.a.attributes.hasOwnProperty("blockedimagesrc")){this.a.attributes.removeNamedItem("blockedimagesrc");this.d?this.t():this.a.src=this.c}},dispose:function(){_j.k.c(this.a,"click","InlineImageAttachment");_j.k.c(this.a,"load","InlineImageAttachment");_j.k.c(this.a,"error","InlineImageAttachment");this.a=null;this.e=null;this.k=null;this.m=null;if(this.b){this.b.onreadystatechange=null;this.b.ontimeout=null;this.b=null}},z:function(n,t,i){if(_j.k.o(this.a,"a").length>0){this.l=!1;return}this.e=n;this.h=t;this.k=i;this.m=this.e[this.h];this.r()?this.e[this.h]=null:this.q()},v:function(n){var t=n&&_at.i.a(this.a.src)&&(!this.a.attributes.hasOwnProperty("crossorigin")||this.a.attributes.getNamedItem("crossorigin").value!=="anonymous");t&&this.a.setAttribute("crossorigin","anonymous");return t},C:function(){var n=this.a.attributes;var t=n.hasOwnProperty("blockedimagesrc");this.c=_at.z.c(n,t);!_at.i.a(this.c)&&n.hasOwnProperty("bingproxyimagesrc")&&this.B(n,t);return t},B:function(n,t){this.d=n.getNamedItem("bingproxyimagesrc").value;n.removeNamedItem("bingproxyimagesrc");_at.z.d(this.d)||(this.d=null)},t:function(){this.f=_a.K.a();this.a.src=this.d},s:function(n){this.b=new XMLHttpRequest;var i=this;this.b.ontimeout=function(){_j.e.a(_a.a.c,String.format("Bing proxy timed out trying to fetch image at URL: {0}",i.c));_at.z.a(-1,i.i,n,i.f,i.c,i.g)};var t=this;this.b.onreadystatechange=function(){if(t.b.readyState===4){var i=t.b.status;_j.e.a(_a.a.c,String.format("Bing proxy returned HTTP status code: {0}, status text: {1}, for image at URL: {2}",i,t.b.statusText,t.c));_at.z.a(i,t.i,n,t.f,t.c,t.g)}};this.b.open("GET",this.d,!0);this.b.timeout=15e3;this.b.send(null)},E:function(n,t,i){var r=this.e[this.h];if(r){r.ImageUrl=n;r.PhotoPageUrl=t;r.ThumbnailUrl=i}},A:function(){this.k&&this.k(this.e,this.h,!1,"InlineImageClicked")},y:function(n){n.a()-1||this.A()},x:function(n){if(this.d)if(this.i){this.g=_a.K.a()-this.g;this.s(!0)}else{this.f=_a.K.a()-this.f;_at.z.a(200,!1,!1,this.f,null,-1)}if(this.l)if(this.r()){this.e[this.h]=null;this.u()}else{this.e[this.h]=this.m;this.q();var t=this.a.src;var i=this.a.getAttribute("data-downloadImage");var r=this.a.getAttribute("data-thumbnailImage");this.E(t,i||t,r||t)}},w:function(n){this.u();if(this.d)if(this.i){this.g=_a.K.a()-this.g;_j.k.c(this.a,"error","InlineImageAttachment");this.s(!1)}else{this.f=_a.K.a()-this.f;this.i=!0;this.g=_a.K.a();this.a.setAttribute("src",this.c)}},r:function(){var n=this.a;return!n||n.naturalWidth<50||n.naturalHeight<50},q:function(){if(!this.j){this.a.style.cursor="pointer";_j.k.b(this.a,"click",this.p,"InlineImageAttachment");this.j=!0}},u:function(){if(this.j){this.a.style.cursor="default";_j.k.c(this.a,"click","InlineImageAttachment");this.j=!1}}};_at.p=function(){};_at.p.registerInterface("_at.p");_at.bQ=function(){};_at.bQ.prototype={a:function(n,t){return String.format(_nbs.a.JC,n)},b:function(n,t){throw Error.notImplemented();}};_at.c=function(){};_at.c.y=function(){return _fm.d.a("classic_40.png")};_at.c.z=function(){return _fm.d.a("cloud_40.png")};_at.c.v=function(){return _fm.d.a("c_wv.png")};_at.c.bZ=function(){return _fm.d.a("c_mpg.png")};_at.c.cg=function(){return _fm.d.a("c_zip.png")};_at.c.t=function(){return _fm.d.a("c_access.png")};_at.c.cc=function(){return _fm.d.a("c_word.png")};_at.c.H=function(){return _fm.d.a("c_google_doc.png")};_at.c.bU=function(){return _fm.d.a("c_word_cloud_aw.png")};_at.c.bs=function(){return _fm.d.a("c_google_doc_cloud.png")};_at.c.d=function(){return _fm.d.a("c_generic.png")};_at.c.o=function(){return _fm.d.a("c_generic_cloud_aw.png")};_at.c.n=function(){return _fm.d.a("c_onenote.png")};_at.c.U=function(){return _fm.d.a("c_notebook.png")};_at.c.X=function(){return _fm.d.a("c_pdf.png")};_at.c.ba=function(){return _fm.d.a("c_powerpoint.png")};_at.c.J=function(){return _fm.d.a("c_google_slide.png")};_at.c.bL=function(){return _fm.d.a("c_powerpoint_cloud_aw.png")};_at.c.bu=function(){return _fm.d.a("c_google_slide_cloud.png")};_at.c.bX=function(){return _fm.d.a("c_txt.png")};_at.c.bg=function(){return _fm.d.a("c_irm_msg.png")};_at.c.h=function(){return _fm.d.a("c_eml.png")};_at.c.cb=function(){return _fm.d.a("c_visio.png")};_at.c.be=function(){return _fm.d.a("c_publisher.png")};_at.c.L=function(){return _fm.d.a("c_infopath.png")};_at.c.R=function(){return _fm.d.a("c_lync.png")};_at.c.B=function(){return _fm.d.a("c_excel.png")};_at.c.I=function(){return _fm.d.a("c_google_sheet.png")};_at.c.bn=function(){return _fm.d.a("c_excel_cloud_aw.png")};_at.c.bt=function(){return _fm.d.a("c_google_sheet_cloud.png")};_at.c.bi=function(){return _fm.d.a("c_access_cloud_aw.png")};_at.c.r=function(){return _fm.d.a("c_onenote_cloud_aw.png")};_at.c.bF=function(){return _fm.d.a("c_notebook_cloud_aw.png")};_at.c.bI=function(){return _fm.d.a("c_pdf_cloud_aw.png")};_at.c.bj=function(){return _fm.d.a("c_wv_cloud_aw.png")};_at.c.bR=function(){return _fm.d.a("c_mpg_cloud_aw.png")};_at.c.bW=function(){return _fm.d.a("c_zip_cloud_aw.png")};_at.c.bP=function(){return _fm.d.a("c_irm_msg_cloud_aw.png")};_at.c.bQ=function(){return _fm.d.a("c_txt_cloud_aw.png")};_at.c.m=function(){return _fm.d.a("c_jpg.png")};_at.c.p=function(){return _fm.d.a("c_jpg_cloud_aw.png")};_at.c.x=function(){return _fm.d.a("c_bmp.png")};_at.c.bl=function(){return _fm.d.a("c_bmp_cloud_aw.png")};_at.c.G=function(){return _fm.d.a("c_gif.png")};_at.c.br=function(){return _fm.d.a("c_gif_cloud_aw.png")};_at.c.Z=function(){return _fm.d.a("c_png.png")};_at.c.bK=function(){return _fm.d.a("c_png_cloud_aw.png")};_at.c.bT=function(){return _fm.d.a("c_visio_cloud_aw.png")};_at.c.bO=function(){return _fm.d.a("c_publisher_cloud_aw.png")};_at.c.by=function(){return _fm.d.a("c_infopath_cloud_aw.png")};_at.c.bD=function(){return _fm.d.a("c_lync_cloud_aw.png")};_at.c.q=function(){return _fm.d.a("c_msg_cloud_aw.png")};_at.c.e=function(){return _fm.d.a("c_msg.png")};_at.c.T=function(){return _fm.d.a("c_ndr.png")};_at.c.bE=function(){return _fm.d.a("c_ndr_cloud_aw.png")};_at.c.bz=function(){return _fm.d.a("c_cal_cloud_aw.png")};_at.c.M=function(){return _fm.d.a("c_cal.png")};_at.c.bA=function(){return _fm.d.a("c_contact_cloud_aw.png")};_at.c.N=function(){return _fm.d.a("c_contact.png")};_at.c.bB=function(){return _fm.d.a("c_task_cloud_aw.png")};_at.c.O=function(){return _fm.d.a("c_task.png")};_at.c.bc=function(){return _fm.d.a("project_20.png")};_at.c.bd=function(){return _fm.d.a("c_project.png")};_at.c.bN=function(){return _fm.d.a("c_project_cloud_aw.png")};_at.c.i=function(){return _fm.d.a("c_folder_cloud_aw.png")};_at.c.s=function(){return _fm.d.a("dc-accdb_20.png")};_at.c.bh=function(){return _fm.d.a("dc-accdb-cloud_20.png")};_at.c.u=function(){return _fm.d.a("dc-aspx_20.png")};_at.c.K=function(){return _fm.d.a("c_html.png")};_at.c.bx=function(){return _fm.d.a("c_html_cloud.png")};_at.c.S=function(){return _fm.d.a("dc-mpg_20.png")};_at.c.w=function(){return _fm.d.a("dc-bmp_20.png")};_at.c.bk=function(){return _fm.d.a("dc-bmp-cloud_20.png")};_at.c.A=function(){return _fm.d.a("dc-docx_20.png")};_at.c.bm=function(){return _fm.d.a("dc-docx-cloud_20.png")};_at.c.C=function(){return _fm.d.a("dc-exe_20.png")};_at.c.D=function(){return _fm.d.a("c_exe.png")};_at.c.bo=function(){return _fm.d.a("c_exe_cloud.png")};_at.c.F=function(){return _fm.d.a("dc-gif_20.png")};_at.c.bq=function(){return _fm.d.a("dc-gif-cloud_20.png")};_at.c.P=function(){return _fm.d.a("dc-jpg_20.png")};_at.c.bC=function(){return _fm.d.a("dc-jpg-cloud_20.png")};_at.c.Q=function(){return _fm.d.a("dc-lync_20.png")};_at.c.bY=function(){return _fm.d.a("dc-txt_20.png")};_at.c.f=function(){return _fm.d.a("dc-msg_20.png")};_at.c.V=function(){return _fm.d.a("dc-pblsh_20.png")};_at.c.bG=function(){return _fm.d.a("dc-pblsh-cloud_20.png")};_at.c.c=function(){return _fm.d.a("dc-one_20.png")};_at.c.g=function(){return _fm.d.a("dc-one-cloud_20.png")};_at.c.W=function(){return _fm.d.a("dc-pdf_20.png")};_at.c.bH=function(){return _fm.d.a("dc-pdf-cloud_20.png")};_at.c.Y=function(){return _fm.d.a("dc-png_20.png")};_at.c.bJ=function(){return _fm.d.a("dc-png-cloud_20.png")};_at.c.bb=function(){return _fm.d.a("dc-pptx_20.png")};_at.c.bM=function(){return _fm.d.a("dc-pptx-cloud_20.png")};_at.c.bf=function(){return _fm.d.a("dc-rpmsg_20.png")};_at.c.ca=function(){return _fm.d.a("dc-vsd_20.png")};_at.c.bS=function(){return _fm.d.a("dc-vsd-cloud_20.png")};_at.c.cd=function(){return _fm.d.a("dc-wv_20.png")};_at.c.ce=function(){return _fm.d.a("dc-xlsx_20.png")};_at.c.bV=function(){return _fm.d.a("dc-xlsx-cloud_20.png")};_at.c.cf=function(){return _fm.d.a("dc-zip_20.png")};_at.c.b=function(){return _fm.d.a("dc-generic_20.png")};_at.c.a=function(){return _fm.d.a("dc-generic-cloud_20.png")};_at.c.j=function(){return _fm.d.a("dc-gdoc_20.png")};_at.c.bp=function(){return _fm.d.a("dc-gdoc-cloud_20.png")};_at.c.k=function(){return _fm.d.a("dc-gsheet_20.png")};_at.c.bv=function(){return _fm.d.a("dc-gsheet-cloud_20.png")};_at.c.l=function(){return _fm.d.a("dc-gslide_20.png")};_at.c.bw=function(){return _fm.d.a("dc-gslide-cloud_20.png")};_at.c.E=function(){return _fm.b.a(_fm.a.J,"owa-color-folder-brown",_fm.WebfontSizes.a.d)};_at.b=function(){};_at.b.n=function(){_at.b.g||(_at.b.g=new _at.b.b(_at.c.e(),_at.c.f(),_at.c.q(),_at.c.a()));return _at.b.g};_at.b.u=function(){_at.b.l||(_at.b.l=new _at.b.b(_at.c.O(),_at.c.b(),_at.c.bB(),_at.c.a()));return _at.b.l};_at.b.d=function(){_at.b.e||(_at.b.e=new _at.b.b(_at.c.M(),_at.c.b(),_at.c.bz(),_at.c.a()));return _at.b.e};_at.b.m=function(){_at.b.j||(_at.b.j=new _at.b.b(_at.c.K(),_at.c.u(),_at.c.bx(),_at.c.a()));return _at.b.j};_at.b.q=function(){_at.b.f||(_at.b.f=new _at.b.b(_at.c.N(),_at.c.b(),_at.c.bA(),_at.c.a()));return _at.b.f};_at.b.t=function(){_at.b.k||(_at.b.k=new _at.b.b(_at.c.T(),_at.c.b(),_at.c.bE(),_at.c.a()));return _at.b.k};_at.b.r=function(){_at.b.h||(_at.b.h=new _at.b.b(_at.c.i(),_at.c.E(),_at.c.i(),_at.c.a()));return _at.b.h};_at.b.o=function(){if(!_at.b.c){_at.b.c={};_at.b.c["application/vnd.google-apps.document"]=new _at.b.b(_at.c.H(),_at.c.j(),_at.c.bs(),_at.c.bp());_at.b.c["application/vnd.google-apps.spreadsheet"]=new _at.b.b(_at.c.I(),_at.c.k(),_at.c.bt(),_at.c.bv());_at.b.c["application/vnd.google-apps.presentation"]=new _at.b.b(_at.c.J(),_at.c.l(),_at.c.bu(),_at.c.bw());_at.b.c["application/onenote"]=new _at.b.b(_at.c.n(),_at.c.c(),_at.c.r(),_at.c.g())}return _at.b.c};_at.b.p=function(){if(!_at.b.a){_at.b.a={};var o=new _at.b.b(_at.c.t(),_at.c.s(),_at.c.bi(),_at.c.bh());_at.b.a[".accdb"]=o;_at.b.a[".accde"]=o;_at.b.a[".acs"]=o;_at.b.a[".mdb"]=o;var i=new _at.b.b(_at.c.B(),_at.c.ce(),_at.c.bn(),_at.c.bV());_at.b.a[".xlsx"]=i;_at.b.a[".xlsm"]=i;_at.b.a[".xlsb"]=i;_at.b.a[".xls"]=i;_at.b.a[".xltx"]=i;_at.b.a[".xltm"]=i;_at.b.a[".xlt"]=i;_at.b.a[".xlam"]=i;_at.b.a[".xla"]=i;_at.b.a[".ods"]=i;var t=new _at.b.b(_at.c.ba(),_at.c.bb(),_at.c.bL(),_at.c.bM());_at.b.a[".pptx"]=t;_at.b.a[".pptm"]=t;_at.b.a[".ppt"]=t;_at.b.a[".potx"]=t;_at.b.a[".potm"]=t;_at.b.a[".pot"]=t;_at.b.a[".ppsx"]=t;_at.b.a[".ppsm"]=t;_at.b.a[".pps"]=t;_at.b.a[".ppam"]=t;_at.b.a[".ppa"]=t;_at.b.a[".odp"]=t;var u=new _at.b.b(_at.c.cc(),_at.c.A(),_at.c.bU(),_at.c.bm());_at.b.a[".docx"]=u;_at.b.a[".docm"]=u;_at.b.a[".doc"]=u;_at.b.a[".dot"]=u;_at.b.a[".dotx"]=u;_at.b.a[".dotm"]=u;_at.b.a[".wps"]=u;_at.b.a[".odt"]=u;_at.b.a[".one"]=new _at.b.b(_at.c.n(),_at.c.c(),_at.c.r(),_at.c.g());_at.b.a[".onepkg"]=new _at.b.b(_at.c.U(),_at.c.c(),_at.c.bF(),_at.c.g());_at.b.a[".pdf"]=new _at.b.b(_at.c.X(),_at.c.W(),_at.c.bI(),_at.c.bH());var r=new _at.b.b(_at.c.v(),_at.c.cd(),_at.c.bj(),_at.c.a());_at.b.a[".wav"]=r;_at.b.a[".aiff"]=r;_at.b.a[".mp3"]=r;_at.b.a[".mp4"]=r;_at.b.a[".aac"]=r;_at.b.a[".wma"]=r;_at.b.a[".m4a"]=r;_at.b.a[".ogg"]=r;_at.b.a[".flac"]=r;_at.b.a[".ape"]=r;var n=new _at.b.b(_at.c.bZ(),_at.c.S(),_at.c.bR(),_at.c.a());_at.b.a[".mpg"]=n;_at.b.a[".avi"]=n;_at.b.a[".mov"]=n;_at.b.a[".wmv"]=n;_at.b.a[".3g2"]=n;_at.b.a[".3gp"]=n;_at.b.a[".asf"]=n;_at.b.a[".asx"]=n;_at.b.a[".flv"]=n;_at.b.a[".mp4"]=n;_at.b.a[".srt"]=n;_at.b.a[".swf"]=n;_at.b.a[".vob"]=n;_at.b.a[".zip"]=new _at.b.b(_at.c.cg(),_at.c.cf(),_at.c.bW(),_at.c.a());_at.b.a[".rpmsg"]=new _at.b.b(_at.c.bg(),_at.c.bf(),_at.c.bP(),_at.c.a());var s=new _at.b.b(_at.c.bX(),_at.c.bY(),_at.c.bQ(),_at.c.a());_at.b.a[".txt"]=s;_at.b.a[".rtf"]=s;var f=new _at.b.b(_at.c.m(),_at.c.P(),_at.c.p(),_at.c.bC());_at.b.a[".jpg"]=f;_at.b.a[".jpeg"]=f;_at.b.a[".jpe"]=f;_at.b.a[".jfif"]=f;_at.b.a[".ico"]=f;_at.b.a[".tif"]=f;_at.b.a[".tiff"]=f;_at.b.a[".gif"]=new _at.b.b(_at.c.G(),_at.c.F(),_at.c.br(),_at.c.bq());_at.b.a[".png"]=new _at.b.b(_at.c.Z(),_at.c.Y(),_at.c.bK(),_at.c.bJ());_at.b.a[".bmp"]=new _at.b.b(_at.c.x(),_at.c.w(),_at.c.bl(),_at.c.bk());var e=new _at.b.b(_at.c.cb(),_at.c.ca(),_at.c.bT(),_at.c.bS());_at.b.a[".vdx"]=e;_at.b.a[".vsd"]=e;_at.b.a[".vsdx"]=e;_at.b.a[".vsl"]=e;_at.b.a[".vss"]=e;_at.b.a[".vst"]=e;var h=new _at.b.b(_at.c.bd(),_at.c.bc(),_at.c.bN(),_at.c.a());_at.b.a[".mpp"]=h;var c=new _at.b.b(_at.c.be(),_at.c.V(),_at.c.bO(),_at.c.bG());_at.b.a[".pub"]=c;_at.b.a[".xsn"]=new _at.b.b(_at.c.L(),_at.c.b(),_at.c.by(),_at.c.a());var l=new _at.b.b(_at.c.R(),_at.c.Q(),_at.c.bD(),_at.c.a());_at.b.a[".lync"]=l;_at.b.a[".msg"]=_at.b.n();_at.b.a[".eml"]=new _at.b.b(_at.c.h(),_at.c.f(),_at.c.h(),_at.c.a());_at.b.a[".ics"]=_at.b.d();_at.b.a[".ical"]=_at.b.d();_at.b.a[".icalendar"]=_at.b.d();_at.b.a[".vcs"]=_at.b.d();_at.b.a[".htm"]=_at.b.m();_at.b.a[".html"]=_at.b.m();_at.b.a[".mht"]=_at.b.m();_at.b.a[".exe"]=new _at.b.b(_at.c.D(),_at.c.C(),_at.c.bo(),_at.c.a())}return _at.b.a};_at.b.s=function(){_at.b.i||(_at.b.i=new _at.b.b(_at.c.d(),_at.c.b(),_at.c.o(),_at.c.a()));return _at.b.i};_at.b.prototype={c:function(n){return n?n.toLowerCase()in _at.b.p():!1},b:function(n,t,i,r){return this.g(n,t,r,!1)},a:function(n,t,i,r){return this.g(n,t,r,i)},d:function(n,t,i){return this.h(n,t,i)},e:function(n,t){return this.f(_at.b.r(),t,n)},h:function(n,t,i){var r=null;switch(n){case 1:r=_at.b.n();break;case 2:r=_at.b.u();break;case 3:case 5:case 6:r=_at.b.d();break;case 4:r=_at.b.q();break;case 7:r=_at.b.t();break}return this.f(r,i,t)},g:function(n,t,i,r){var u=null;t=t?t.toLowerCase():null;!_j.h.a(t)&&t in _at.b.o()?u=_at.b.o()[t]:_j.h.a(n)||(u=_at.b.p()[n.toLowerCase()]);return this.f(u,i,r)},f:function(n,t,i){var r=null;n||(n=_at.b.s());switch(t){case 1:r=i?n.c:n.a;break;case 2:r=i?n.d:n.b;break}return r}};_at.b.b=function(n,t,i,r){this.a=n;this.b=t;this.c=i;this.d=r};_at.b.b.prototype={a:null,b:null,c:null,d:null};_at.bR=function(){};_at.bR.prototype={imageAttachmentNotLoaded:1,attachmentSize:2,attachmentDownloadingProgress:3,attachmentOverlay:4,attachmentWaitingDownloadText:5,attachmentNotDownloadedOverlay:6};_at.bR.registerEnum("_at.bR",!1);_at.bS=function(){};_at.bS.prototype={a:function(n,t){var i=n;var r=!0;try{var u=_j.u.d(_at.bR,t.toString());switch(u){case 1:i&&i!==1||(r=!1);break;case 2:i&&i!==1&&i!==4||(r=!1);break;case 3:i===3&&(r=!1);break;case 4:(i===3||i===2)&&(r=!1);break;case 5:i===2&&(r=!1);break;case 6:i!==1&&i||(r=!1);break}}catch(f){r=!0}return r},b:function(n,t){throw Error.notImplemented();}};_at.j=function(){};_at.j.$$cctor=function(){_at.j._I()};_at.j.h=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <button type='button' class='_at_5'></button> <div class='_at_2 ms-font-s ms-font-weight-regular ms-font-color-neutralSecondary'> <span class='_at_3 ms-font-l ms-font-weight-semilight'></span> <span class='_at_3'></span> <span class='_at_3 _at_4'></span> </div> </div>";_j.i.a().appendChild(n);return n};_at.j.g=function(n){return n.e};_at.j.m=function(n){return n.d};_at.j.f=function(n,t){n.K(t)};_at.j.j=function(n,t){n.T(t)};_at.j.l=function(n,t){n.l(t)};_at.j.k=function(n,t){n.m(t)};_at.j.i=function(n,t){n.Q(t)};_at.j.c=function(n,t){n.a(t)};_at.j.e=function(){_at.j.b||(_at.j.b=new _fc.k);return _at.j.b};_at.j._I=function(){var n="AttachmentOptionsIntroductionPeekView";new _j.d(n,function(){_at.j.a[n]===undefined&&(_at.j.a[n]=[[[-1,4,null,null,null,"ImageId",null,_at.j.l,0,null,null,null,_n.b.di()],[-1,4,null,null,null,"HoveredImageId",null,_at.j.k,0,null,null,null,_n.b.dj()],[-1,4,null,null,null,"AriaLabel",null,_at.j.i,0,null,null,null,_u.R.Bu],[-1,0,["ShowTitle"],[_at.j.g],null,"IsHidden",null,_at.j.f,1,_at.j.e(),null,!0],[-1,0,["CloseCommand"],[_at.j.m],null,"ClickCommand",null,_at.j.j,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_at.j.c,0,null,null,null,_nbs.a.pV],[-1,0,["ShowTitle"],[_at.j.g],null,"IsHidden",null,_at.j.f,1,_at.j.e(),null,!0]],[[-1,4,null,null,null,"Text",null,_at.j.c,0,null,null,null,_nbs.a.Vr]],[[-1,4,null,null,null,"Text",null,_at.j.c,0,null,null,null,_nbs.a.lS]]]);var t=_at.j.d.childNodes[0].cloneNode(!0);var i=new _fc.a(_j.a.a(t,[1,2]));var r=new _fc.a(_j.a.a(t,[1,1]));var u=new _fc.a(_j.a.a(t,[1,0]));var f=new _fc.b(t.children[0]);return new _j.a(t,[f,u,r,i])},"",_at.W,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_at.j.a)};_at.ba.registerClass("_at.ba");_at.bT.registerClass("_at.bT",_h.fG);AttachmentsComponent.registerClass("AttachmentsComponent",null,_a.jR,_j.ce);_at.w.registerClass("_at.w",null,_y.bP);_at.bC.registerClass("_at.bC",_h.fG,_a.fD);_at.o.registerClass("_at.o",null,_y.cy);_at.l.registerClass("_at.l",null,_at.K,_db.cZ);_at.D.registerClass("_at.D",null,_h.dn);_at.u.c.registerClass("_at.u.c");_at.e.u.registerClass("_at.e.u");_at.e.t.registerClass("_at.e.t");_at.e.z.registerClass("_at.e.z");_at.e.y.registerClass("_at.e.y");_at.A.registerClass("_at.A",_h.fG,_a.fD);_at.bp.registerClass("_at.bp",_h.fG,_a.fD);_at.bq.registerClass("_at.bq",_h.fG,_a.fD);_at.br.registerClass("_at.br",_h.fG,_a.fD);_at.bs.registerClass("_at.bs",_h.fG,_a.fD);_at.bt.registerClass("_at.bt",_h.fG);_at.bu.registerClass("_at.bu",_h.fG);_at.bv.registerClass("_at.bv",_h.fG);_at.n.registerClass("_at.n",_h.dr.$$(_gg.fY,_gg.fM));_at.bw.registerClass("_at.bw",_at.n);_at.T.registerClass("_at.T",_h.fG,_a.fD);_at.bx.registerClass("_at.bx",_h.dr.$$(_gg.gj,_gg.gl));_at.by.registerClass("_at.by",_h.fG);_at.G.registerClass("_at.G",_h.dr.$$(_gg.rl,_gg.fM));_at.bz.registerClass("_at.bz",_h.fG);_at.m.registerClass("_at.m",_h.fG);_at.bW.registerClass("_at.bW",_h.fG);_at.bA.registerClass("_at.bA",_at.bW);_at.bd.registerClass("_at.bd",_at.bW);_at.J.registerClass("_at.J",_at.bW);_at.U.registerClass("_at.U",_h.fG);_at.be.registerClass("_at.be",_h.fG);_at.t.registerClass("_at.t");_at.H.registerClass("_at.H");_at.I.registerClass("_at.I");_at.C.registerClass("_at.C");_at.bK.registerClass("_at.bK",_a.br);_at.W.registerClass("_at.W",_a.bv,_y.gl,_a.kD,_j.bs,Sys.IDisposable);_at.a.registerClass("_at.a",_a.bv,_at.bk,_y.eK,_j.bs,Sys.IDisposable);_at.N.registerClass("_at.N");_at.bY.registerClass("_at.bY",null,_at.cb);_at.O.registerClass("_at.O",_at.bY);_at.bi.registerClass("_at.bi",_at.bY);_at.P.registerClass("_at.P",_at.bY);_at.x.registerClass("_at.x",_at.bY);_at.X.registerClass("_at.X",_at.bY);_at.E.registerClass("_at.E",_at.bY);_at.y.registerClass("_at.y",_at.bY);_at.Q.registerClass("_at.Q",_at.bY);_at.ca.registerClass("_at.ca");_at.Z.registerClass("_at.Z",_at.ca);_at.Y.registerClass("_at.Y",_at.a);_at.S.registerClass("_at.S");_at.d.registerClass("_at.d",_at.a,_at.cc);_at.bO.registerClass("_at.bO");_at.bn.registerClass("_at.bn",_at.Y);_at.bo.registerClass("_at.bo",null,_y.iz);_at.bI.registerClass("_at.bI",_at.bZ);_at.bZ.registerClass("_at.bZ");_at.bD.registerClass("_at.bD",_at.bZ);_at.bE.registerClass("_at.bE",_at.bZ);_at.bH.registerClass("_at.bH",_at.bZ);_at.bJ.registerClass("_at.bJ",_at.bZ);_at.bg.registerClass("_at.bg",_at.bZ);_at.bF.registerClass("_at.bF",_at.bZ);_at.bG.registerClass("_at.bG",_at.bZ);_at.bh.registerClass("_at.bh",_at.bZ);_at.B.registerClass("_at.B",_b.W);_at.bc.registerClass("_at.bc",_b.W);_at.f.registerClass("_at.f",_b.A);_at.b.registerClass("_at.b",null,_at.p);_at.b.b.registerClass("_at.b.b");_at.bS.registerClass("_at.bS",null,_j.bP);AttachmentsComponent.$$cctor();_at.i.c=_g.a.a().n()?_g.a.a().n().bD.DownloadUrlBase:null;_at.i.g=String.format("{0}//{1}",window.location.protocol,window.location.hostname);_at.w.c=_a.a.c;_at.o.a=_a.a.c;_at.l.b=null;_at.M.a=_at.M.b();_at.u.b=null;_at.k.a={};_at.k.d=null;_at.e.d=null;_at.A.a={};_at.n.a=_a.a.c;_at.G.a=_a.a.c;_at.m.a=null;_at.m.b=0;_at.a.j="b7780972f918485c8cfc32b1ba7438eb";_at.a.h=_a.I.a();_at.a.d=_a.I.a();_at.a.a=_a.a.c;_at.a.c=new _j.q([".mp3"]);_at.a.g=new _j.q([".txt",".xml",".log"]);_at.a.f=new _j.q([".msg",".eml"]);_at.a.k=new _j.q([".ics",".ical",".icalendar",".vcs"]);_at.a.e=new _j.q([".pdf"]);_at.a.i=[8,1,4,9,5,6,11,10];_at.a.b=null;_at.O.a=[7,3];_at.P.a=[7,4,3];_at.x.a=new _j.q(["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation","image/jpeg","image/gif","image/png","image/svg+xml","image/bmp","application/pdf"]);_at.x.b=new _j.q(["image/jpeg","image/gif","image/png","image/svg+xml","image/bmp","application/pdf"]);_at.x.d=new _j.q(["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation","application/vnd.google-apps.drawing","application/vnd.google-apps.file","application/vnd.google-apps.folder","application/vnd.google-apps.form","application/vnd.google-apps.fusiontable","application/vnd.google-apps.map","application/vnd.google-apps.script","application/vnd.google-apps.sites"]);_at.x.c=[8,0,7,3];_at.X.a=new Array(0);_at.E.a=[8,0,2,4,7,3,5];_at.E.b=[0,2,7,3,5];_at.y.b=[8,0,2,12,7,4,3,10,5];_at.y.d=[8,7,0,2,4,3];_at.y.c=[0,2,7,3];_at.y.a=null;_at.Q.a=[7,3];_at.r.b=["","NOT_FOUND_ERR","SECURITY_ERR","ABORT_ERR","NOT_READABLE_ERR","ENCODING_ERR","NO_MODIFICATION_ALLOWED_ERR","INVALID_STATE_ERR","SYNTAX_ERR","INVALID_MODIFICATION_ERR","QUOTA_EXCEEDED_ERR","TYPE_MISMATCH_ERR","PATH_EXISTS_ERR"];_at.h.j=[137,80,78,71,13,10,26,10];_at.h.h=[71,73,70,56,55,97];_at.h.i=[71,73,70,56,57,97];_at.h.g=[66,77];_at.v.a=_a.a.c;_at.v.b=!1;_at.g.a=_a.a.c;_at.d.a=_a.a.c;_at.d.d="application/octet-stream";_at.d.b="application/vnd.ms-excel";_at.d.e="application/msword";_at.d.c="application/vnd.ms-powerpoint";_at.d.f={".abc":"text/vnd.abc",".acgi":"text/html",".afl":"video/animaflex",".aif":"audio/aiff",".aifc":"audio/aiff",".aiff":"audio/aiff",".aip":"text/x-audiosoft-intra",".art":"image/x-jg",".asf":"video/x-ms-asf",".asm":"text/x-asm",".asp":"text/asp",".asx":"video/x-ms-asf",".au":"audio/basic",".avi":"video/avi",".avs":"video/avs-video",".bm":"image/bmp",".bmp":"image/bmp",".c":"text/plain",".c++":"text/plain",".cat":"application/vnd.ms-pki.seccat",".cc":"text/plain",".chm":"application/vnd.ms-htmlhelp",".conf":"text/plain",".cpp":"text/x-c",".cs":"text/plain",".css":"text/css",".csv":_at.d.b,".cxx":"text/plain",".def":"text/plain",".dif":"video/x-dv",".dl":"video/dl",".doc":_at.d.e,".docm":"application/vnd.ms-word.document.macroEnabled.12",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".dot":_at.d.e,".dotm":"application/vnd.ms-word.template.macroEnabled.12",".dotx":"application/vnd.openxmlformats-officedocument.wordprocessingml.template",".dv":"video/x-dv",".dwg":"image/vnd.dwg",".dxf":"image/vnd.dwg",".el":"text/x-script.elisp",".etx":"text/x-setext",".f":"text/plain",".f77":"text/x-fortran",".f90":"text/plain",".fif":"image/fif",".fli":"video/fli",".flo":"image/florian",".flx":"text/vnd.fmi.flexstor",".fmf":"video/x-atomic3d-feature",".for":"text/x-fortran",".fpx":"image/vnd.fpx",".funk":"audio/make",".g":"text/plain",".g3":"image/g3fax",".gif":"image/gif",".gl":"video/gl",".gsd":"audio/x-gsm",".gsm":"audio/x-gsm",".h":"text/plain",".hh":"text/plain",".hlb":"text/x-script",".htc":"text/x-component",".htm":"text/html",".html":"text/html",".htmls":"text/html",".htt":"text/webviewhtml",".htx":"text/html",".hxx":"text/plain",".ico":"image/x-icon",".idc":"text/plain",".ief":"image/ief",".iefs":"image/ief",".isu":"video/x-isvideo",".it":"audio/it",".jam":"audio/x-jam",".jav":"text/plain",".java":"text/plain",".jfif":"image/jpeg",".jfif-tbnl":"image/jpeg",".jpe":"image/jpeg",".jpeg":"image/jpeg",".jpg":"image/jpeg",".jps":"image/x-jps",".jut":"image/jutvision",".kar":"audio/midi",".la":"audio/nspaudio",".lam":"audio/x-liveaudio",".list":"text/plain",".lma":"audio/nspaudio",".log":"text/plain",".lst":"text/plain",".lsx":"text/x-la-asf",".m":"text/plain",".m1v":"video/mpeg",".m2a":"audio/mpeg",".m2v":"video/mpeg",".m3u":"audio/x-mpequrl",".mar":"text/plain",".mcf":"text/mcf",".mid":"audio/midi",".midi":"audio/midi",".mjf":"audio/x-vnd.audioexplosion.mjuicemediafile",".mjpg":"video/x-motion-jpeg",".mod":"audio/mod",".moov":"video/quicktime",".mov":"video/quicktime",".movie":"video/x-sgi-movie",".mp2":"audio/mpeg",".mp3":"audio/mpeg",".mp4":"video/mp4",".mpa":"audio/mpeg",".mpe":"video/mpeg",".mpeg":"video/mpeg",".mpg":"video/mpeg",".mpga":"audio/mpeg",".mpp":"application/vnd.ms-project",".mpt":"application/vnd.ms-project",".mpv":"application/vnd.ms-project",".mpx":"application/vnd.ms-project",".mv":"video/x-sgi-movie",".my":"audio/make",".nap":"image/naplps",".naplps":"image/naplps",".nif":"image/x-niff",".niff":"image/x-niff",".ogg":"video/ogg",".ogv":"video/ogg",".p":"text/x-pascal",".pas":"text/pascal",".pbm":"image/x-portable-bitmap",".pct":"image/x-pict",".pcx":"image/x-pcx",".pdf":"application/pdf",".pfunk":"audio/make",".pgm":"image/x-portable-greymap",".pic":"image/pict",".pict":"image/pict",".pko":"application/vnd.ms-pki.pko",".pl":"text/plain",".pm":"image/x-xpixmap",".png":"image/png",".pot":_at.d.c,".potm":"application/vnd.ms-powerpoint.template.macroEnabled.12",".potx":"application/vnd.openxmlformats-officedocument.presentationml.template",".ppa":_at.d.c,".ppam":"application/vnd.ms-powerpoint.addin.macroEnabled.12",".ppm":"image/x-portable-pixmap",".pps":_at.d.c,".ppsm":"application/vnd.ms-powerpoint.slideshow.macroEnabled.12",".ppsx":"application/vnd.openxmlformats-officedocument.presentationml.slideshow",".ppt":_at.d.c,".pptm":"application/vnd.ms-powerpoint.presentation.macroEnabled.12",".pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation",".ppz":_at.d.c,".pwz":_at.d.c,".py":"text/x-script.phyton",".qcp":"audio/vnd.qcelp",".qif":"image/x-quicktime",".qt":"video/quicktime",".qtc":"video/x-qtc",".qti":"image/x-quicktime",".qtif":"image/x-quicktime",".ra":"audio/x-pn-realaudio",".ram":"audio/x-pn-realaudio",".rast":"image/cmu-raster",".rexx":"text/x-script.rexx",".rf":"image/vnd.rn-realflash",".rgb":"image/x-rgb",".rmi":"audio/mid",".rmm":"audio/x-pn-realaudio",".rmp":"audio/x-pn-realaudio",".rp":"image/vnd.rn-realpix",".rpm":"audio/x-pn-realaudio-plugin",".rt":"text/richtext",".rtf":"text/richtext",".rtx":"text/richtext",".rv":"video/vnd.rn-realvideo",".s":"text/x-asm",".s3m":"audio/s3m",".sdml":"text/plain",".sgm":"text/sgml",".sgml":"text/sgml",".shtml":"text/html",".sid":"audio/x-psid",".sldm":"application/vnd.ms-powerpoint.slide.macroEnabled.12",".sldx":"application/vnd.openxmlformats-officedocument.presentationml.slide",".snd":"audio/basic",".spc":"text/x-speech",".ssi":"text/x-server-parsed-html",".sst":"application/vnd.ms-pki.certstore",".svf":"image/vnd.dwg",".talk":"text/x-speech",".tcsh":"text/x-script.tcsh",".text":"text/plain",".tif":"image/tiff",".tiff":"image/tiff",".tsi":"audio/tsp-audio",".tsv":"text/tab-separated-values",".turbot":"image/florian",".txt":"text/plain",".uil":"text/x-uil",".uni":"text/uri-list",".unis":"text/uri-list",".uri":"text/uri-list",".uris":"text/uri-list",".uue":"text/x-uuencode",".vcs":"text/x-vcalendar",".vdo":"video/vdo",".viv":"video/vivo",".vivo":"video/vivo",".voc":"audio/voc",".vos":"video/vosaic",".vox":"audio/voxware",".vqe":"audio/x-twinvq-plugin",".vqf":"audio/x-twinvq",".vql":"audio/x-twinvq-plugin",".vsd":"application/x-visio",".vst":"application/x-visio",".vsw":"application/x-visio",".w6w":"application/msword",".wav":"audio/wav",".wbmp":"image/vnd.wap.wbmp",".webm":"video/webm",".wiz":"application/msword",".wm":"video/x-ms-wm",".wma":"audio/x-ms-wma",".wmf":"windows/metafile",".wml":"text/vnd.wap.wml",".wmls":"text/vnd.wap.wmlscript",".wmp":"video/x-ms-wmp",".wmv":"video/x-ms-wmv",".wmx":"video/x-ms-wmx",".word":"application/msword",".wsc":"text/scriplet",".wvx":"video/x-ms-wvx",".xbm":"image/x-xbitmap",".xdr":"video/x-amt-demorun",".xif":"image/vnd.xiff",".xl":"application/excel",".xla":_at.d.b,".xlam":"application/vnd.ms-excel.addin.macroEnabled.12",".xlb":_at.d.b,".xlc":_at.d.b,".xld":_at.d.b,".xlk":_at.d.b,".xll":_at.d.b,".xlm":_at.d.b,".xls":_at.d.b,".xlsb":"application/vnd.ms-excel.sheet.binary.macroEnabled.12",".xlsm":"application/vnd.ms-excel.sheet.macroEnabled.12",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".xlt":_at.d.b,".xltm":"application/vnd.ms-excel.template.macroEnabled.12",".xltx":"application/vnd.openxmlformats-officedocument.spreadsheetml.template",".xlv":_at.d.b,".xlw":_at.d.b,".xm":"audio/xm",".xpm":"image/xpm",".xps":"application/vnd.ms-xpsdocument",".x-png":"image/png",".xsr":"video/x-amt-showrun",".xwd":"image/x-xwd",".zsh":"text/x-script.zsh"};_at.B.a=_a.o.a().I&&!_a.o.a().N;_at.f.c=new _a.e("Attachment",_g.Attachment,_at.f);_at.f.e=new _a.e("ParentItemId",_g.e,_at.f);_at.f.g=new _a.e("IsEnabled",Boolean,_at.f);_at.f.d=new _a.e("FileSelectedCommand",_j.N,_at.f);_at.f.b=new _a.e("UploadAttachmentCommand",_j.N,_at.f);_at.f.f=new _a.e("UploadCompletedCommand",_j.N,_at.f);_at.f.a=_a.a.c;_at.z.b=new RegExp("https://www.bing.com/th\\?u=.+&pid=Outlook&hkey=.+","i");_at.b.i=null;_at.b.a=null;_at.b.c=null;_at.b.g=null;_at.b.e=null;_at.b.f=null;_at.b.l=null;_at.b.k=null;_at.b.j=null;_at.b.h=null;_at.j.d=_at.j.h();_at.j.b=null;_at.j.a={};_at.j.$$cctor();
window.scriptsLoaded['microsoft.owa.core.attachments.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.attachments.js'] = (new Date()).getTime();
