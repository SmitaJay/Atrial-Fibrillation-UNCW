window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.common.compose.js'] = (new Date()).getTime();
Type.registerNamespace("_cmc");_cmc.cc=function(){};_cmc.cc.registerInterface("_cmc.cc");_cmc.bZ=function(){};_cmc.bZ.registerInterface("_cmc.bZ");_cmc.bY=function(){};_cmc.bY.registerInterface("_cmc.bY");_cmc.ca=function(){};_cmc.ca.registerInterface("_cmc.ca");_cmc.cb=function(){};_cmc.cb.registerInterface("_cmc.cb");_cmc.Q=function(n,t,i,r){this.j=n;this.i=t;this.g=i;this.h=r};_cmc.Q.prototype={j:0,c:function(){return this.j},h:0,a:function(){return this.h},g:0,d:function(){return this.g},i:0,b:function(){return this.i},f:function(){return Math.max(this.i-this.h,0)},e:function(){return Math.max(this.g-this.j,0)}};_cmc.i=function(n,t,i,r,u,f){this.W=Function.createDelegate(this,this.bf);this.Y=Function.createDelegate(this,this.bn);this.H=Function.createDelegate(this,this.O);this.R=Function.createDelegate(this,this.bb);this.X=Function.createDelegate(this,this.bm);this.p=n;this.z=t;this.u=i;this.y=r;this.K=u;this.V=f};_cmc.i.prototype={v:null,D:null,q:null,x:null,C:null,r:null,L:null,F:null,K:0,A:null,p:null,z:null,u:null,Q:0,M:0,I:0,N:0,t:!1,y:null,P:null,w:!1,s:!1,G:!1,E:null,V:null,B:null,U:!1,k:function(){return this.v},d:function(n){this.v=n;return n},b:function(n){this.p&&this.p.d(n)},a:function(n){this.p&&this.p.e(n)},e:function(n){this.B||(this.B=new _j.Q);this.B.b(n)},f:function(n){this.B&&this.B.c(n)},T:function(){return this.v.z.offsetTop-this.p.z.scrollTop},S:function(){var n=this.D&&this.D.z?this.D.z.offsetTop:0;return this.T()+n},J:function(){return this.L?this.L.z.offsetHeight:0},bj:function(){var n=this.r.z.getBoundingClientRect();var t=this.x.z.getBoundingClientRect();return t.top-n.bottom-this.J()},c:function(){this.i();this.p=null;this.z=null;this.u=null;this.y=null;this.E=null},m:function(){return this.p?new _y.gU(this.p.z.scrollTop):null},o:function(n,t,i){if(this.p&&this.p.z.contains(n)){var r=this.p.z;var e=n.getBoundingClientRect();var o=r.getBoundingClientRect();if(e&&o){var f=e.bottom+i+this.J()-o.top;this.s&&(f=f+_j.k.g(this.u.z));var u=r.scrollTop+(f-r.clientHeight);t&&t.a>u&&(u=t.a);u=Math.min(u,r.scrollHeight-r.clientHeight);r.scrollTop!==u&&(r.scrollTop=u)}else _j.e.b(_cmc.i.a,"[ComposeScrollManager: ScrollIntoView] - failed to obtain client rect, scroll does not happen")}},h:function(n,t,i){if(this.w){var u=this.S();n.val-=u;t.val+=u;var r=this.A.offsetHeight;if(r>1){n.val-=r-10;t.val+=r-10}if(i){n.val-=i+10;t.val+=i+10}}this.s&&(t.val-=this.Z())},l:function(){var t=this.q?this.q.z:null;var i=t?_j.x.a(t):null;var f=null;if(i){var e=i.documentElement.clientHeight;var o=i.documentElement.clientWidth;var n=t.getBoundingClientRect();var r=this.z&&this.w?Math.max(this.z.z.getBoundingClientRect().bottom,n.top):n.top;r=Math.max(0,r);var s=Math.min(n.right,o);var u=this.u&&this.s?this.u.z.getBoundingClientRect().top-this.J():n.bottom;u=Math.min(u,e);var h=Math.max(0,n.left);f=new _cmc.Q(r,s,u,h)}return f},bq:function(){if(this.p){_j.e.a(_cmc.i.a,"SetUpEventListeners called");if(!this.V.b()&&window.self.MutationObserver){this.E||(this.E=new MutationObserver(this.X));var n={};n.attributes=!0;n.childList=!0;n.subtree=!0;this.E.observe(this.p.z,n)}else this.p.bd("DOMSubtreeModified",this.R,"ComposeScrollManager");this.b(this.H);this.v&&this.v.bd("keyup",this.Y,"ComposeScrollManager");try{if(this.y&&!this.y.closed){var t=_j.x.b(this.y);t.b("resize",this.R,"ComposeScrollManager")}else _y.c.a.n(this.H)}catch(i){_j.e.d(_cmc.i.a,i,"Exception binding to projection window resize event.")}}},bg:function(){if(this.p){_j.e.a(_cmc.i.a,"CleanUpEventListeners called");this.E?this.E.disconnect():this.p.bi("DOMSubtreeModified","ComposeScrollManager");this.a(this.H);this.v&&this.v.bi("keyup","ComposeScrollManager");try{if(this.y&&!this.y.closed){var n=_j.x.b(this.y);n.c("resize","ComposeScrollManager")}else _y.c.a.o(this.H)}catch(t){_j.e.d(_cmc.i.a,t,"Exception unbinding to projection window resize event.")}}},j:function(n,t,i,r,u,f,e,o,s){_j.e.a(_cmc.i.a,"SetComposeViewObjects");this.D=n;this.q=t;this.x=r;this.r=i;this.L=u;this.F=f;this.U=o;this.Q=0;this.M=this.p.z.scrollTop;this.I=this.q.z.offsetTop;this.N=0;this.bq();this.G=!0;e&&this.o(this.D.z,new _y.gU(this.p.z.scrollTop),60+s)},i:function(){if(this.G){this.w&&this.be();this.s&&this.bd();this.G=!1;this.bg();this.x=null;this.r=null;this.q=null;this.D=null;this.L=null;this.F=null}},n:function(n,t){if(n&&t){var i=this.p.z;var r=_j.k.j(t);var f=i.scrollTop;n();var u=_j.k.j(t);u.a!==r.a&&i.scrollHeight>i.clientHeight&&(i.scrollTop=Math.max(0,f+u.a-r.a))}},g:function(n){this.O()},bm:function(n,t){var f=this.q.z;var i=this.p.z;var r=0;var u=0;if(this.U){u=f.offsetTop;r=u-this.I}if(r>0&&this.M===i.scrollTop){i.scrollTop+=r;this.M=i.scrollTop;this.I=u}else this.bb(null)},bb:function(n){this.t||this.P||(this.P=_j.m.a().a(_cmc.i.a,"ComposeScrollManager.OnDomSizeChanged",this.W,50))},bf:function(){this.P=null;if(this.G&&!this.t){var n=this.p.z.scrollHeight;var t=this.q.z.offsetHeight;if(n!==this.Q||t!==this.N){this.O();this.Q=n;this.N=t}}},bn:function(n){_j.e.a(_cmc.i.a,"OnKeyUpOnComposeControl called.");this.O();if((this.w||this.s)&&this.q&&n.b()&&this.q.z.contains(n.b())&&_cmc.a.a(n.b())!=="TEXTAREA"){var e=_j.x.a(this.q.z);var l=e.defaultView||e.parentWindow;var i=l?l.getSelection():null;var a=i&&i.rangeCount>0?i.getRangeAt(0):null;var r=a?a.cloneRange():null;if(r&&!r.collapsed){var b=i.focusNode===i.anchorNode?i.focusOffset>i.anchorOffset:i.anchorNode.compareDocumentPosition(i.focusNode)===4;r.collapse(!b)}if(r){var u=this.bl(r.getClientRects());var o=!1;if(!u){var t=r.startContainer;if(t.nodeType===1&&r.startOffset<t.childNodes.length){t=t.childNodes[r.startOffset];while(t.hasChildNodes())t=t.firstChild}if(t.nodeType===1){u=t.getBoundingClientRect();o=t.hasChildNodes()&&(t.childNodes.length>1||!_cmc.a.e(t.childNodes[0]))}else{var v=e.createRange();v.selectNodeContents(t);u=v.getBoundingClientRect();o=!0}}if(u){var f=0;var s=u.top;var y=o?Math.min(s+30,u.bottom):u.bottom;if(this.s){var h=this.u.z.getBoundingClientRect();if(h&&h.height){var p=h.top-this.J()-5;y>p&&(f=y-p)}}if(!f&&this.w){var c=this.z.z.getBoundingClientRect();if(c&&c.height){var w=c.bottom+5;s<w&&(f=s-w)}}f&&(this.p.z.scrollTop+=f)}}}},bi:function(){_j.e.a(_cmc.i.a,"DockTop called");this.t=!0;this.A=this.r.z.cloneNode(!0);this.r.z.parentNode.insertBefore(this.A,this.r.z);this.A.style.visibility="hidden";this.r.z.style.position="absolute";this.z.K(!1);this.z.z.appendChild(this.r.z);this.w=!0;this.t=!1},be:function(){_j.e.a(_cmc.i.a,"UndockTop called");this.t=!0;var n=this.A.parentNode;n.insertBefore(this.r.z,n.firstChild);this.z.K(!0);this.r.z.style.position="";_j.k.e(this.A);this.A=null;this.w=!1;this.t=!1},bh:function(){_j.e.a(_cmc.i.a,"DockComposeBottomEdge called");this.t=!0;this.C=this.x.z.cloneNode(!0);this.x.z.parentNode.insertBefore(this.C,this.x.z);this.C.style.visibility="hidden";this.u.K(!1);this.u.z.appendChild(this.x.z);this.s=!0;this.t=!1},bd:function(){_j.e.a(_cmc.i.a,"UndockComposeBottomEdge called");this.t=!0;var n=this.C.parentNode;n.appendChild(this.x.z);this.u.K(!0);_j.k.e(this.C);this.C=null;this.s=!1;this.t=!1},Z:function(){var t=this.v.z.offsetHeight;var n=t+this.T()-this.p.z.clientHeight;_j.e.a(_cmc.i.a,"ComposeControlOverflowHeight is "+n+"px.");return n},ba:function(){var n=this.S()+this.q.z.clientHeight+this.r.z.offsetHeight-this.K;_j.e.a(_cmc.i.a,"GetComposeEditorHeightInViewFromTop is "+n+"px.");return n},bk:function(){var t=!this.F||!this.F.z?0:this.F.z.offsetHeight;var n=this.p.z.clientHeight-(this.T()+this.q.z.offsetTop-t);n-=60+this.J();_j.e.a(_cmc.i.a,"GetComposeEditorHeightInViewFromBottom is "+n+"px.");return n},O:function(){if(this.G&&this.v&&this.p){_j.e.a(_cmc.i.a,"RecalculateDockState: Recalculating dock state.");this.bp();this.bo();this.I=this.q.z.offsetTop;this.M=this.p.z.scrollTop}},bp:function(){var n=this.S()+this.r.z.offsetHeight;if(!this.w&&n<this.K&&this.ba()>=10){_j.e.a(_cmc.i.a,"RecalculateTopDocking: top is reached and editor height in view is >= ComposeEditorMinHeight, dock header.");this.bi()}else if(this.w&&(n>=this.K||this.ba()<10)){_j.e.a(_cmc.i.a,"RecalculateTopDocking: undock top as inline compose is docked and editor height is going below the minimum height.");this.be()}},bo:function(){var n=this.Z();if(this.s&&(n<=1||this.bj()<10)){_j.e.a(_cmc.i.a,"RecalculateBottomDocking: undock bottom as inline compose is either moving up to its max height or editor height is less than minimum.");this.bd();this.bc()}else if(!this.s&&n>0&&this.bk()>=10){_j.e.a(_cmc.i.a,"RecalculateBottomDocking: bottom is reached and editor height in view is >= ComposeEditorMinHeight, docking bottome edge.");this.bh();this.bc()}},bc:function(){this.B&&this.B.a()},bl:function(n){var i=null;if(n)for(var t=0;t<n.length;t++)if(n[t].height){i=n[t];break}return i}};_cmc.K=function(n,t){_cmc.K.initializeBase(this,[n,t])};_cmc.K.prototype={s:function(){return!1},a:0,h:!1,l:!1,g:0,i:!1,k:0,c:null,b:0,f:!1,d:!1,e:function(n){var i=this.c;if(i){this.j(n);var r=i.a;this.z&&this.d&&(r=r-(this.l?this.k:n.z.offsetWidth));var e=this.m(r,n).toString()+"px";n.z.style.left=e;var t=i.b;var u=!1;this.f&&(u=this.q(n,i.b)>0&&this.u(n,i.c)<=0);var f=!1;if(!this.b||u){t=i.c;t=t-this.a;this.i?f=!0:t=t-(this.h?this.g:n.z.offsetHeight)}else t=t+this.a;f?n.z.style.bottom=this.n(t,n).toString()+"px":n.z.style.top=this.y(t,n).toString()+"px"}else _j.e.c(this.o(),"CursorPointPopupLayout: AdjustPosition - anchorPosition is null")},j:function(n){n.z.style.top="";n.z.style.left="";n.z.style.right="";n.z.style.bottom=""},p:function(n,t,i){return null},o:function(){return _a.a.r},m:function(n,t){var r=_j.x.a(t.z);var f=_j.x.c(r);var u=f.pageXOffset;var e=u!==undefined?u:r.body.scrollLeft;var i=Math.min(n,this.C(_j.x.a(t.z))-(this.l?this.k:t.z.offsetWidth)+e);i=Math.max(i,0);return i},q:function(n,t){var r=_j.x.a(n.z);var i=t;i=i+this.a;i=i+(this.h?this.g:n.z.offsetHeight);i=i+this.t(r)-r.documentElement.clientHeight;return Math.max(0,i)},u:function(n,t){var i=_j.x.a(n.z);return this.a+(this.h?this.g:n.z.offsetHeight)+this.t(i)-t},n:function(n,t){var i=_j.x.a(t.z);return Math.max(this.be(i)-this.t(i)-n,0)}};_cmc.L=function(n,t,i){this.c=n;this.b=t;this.a=i};_cmc.L.prototype={c:0,b:0,a:0};_cmc.m=function(n,t,i){_cmc.m.initializeBase(this,[n,t,i])};_cmc.J=function(n,t,i){_cmc.J.initializeBase(this,[n,t,i])};_cmc.bC=function(){};_cmc.bC.prototype={a:function(n,t){return _cmc.a.a(n)==="SPAN"&&n.className&&_j.k.p(n,"mention")&&n.id&&n.id.startsWith("OWAALLAM")?new _cmc.J(n,t,null):null}};_cmc.bp=function(n,t){_cmc.bp.initializeBase(this,[n]);this.f=t;this.h=this.f?this.f.h():null};_cmc.bp.prototype={f:null,h:null,e:function(){return null},d:function(){return this.h},c:function(){var n=null;var t=_cmc.bX.prototype.a.call(this)?_cmc.bX.prototype.c.call(this):this.f?this.f.n():null;var i=this.h;if(t&&i&&i.d(t)){n=t;_cmc.bX.prototype.g.call(this,n)}return n},a:function(){var t=_cmc.bX.prototype.a.call(this);if(!t&&this.f&&this.h){var n=this.f.l();if(n&&this.h.d(n)){t=n;_cmc.bX.prototype.g.call(this,n)}}return t},b:function(){var n=null;if(this.a()){var t=_cmc.bX.prototype.b.call(this);if(t&&this.h&&this.h.d(t)){n=t;_cmc.bX.prototype.g.call(this,n)}}return n}};_cmc.o=function(n){this.b=n};_cmc.o.prototype={b:null,a:function(n){var t=null;if(n&&_cmc.a.c(this.b,n)){var i=n.parentNode;t=n.nextSibling;while(!t&&i!==this.b){t=i.nextSibling;i=i.parentNode}while(t&&t.firstChild)t=t.firstChild;t&&_cmc.a.b(t)&&(t=this.a(t))}return t},c:function(n){var t=null;if(n&&_cmc.a.c(this.b,n)){var i=n.parentNode;t=n.previousSibling;while(!t&&i!==this.b){t=i.previousSibling;i=i.parentNode}while(t&&t.lastChild)t=t.lastChild;t&&_cmc.a.b(t)&&(t=this.c(t))}return t},e:function(n){var e=null;if(n&&_cmc.a.c(this.b,n)){for(var t=n,i=t,r=!1;!_cmc.a.d(t)&&!r;){while(t.previousSibling){var f=t.previousSibling;if(_cmc.a.d(f)||_cmc.a.e(f)){r=!0;break}t=f}while(i.nextSibling){var u=i.nextSibling;var o=!1;if(_cmc.a.d(u)||(o=_cmc.a.e(u))){o&&(i=u);i!==i.parentNode.lastChild&&(r=!0);break}i=u}if(!r)if(t.parentNode!==this.b)i=t=t.parentNode;else break}e=_cmc.a.d(t)?new _cmc.bI(t):new _cmc.bL(this.b,t,i)}return e},g:function(n){var i=null;if(n)if(_cmc.d.isInstanceOfType(n)&&n.m())i=n.m();else{var t=n.a();do{t=this.c(t);i=t?this.d(t):null}while(!i&&t)}return i},k:function(n){var i=null;if(n)if(_cmc.d.isInstanceOfType(n)&&n.l())i=n.l();else{var t=n.a();do{t=this.a(t);i=t?this.d(t):null}while(!i&&t)}return i},j:function(n){var t=null;if(n){var i=this.a(n.c());t=i?this.e(i):null}return t},h:function(n){return this.e(n.a)},d:function(n){var i=null;var r=_cmc.a.d(n)?null:this.e(n);if(r){var t=n;var u=[t];t=t.parentNode;while(t&&r.g(t)){u.push(t);t=t.parentNode}for(var f=u.length-1;f>=0;f--){var h=u[f];if(i=_cmc.u.b().c(h,this.b))break}if(!i)for(var e=u.length-1;e>=0;e--){var o=u[e];var s=_cmc.a.a(o);if(s==="A"){i=new _cmc.m(o,this.b,r);break}else if(s==="IMG"){i=new _cmc.w(o,this.b,r);break}}i||(i=n.nodeType===3?new _cmc.D(n,this.b,r):new _cmc.ba(n,this.b,r))}return i},i:function(n){var i=null;var t=n.a;var r=n.b;if(t){var u=!1;t.nodeType===3&&r===t.nodeValue.length||t.nodeType===1&&r===1?t=this.a(t):t.nodeType===3&&r>0&&r<t.nodeValue.length&&(u=!0);t&&_cmc.a.b(t)&&(t=this.a(t));i=t?this.d(t):null;u=u||!!i&&i.g(n);u&&i&&(i=new _cmc.d(i,n,null))}return i},f:function(n){var i=null;var t=n.a;var u=n.b;if(t){var r=!1;u?t.nodeType===3&&u<t.nodeValue.length&&(r=!0):t=this.c(t);t&&_cmc.a.b(t)&&(t=this.c(t));i=t?this.d(t):null;r=r||!!i&&i.g(n);r&&i&&(i=new _cmc.d(i,null,n))}return i}};_cmc.a=function(){};_cmc.a.d=function(n){var t=_cmc.a.h(n);return t==="block"||t==="list-item"||t==="table-cell"};_cmc.a.g=function(n){return _cmc.a.h(n)==="none"};_cmc.a.e=function(n){return _cmc.a.a(n)==="BR"};_cmc.a.a=function(n){return n&&n.nodeType===1?n.tagName.toUpperCase():""};_cmc.a.h=function(n){var r="";if(n&&n.nodeType===1){var t=n.ownerDocument?n.ownerDocument.parentWindow:null;t=t||window.self;var i=t.getComputedStyle(n);r=i&&"display"in i?i.display.toLowerCase():""}return r};_cmc.a.j=function(n){return _cmc.a.a(n)==="SPAN"&&!!n.id&&n.id.startsWith("ms-rte")};_cmc.a.b=function(n){return _cmc.a.g(n)||_cmc.a.j(n)};_cmc.a.c=function(n,t){var r=!1;if(n&&t&&n.nodeType===1){var i=t;var u=!1;if(t.nodeType!==1){i=t.parentNode;u=!0}r=u&&n===i||jQuery.contains(n,i)}return r};_cmc.a.f=function(n){return!!n&&(_cmc.D.isInstanceOfType(n)||_cmc.d.isInstanceOfType(n)&&_cmc.D.isInstanceOfType(n.k))};_cmc.a.i=function(n){return _cmc.d.isInstanceOfType(n)?n.k:n};_cmc.bq=function(n,t){_cmc.bq.initializeBase(this,[n]);this.f=t};_cmc.bq.prototype={f:null,d:function(){var n=_cmc.bX.prototype.d.call(this);n||(n=this.f?this.f.h():null);return n},e:function(){var n=null;var t=_cmc.bX.prototype.e.call(this);if(t){n=t;_cmc.bX.prototype.g.call(this,n.k())}return n},c:function(){var n=null;var t=_cmc.bX.prototype.a.call(this)?_cmc.bX.prototype.c.call(this):this.f?this.f.n():null;if(t){n=t;_cmc.bX.prototype.g.call(this,n)}return n},a:function(){var n=_cmc.bX.prototype.a.call(this);if(!n&&this.f){var t=this.f.l();if(t){n=t;_cmc.bX.prototype.g.call(this,t)}}return n},b:function(){var n=null;if(this.a()){var t=_cmc.bX.prototype.b.call(this);if(t){n=t;_cmc.bX.prototype.g.call(this,n)}}return n}};_cmc.bX=function(n){this.k=n;this.j=new _cmc.o(n)};_cmc.bX.prototype={k:null,j:null,i:null,e:function(){var n=this.d();var t=n?this.j.j(n):null;return t&&t.e(n)?t:null},d:function(){return this.i?this.i.c():null},b:function(){var n=this.a();var t=n?this.j.k(n):null;return t&&t.e(n)?t:null},c:function(){var n=this.a();var t=n?this.j.g(n):null;return t&&t.d(n)?t:null},a:function(){return this.i},g:function(n){this.i=n;return n}};_cmc.Y=function(n,t){this.a=n;this.b=t};_cmc.Y.prototype={a:null,b:0,e:function(n){return this.a===n.a&&this.b===n.b},d:function(n){var t=!0;if(this.a===n.a)t=n.b<this.b;else{var i=this.a.compareDocumentPosition(n.a);t=(i&2)==2}return t},c:function(n){var t=!0;if(this.a===n.a)t=n.b>this.b;else{var i=this.a.compareDocumentPosition(n.a);t=(i&4)==4}return t}};_cmc.S=function(n,t){this.p=n;this.e=new _cmc.o(n);if(t){this.c=t.cloneRange();this.d=this.o(this.c.startContainer,this.c.startOffset);this.g=this.o(this.c.endContainer,this.c.endOffset)}};_cmc.S.prototype={p:null,e:null,c:null,d:null,g:null,j:null,i:null,a:null,b:null,m:!1,f:function(){return this.c?this.c.collapsed:!0},n:function(){!this.i&&this.d&&(this.i=this.e.f(this.d));return this.i},l:function(){this.k();return this.a},h:function(){!this.j&&this.d&&(this.j=this.e.h(this.d));return this.j},q:function(n){this.k();var u=null;if(n&&this.a&&this.b){var t=null;var i=null;var r=null;if(_cmc.d.isInstanceOfType(n)){t=n.k;i=n.i;r=n.j}else t=n;this.a.e(t)?t=null:t.a()===this.a.a()&&_cmc.d.isInstanceOfType(this.a)&&this.a.i&&(!i||this.a.i.d(i))&&(i=this.a.i);t&&(this.b.d(t)?t=null:t.a()===this.b.a()&&_cmc.d.isInstanceOfType(this.b)&&this.b.j&&(!r||this.b.j.c(r))&&(r=this.b.j));t&&(u=!i&&!r?t:i&&r&&i.e(r)?null:new _cmc.d(t,i,r))}return u},s:function(n){this.k();var r=!1;if(!this.f()&&n){var t=this.a?this.a.c():null;var i=this.b?this.b.c():null;t&&i&&(n.h(t)||n.h(i)||t.i(n)&&i.e(n))&&(r=!0)}return r},k:function(){if(!this.m){this.r();this.m=!0}},r:function(){if(this.c&&this.d&&this.g){this.a=this.e.i(this.d);if(this.f())this.b=this.a;else{this.b=this.e.f(this.g);if(this.a&&this.b&&this.a.a()===this.b.a()){var t=null;var n=null;if(_cmc.d.isInstanceOfType(this.a)){t=this.a.i;n=this.a.k}else n=this.a;var i=_cmc.d.isInstanceOfType(this.b)?this.b.j:null;this.a=this.b=!t&&!i?n:new _cmc.d(n,t,i)}}}},o:function(n,t){var i=n;var r=t;if(i.nodeType===1&&i.hasChildNodes())if(t<i.childNodes.length){i=n.childNodes[t];r=0}else{i=n.childNodes[t-1];r=i.nodeType===3?i.nodeValue.length:1}if(i.hasChildNodes())if(r)while(i.lastChild){i=i.lastChild;r=i.nodeType===3?i.nodeValue.length:1}else while(i.firstChild)i=i.firstChild;return new _cmc.Y(i,r)}};_cmc.bs=function(n,t){_cmc.bs.initializeBase(this,[n]);this.f=t};_cmc.bs.prototype={f:null,d:function(){var n=_cmc.bX.prototype.d.call(this);if(!n){var t=this.a();n=t?t.c():null}return n},e:function(){var t=null;var i=this.d();if(i&&this.f){var n=_cmc.bX.prototype.e.call(this);if(n&&this.f.s(n)){t=n;_cmc.bX.prototype.g.call(this,n.m())}}return t},c:function(){var t=null;if(this.f&&!this.f.f()){var i=this.a();var n=i?_cmc.bX.prototype.c.call(this):null;n=n?this.f.q(n):null;if(n&&n.d(i)){t=n;_cmc.bX.prototype.g.call(this,n)}}return t},a:function(){var n=_cmc.bX.prototype.a.call(this);if(!n&&this.f&&!this.f.f()){var t=this.f.l();if(t){n=t;_cmc.bX.prototype.g.call(this,t)}}return n},b:function(){var t=null;if(this.f&&!this.f.f()){var i=this.a();var n=i?_cmc.bX.prototype.b.call(this):null;n=this.f.q(n);if(n&&n.e(i)){t=n;_cmc.bX.prototype.g.call(this,n)}}return t}};_cmc.u=function(){this.a=new Array(0)};_cmc.u.b=function(){if(!_cmc.u.a){_cmc.u.a=new _cmc.u;_cmc.u.a.b(new _cmc.bJ);_cmc.u.a.b(new _cmc.bC);_cmc.u.a.b(new _cmc.bK)}return _cmc.u.a};_cmc.u.prototype={a:null,b:function(n){this.a.push(n)},c:function(n,t){for(var r=null,i=0;i<this.a.length;i++){var u=this.a[i];if(u&&(r=u.a(n,t)))break}return r}};_cmc.w=function(n,t,i){_cmc.w.initializeBase(this,[n,t,i])};_cmc.N=function(n,t,i){_cmc.N.initializeBase(this,[n,t,i])};_cmc.bJ=function(){};_cmc.bJ.prototype={a:function(n,t){return _cmc.a.a(n)==="A"&&n.className&&_j.k.p(n,"mention")&&n.id&&n.id.startsWith("OWAAM")?new _cmc.N(n,t,null):null}};_cmc.p=function(n,t,i,r){_cmc.p.initializeBase(this,[n,t,r]);this.l=i};_cmc.p.c=function(){var n=document.createElement(_cmc.p.b);n.id=_cmc.p.a+_cmc.f.a();return n};_cmc.p.prototype={l:null};_cmc.bK=function(){};_cmc.bK.prototype={a:function(n,t){return _cmc.a.a(n)===_cmc.p.b&&n.id&&n.id.startsWith(_cmc.p.a)?new _cmc.p(n,t,n.id,null):null}};_cmc.D=function(n,t,i){_cmc.D.initializeBase(this,[n,t,i])};_cmc.bI=function(n){this.n=n};_cmc.bI.prototype={n:null,o:null,p:null,a:function(){return this.n},c:function(){return this.n},k:function(){if(!this.o){for(var n=this.n;n.firstChild;)n=n.firstChild;var t=new _cmc.o(this.n);n&&_cmc.a.b(n)&&(n=t.a(n));this.o=n&&this.g(n)?t.d(n):null}return this.o},m:function(){if(!this.p){for(var n=this.n;n.lastChild;)n=n.lastChild;var t=new _cmc.o(this.n);n&&_cmc.a.b(n)&&(n=t.c(n));this.p=n&&this.g(n)?t.d(n):null}return this.p},b:function(){return this.n.textContent},j:function(){return[this.n]},l:function(){return!0},h:function(n){return this.n===n.a()},i:function(n){var t=this.n.compareDocumentPosition(n.a());return(t&4)==4},e:function(n){var t=this.n.compareDocumentPosition(n.a());return(t&2)==2},d:function(n){return this.g(n.a())},g:function(n){var t=this.n.compareDocumentPosition(n);return(t&16)==16},f:function(n){var t=n?"ltr":"rtl";var i=n?"left":"right";var r=this;Array.forEach(this.j(),function(n){var r=n;r.setAttribute("dir",t);_j.k.a(r,"text-align",i)})}};function CommonComposeComponent(){}CommonComposeComponent.$$cctor=function(){_a.t.a().a(CommonComposeComponent)};CommonComposeComponent.prototype={b:function(n,t,i){n.e(_cmc.E).a();var r=this;n.b(_cmc.z,function(){return new _cmc.z(n.a(_a.y),n.a(_a.f),n.a(_db.u),n.a(_a.r),n.a(_y.a))}).b(_a.fE).a()},a:function(){return[new _j.y(_cmc.z,4,1)]}};_cmc.bE=function(){_cmc.bE.initializeBase(this);this.e="ComposeUsage"};_cmc.bD=function(n,t){_cmc.bD.initializeBase(this,[1,t]);this.a.ComposeControl=n};_cmc.bD.prototype={b:function(n){this.a.Duration=n},c:function(n){this.a.Total=n}};_cmc.bW=function(){this.l()};_cmc.bW.prototype={b:null,j:null,h:null,k:0,g:0,f:!1,i:null,e:null,n:function(){return!!this.g},a:function(n){if(this.f&&n&&n.length>0){if(n in this.b){var t=this.b[n];this.b[n]=t+1}else this.b[n]=1;this.g++}},m:function(n){this.i=n;this.j=_a.d.get_utcNow();this.f=!0},c:function(){if(this.f){this.h=_a.d.get_utcNow();this.k=this.h.h()-this.j.h();this.o()}this.l()},l:function(){this.b=null;this.b={};this.g=0;this.j=null;this.h=null;this.f=!1},o:function(){if(this.e&&this.i){var n=new _cmc.bD(this.i,this.e);n.b(this.k);n.c(this.g);var t=this.b;for(var i in t){var r={key:i,value:t[i]};n.a[r.key]=r.value}_a.z.b.b()&&_a.z.b.a(n)}}};_cmc.l=function(n,t,i,r){this.y=Function.createDelegate(this,this.cD);_cmc.l.initializeBase(this,[n]);this.b=t;this.bT(2);this.S().a(22);n.setAttribute("contenteditable","true");n.setAttribute("spellcheck","true");n.setAttribute("useinlinestyle","true");this.o=r&&r.f()?"rtl":"ltr";n.setAttribute("dir",this.o);n.style.outline="none";this.cy(i.a());this.bX();this.bl(352);this.S().N(!0)};_cmc.l.prototype={b:null,o:null,f:null,bC:!1,e:null,q:null,h:null,g:null,i:null,k:function(n){if(n){var t=this.f===n;var i=_y.fj.isInstanceOfType(n)?n.b():!1;this.f=n;i||this.ci(this.f);t||this.bw("CallContext")}return n},cQ:function(n){this.bC=n;this.bw("IsInitialized");return n},bQ:function(n){this.h||(this.h=new _j.H);this.h.b(n)},cK:function(n){this.h&&this.h.c(n)},bP:function(n){this.g||(this.g=new _j.H);this.g.b(n)},cJ:function(n){this.g&&this.g.c(n)},H:function(){if(!this.i){this.V()&&_y.L.isInstanceOfType(this.V())&&(this.i=this.V().d());this.i=this.i||window.self}return this.i},J:function(){return _a.a.r},Y:function(){_j.i.prototype.Y.call(this);this.i=null},t:function(){this.q||(this.q=new _cmc.R(null));return this.q},cR:function(n){var t=this;this.s(function(t){_j.k.a(t,"font-family",_cmc.c.f(n))})},cT:function(n){var t=this;this.s(function(t){_j.k.a(t,"font-size",String.format("{0}pt",n))})},cb:function(){this.a("bold",!1,null)},cw:function(){this.a("italic",!1,null)},cY:function(){this.a("underline",!1,null)},cj:function(n){var t=this;this.s(function(t){_j.k.a(t,"color",n)})},ca:function(n){var t=this;this.s(function(t){_j.k.a(t,"background-color",n)})},cc:function(){this.a("insertUnorderedList",!1,null)},cA:function(){this.a("insertOrderedList",!1,null)},bS:function(){this.a("justifyLeft",!1,null)},bR:function(){this.a("justifyCenter",!1,null)},bV:function(){this.a("justifyRight",!1,null)},cr:function(){this.a("indent",!1,null)},cg:function(){this.a("outdent",!1,null)},cV:function(){this.a("strikeThrough",!1,null)},cW:function(){this.a("subscript",!1,null)},cX:function(){this.a("superscript",!1,null)},ce:function(){this.a("removeFormat",!1,null)},cZ:function(){this.a("unlink",!1,null)},cx:function(){this.B(!0)},cP:function(){this.B(!1)},ch:function(){if(this.b.b()){_j.e.a(this.J(),"[ContentEditableDiv: DisableAutoLink] - Disable auto link for IE");this.D("AutoUrlDetect",!1,!1)}},cL:function(n){_j.e.a(this.J(),"[ContentEditableDiv: ResetSelection] - selectionRange {0} collapsed",n.collapsed?"is":"is not");var t=this.m(n);t&&!this.d()&&this.bH(n)&&(this.e=n);return t},cv:function(){return!!this.x()},l:function(n){if(n)this.bN();else if(!this.d()){var t=this.cM();t||this.bN()}this.e=null;if(!this.d())try{this.R()}catch(i){}},c:function(){var n=null;try{if(this.d()){_j.e.a(this.J(),"[ContentEditableDiv: GetSelectionRange] - has focus, get selection");n=this.x()}else if(this.e){_j.e.a(this.J(),"[ContentEditableDiv: GetSelectionRange] - no focus, return the last saved non-null selectionRangeAtBlur");n=this.e}}catch(t){_j.e.d(this.J(),t,"[ContentEditableDiv: GetSelectionRange] - Exception encountered in getting selection range")}return n},u:function(){return this.H().getSelection()},n:function(){return this.j().createRange()},d:function(){var n=this.j();var t=n?n.activeElement:null;return!!t&&this.r(t)},cq:function(){var n=new _cmc.bF;var t=this.j();var i=this;this.p(function(){n.r=i.cm()},"FontName");var r=this;this.p(function(){n.s=r.cn()},"FontSize");var f=this;this.p(function(){n.l=t.queryCommandState("bold")},"Bold");var e=this;this.p(function(){n.m=t.queryCommandState("italic")},"Italic");var o=this;this.p(function(){n.n=t.queryCommandState("underline")},"Underline");var u=this;this.p(function(){var t=u.bh();n.t=t===1;n.u=t===2},"List");return n},bk:function(){var i=null;var t=this.c();if(t){var n=t.collapsed?t.startContainer:t.commonAncestorContainer;n=n.nodeType===3?n=n.parentNode:n;while(n&&this.r(n)){if(n.tagName.toUpperCase()==="OL"||n.tagName.toUpperCase()==="UL"){i=n;break}if(n.tagName.toUpperCase()==="LI"){n.parentNode!==this.z&&(i=n.parentNode);break}n=n.parentNode}}return i},bh:function(){var n=this.bk();var t=0;n&&(n.tagName.toUpperCase()==="OL"?t=2:n.tagName.toUpperCase()==="UL"&&(t=1));return t},r:function(n){var t=!1;if(n===this.z)t=!0;else{var i=_j.k.o(n);if(i)for(var r=0;r<i.length;r++)if(i[r]===this.z){t=!0;break}}_j.e.a(this.J(),"[ContentEditableDiv: IsElementInsideContentEditableDiv] - Element {0} inside CED",t?"is":"is not");return t},w:function(){var n=this.x();if(n){_j.e.a(this.J(),"[ContentEditableDiv: SaveSelectionRange] - save selectionRangeAtBlur, range {0} collapsed",n.collapsed?"is":"is not");this.e=n}else _j.e.a(this.J(),"[ContentEditableDiv: SaveSelectionRange] - no selection range or range not in editor")},G:function(){_j.i.prototype.G.call(this);this.z.parentNode.appendChild(_j.k.q('<style type="text/css" style="display:none;"><!-- P {margin-top:0;margin-bottom:0;} --></style>')[0]);var n=new _cmc.k(!0);n.d=this.bf();this.k(n);this.cQ(!0);(this.b.b()||this.b.h())&&_j.k.b(this.z,"beforedeactivate",this.y)},M:function(){_j.i.prototype.M.call(this);(this.b.b()||this.b.h())&&_j.k.c(this.z,"beforedeactivate");this.e=null},cf:function(n){_j.i.prototype.cf.call(this,n);if(n.a()===8){_j.e.a(this.J(),"[ContentEditableDiv: OnKeyDown] - StopPropagation for Backspace");n.d()}},ec:function(n){_j.i.prototype.ec.call(this,n);this.b.b()||this.b.h()||this.w();this.cF(new _cmc.T(this))},s:function(n){this.l(!1);var t=this.c();t&&(t.collapsed||_a.o.a().R&&t.toString()===""?this.bY(t,n):this.bZ(t,n))},bY:function(n,t){var i=n.startContainer;if(i.nodeType===3&&i.parentNode.tagName.toUpperCase()==="SPAN"&&i.parentNode.textContent.replace(_cmc.l.a,"")==="")t(i.parentNode);else{var r=this.j().createElement("span");r.innerHTML="&#8203;";t(r);n.insertNode(r);var u=this.n();u.selectNodeContents(r);u.collapse(!1);this.m(u)}},bZ:function(n,t){for(var i=null,r=null,e=this.bc(n,1),u=e.a();u;){var o=e.b();var s=this;u.f(t,function(n){i||(i=n);r=n},null,null);u=o}if(i&&r){var f=this.n();f.setStartBefore(i);f.setEndAfter(r);this.m(f)}},cD:function(n){this.w()},cM:function(){var n=!1;if(this.e){_j.e.a(this.J(),"[ContentEditableDiv: RestoreLastSavedSelection] - restore selection to selectionRangeAtBlur");n=this.m(this.e)}return n},bf:function(){var r=!1;var i=this.z;if(!!(!!i.children&i.children.length===1)){var t=i.children[0];if(t.tagName&&t.tagName.toLowerCase()==="div"&&t.id&&t.id.toLowerCase()==="divtagdefaultwrapper"){r=!0;t.setAttribute("dir",this.o)}}var n=this.z.innerHTML;r||(n=String.format('<div id="{0}" style="{1}" dir="{2}">{3}</div>',"divtagdefaultwrapper",this.t().f(),this.o,n));_j.e.a(this.J(),"[ContentEditableDiv: GetFullContent] - Remove ZWS");n=n.replace(_cmc.l.a,"");n=String.format('<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">{0}</head><body dir="{1}">{2}</body></html>','<style type="text/css" style="display:none;"><!-- P {margin-top:0;margin-bottom:0;} --></style>',this.o,n);return n},cI:function(n){this.h&&this.h.a(n)},cF:function(n){this.g&&this.g.a(n)},cC:function(n){this.e=null;this.cI(new _cmc.V(this))},ci:function(n){if(_y.cl.isInstanceOfType(n)){_j.e.a(this.J(),"[ContentEditableDiv: ExecuteCall] - IGetContentCallContext");n.a(this.bf())}else if(_y.fh.isInstanceOfType(n)){_j.e.a(this.J(),"[ContentEditableDiv: ExecuteCall] - ISetContentCallContext");var u=this.bM(n.a());var f=this.br(u);this.z.innerHTML=f}else if(_y.eW.isInstanceOfType(n)){_j.e.a(this.J(),"[ContentEditableDiv: ExecuteCall] - IInsertContentCallContext");var t=n;var r=document.createElement("div");if(t.c()){var e=this.bM(n.b());var o=this.br(e);r.innerHTML=o}else{var s=_ff.g.a(t.b());r.innerHTML=s}var i=r.childNodes;t.a()===1?this.bs(i):t.a()===2?this.bt(i,t.h()):t.a()===3?this.cE(i):t.a()===4?this.bv(i,this.f.u):this.cs(i,t.m(),t.k(),t.j(),t.i())}else if(_y.fi.isInstanceOfType(n)){_j.e.a(this.J(),"[ContentEditableDiv: ExecuteCall] - ISetFocusCallContext");this.l(!1)}else throw Error.notImplemented(String.format("[ContentEditableDiv: ExecuteCall] - ContentEditableDiv does not implement CallContext: {0}",Object.getTypeName(this.f)));},bX:function(){var t=this.z;var n=t.style;n.fontSize=String.format("{0}pt",this.t().c);n.color=this.t().a;n.fontFamily=this.t().d()},x:function(){var n=this.u();var i=null;if(n&&n.rangeCount>0)try{var t=n.getRangeAt(0);_j.e.a(this.J(),"[ContentEditableDiv: TryGetSelectionRange] - Range {0} collapsed",t.collapsed?"is":"is not");if(this.bH(t)){_j.e.a(this.J(),"[ContentEditableDiv: TryGetSelectionRange] - Range falls inside CED");i=t}}catch(r){_j.e.a(this.J(),"[ContentEditableDiv: TryGetSelectionRange] - Ignoring exception: {0}",r.message)}else _j.e.a(this.J(),"[ContentEditableDiv: TryGetSelectionRange] - no selection range");return i},bH:function(n){var t=!1;if(n.commonAncestorContainer){var i=n.commonAncestorContainer;t=this.r(i)}_j.e.a(this.J(),"[ContentEditableDiv: IsRangeInsideContentEditableDiv] - range {0} inside CED",t?"is":"is not");return t},v:function(n,t){var i=this;_j.B.a(t,function(t,r){_j.e.a(i.J(),"[ContentEditableDiv: InsertElementAtRange] - Insert an element");n.collapse(!1);if(n.insertNode){var u=document.importNode(r,!0);n.insertNode(u);n.setStartAfter(u)}else n.pasteHTML&&n.pasteHTML(r.innerHTML)})},bt:function(n,t){var i=this.z.querySelector('div[id^="Signature"]');if(t&&i&&i.hasChildNodes()){_j.e.a(this.J(),"[ContentEditableDiv: InsertElementAtEnd] - Insert above signature");var r=i;var u=this.n();u.selectNodeContents(r.previousSibling?r.previousSibling:r);u.collapse(!0);this.v(u,n)}else{_j.e.a(this.J(),"[ContentEditableDiv: InsertElementAtEnd] - Insert at the end");for(var f=0,e=n.length;f<e;f++)this.z.appendChild(n[0])}},bv:function(n,t){var f=this.z.querySelector(t);if(f){var i=f;var r=this.n();r.selectNodeContents(i.previousSibling?i.previousSibling:i);r.collapse(!0);this.v(r,n)}else for(var u=0,e=n.length;u<e;u++)this.z.appendChild(n[u])},bs:function(n){for(var t=n.length-1;t>=0;t--)_j.k.z(this.z,n[t])},cE:function(n){_j.k.x(this.z);for(var t=n.length-1;t>=0;t--)_j.k.z(this.z,n[t])},cs:function(n,t,i,r,u){var f=this.c();if(f){_j.e.a(this.J(),"[ContentEditableDiv: InsertElementAtSelection] - insert at selection range");!f.collapsed&&i&&f.deleteContents();var e=f.cloneRange();r&&this.cz(f);this.v(f,n);if(t){_j.e.a(this.J(),"[ContentEditableDiv: InsertElementAtSelection] - update cursor to after insertion");f.collapse(!1);this.m(f)}else{_j.e.a(this.J(),"[ContentEditableDiv: InsertElementAtSelection] - restore to original selection range");this.m(e)}}else{_j.e.a(this.J(),"[ContentEditableDiv: InsertElementAtSelection] - no selection, insert at fallback position");switch(u){case 1:this.bs(n);break;case 4:this.bv(n,this.f.u);break;case 2:default:this.bt(n,!0);break}}},a:function(n,t,i){this.l(!1);this.D(n,t,i)},j:function(){var n=this.H();return n?n.document:this.z.ownerDocument},D:function(n,t,i){var r=this.j();r?r.execCommand(n,t,i):_j.e.b(this.J(),"[ContentEditableDiv: ExecCommand] - document is not available")},bM:function(n){return n.replace(_cmc.l.d,"$1").replace(_cmc.l.e,"")},br:function(n){return this.b.b()&&document.documentMode===11?n.replace(_cmc.l.b,"<p>&#8203;</p>"):n},cy:function(n){this.q=new _cmc.R(n)},cz:function(n){n.collapsed||n.collapse(!1);var i=new _cmc.S(this.z,n);var t=i.h();if(t){n.setEndAfter(t.c());n.collapse(!1)}},bc:function(n,t){var i=null;var r=new _cmc.S(this.z,n);switch(t){case 0:i=new _cmc.bp(this.z,r);break;case 1:i=new _cmc.bs(this.z,r);break;case 2:i=new _cmc.bq(this.z,r);break;default:throw Error.argument("EditorDomParsingScope","[ContentEditableDiv: GetEditorDomParser] - Invalid DOM parser scope");}return i},m:function(n){var i=!1;if(n){var t=this.u();if(t){t.rangeCount>0&&t.removeAllRanges();t.addRange(n);i=!0}}return i},B:function(n){this.l(!1);var t=this.c();if(t)if(t.collapsed){var e=new _cmc.S(this.z,t);var i=e.h();if(i){if(!n&&this.b.h()&&_j.h.a(i.b())){var u=this.j().createElement("span");u.innerHTML="&#8203;";t.insertNode(u)}i.f(n)}}else for(var f=this.bc(t,1),r=f.d();r;){var o=r;r=f.e();o.f(n)}else _j.e.c(this.J(),"[ContentEditableDiv: ChangeDirectionOnSelection] - no selection range")},cm:function(){var n="";var r=this.j();if(this.d()){try{var t=r.queryCommandValue("fontname");n=t&&Object.getTypeName(t).toLowerCase()==="string"?t:""}catch(u){_j.e.b(this.J(),"[ContentEditableDiv: GetFontNameAtCursor] - Error querying font from browser: {0}",u.message)}_j.h.b(n)&&(n=this.bq("fontFamily"));var i=null;n=!_j.h.b(n)&&(i=n.match(_cmc.l.c)).length>1?i[1]:"";n=_j.h.b(n)?"":_cmc.c.i(n)}return n},cn:function(){var n="";if(this.d()){n=this.bq("fontSize");n=!_j.h.b(n)&&n.endsWith("pt")?n.substr(0,n.length-2):""}return n},bq:function(n){var r="";var t=null;if(this.d()&&(t=this.u())&&t.focusNode)for(var i=t.focusNode.nodeType===1?t.focusNode:t.focusNode.parentNode;i&&this.r(i);){var f=i.style;var u=f[n];if(!_j.h.b(u)){r=u;break}i=i.parentNode}return r},p:function(n,t){try{n()}catch(i){_j.e.b(this.J(),"[ContentEditableDiv: ProtectedGetFormat] - Error getting format, format: {0}, error: {1}",t,i.message)}},bN:function(){var n=!1;var t=this.be(this.z);if(t){var i=this.n();i.setStart(t,0);n=this.m(i)}else _j.e.b(this.J(),"[ContentEditableDiv: SetSelectionToBegin] - not finding top visible node, selection not set to begin");return n},be:function(n){var t=null;if(n.nodeType===3)_j.h.b(n.nodeValue)||(t=n);else if(n.nodeType===1&&!_cmc.a.e(n)&&!_cmc.a.g(n)){t=n;for(var i=0;i<n.childNodes.length;i++){var u=n.childNodes[i];var r=this.be(u);if(r){t=r;break}}}return t}};_cmc.R=function(n){this.b="Calibri";this.c="12";this.a="#000000";if(n){n.bD.ComposeFontName&&(this.b=n.bD.ComposeFontName);if(!_j.C.a(n.bD.ComposeFontSize)){var t=n.bD.ComposeFontSize;this.c=t<_cmc.c.e.length?_cmc.c.e[t]:t.toString()}n.bD.ComposeFontColor&&(this.a=n.bD.ComposeFontColor)}};_cmc.R.prototype={b:null,c:null,a:null,d:function(){return _cmc.c.f(this.b)},e:function(){return _cmc.c.j(this.b)},f:function(){return String.format("font-size:{0}pt;color:{1};font-family:{2};",this.c,this.a,this.d())}};_cmc.h=function(n,t,i){_j.e.a(n,"StartCTQ: CTQ Name: {0}",t);this.g=n;this.c=_a.c.b(n,t,i,null)};_cmc.h.prototype={g:null,c:null,e:null,b:function(){if(this.c){_j.e.a(this.g,"[CtqContextWrapper: EndWithSuccess]: CTQ Name: {0}",this.c.e());this.h();this.i()}},d:function(n,t){if(this.c){_j.e.a(this.g,"[CtqContextWrapper: EndWithError]: CTQ Name: {0}",this.c.e());this.h();this.c.n=n?n:"Failed";t&&(this.c.p=t);this.i()}},a:function(n,t,i,r){_j.e.a(this.g,"[CtqContextWrapper: AddOrUpdateCustomDataKey]: KeyName: {0}",n);var u=!1;this.e||(this.e=new _a.l);var f=_j.E.a(t)?"":t.toString();if(i||!this.e.d(n)){this.e.b(n,f);u=!0}this.c&&u&&r&&(this.c.m=this.e.toString());return u},k:function(n){this.c&&(this.c.o=n);return n},j:function(){return this.c?this.c.m:""},f:function(n){this.c&&this.c.q(new _a.B(n))},h:function(){this.c&&this.e&&(this.c.m=this.e.toString())},i:function(){if(this.c){_a.c.a(this.c);this.c=null}}};_cmc.bF=function(){};_cmc.bF.prototype={r:null,d:function(){return this.r},s:null,e:function(){return this.s},l:!1,f:function(){return this.l},m:!1,h:function(){return this.m},n:!1,j:function(){return this.n},t:!1,g:function(){return this.t},u:!1,i:function(){return this.u},q:!1,c:function(){return this.q},p:!1,b:function(){return this.p},o:!1,a:function(){return this.o},v:null,k:function(){return this.v},w:function(n){return!!n&&this.r===n.d()&&this.s===n.e()&&this.l===n.f()&&this.m===n.h()&&this.n===n.j()&&this.t===n.g()&&this.u===n.i()&&this.q===n.c()&&this.p===n.b()&&this.o===n.a()&&this.v===n.k()}};_cmc.d=function(n,t,i){this.k=n;this.i=t;this.j=i};_cmc.d.prototype={k:null,i:null,j:null,a:function(){return this.k.a()},c:function(){return this.k.c()},b:function(){var n="";if(_cmc.D.isInstanceOfType(this.k)){var t=this.i?this.i.b:0;var i=this.j?this.j.b:this.k.i.textContent.length;n=this.k.b().substring(t,i)}else{var r=this.n();n=r.toString()}return n},g:function(n){return n.d(this.j)&&n.c(this.i)},d:function(n){var r=this.k.a().compareDocumentPosition(n.a());var i=(r&4)==4;if(!i&&!r&&this.j&&_cmc.d.isInstanceOfType(n)){var t=n;i=(!t.j||this.j.c(t.i))&&(!this.i&&!!t.i||!!this.i&&!!t.i&&this.i.c(t.i))}return i},e:function(n){var r=this.k.a().compareDocumentPosition(n.a());var i=(r&2)==2;if(!i&&!r&&this.i&&_cmc.d.isInstanceOfType(n)){var t=n;i=(!t.i||this.i.d(t.i))&&(!this.j&&!!t.j||!!this.j&&!!t.j&&this.j.d(t.j))}return i},l:function(){return this.j?new _cmc.d(this.k,this.j,null):null},m:function(){return this.i?new _cmc.d(this.k,null,this.i):null},f:function(n,t,i,r){this.k.f(n,t,i?i:this.i,r?r:this.j)},h:function(n,t,i,r){this.k.h(n,t,i?i:this.i,r?r:this.j)},n:function(){var t=this.k.a().ownerDocument;var n=null;if(t){n=t.createRange();this.i?n.setStart(this.i.a,this.i.b):n.setStartBefore(this.k.a());this.j?n.setEnd(this.j.a,this.j.b):n.setEndAfter(this.k.a())}return n}};_cmc.bt=function(){};_cmc.f=function(){};_cmc.f.a=function(){return Math.round(Math.random()*1e6).toString()};_cmc.f.d=function(n){return Array.indexOf(_cmc.bt.a,n)>=0};_cmc.f.i=function(n){return jQuery.isNumeric(String.fromCharCode(n))};_cmc.f.c=function(n,t,i,r){var u=new _a.k;if(t)for(var o=Object.keys(t),s=o.length,f=0;f<s;f++){var h=t[o[f]];_cmc.f.e(u,i,h)}if(r)for(var c=r.b(),e=0;e<c;e++){var l=r.a(e);_cmc.f.e(u,i,l)}return u};_cmc.f.b=function(n,t,i,r,u){if(i)for(var s=Object.keys(t),e=s,h=e.length,f=0;f<h;++f){var o=e[f];if(_cmc.b.a(o)){n.cx()||n.hs(new _a.k);n.cx().c(t[o])}}n.go(u?u:new _a.k);n.jb(new _a.k);_cmc.b.q(n.dx(),t);_cmc.e.q(n.dx(),r)};_cmc.f.f=function(n,t,i,r){for(var o=0;o<n.b();o++){var u=null;var f=null;var s,h;_cmc.f.h(n.a(o),s={val:u},h={val:f});u=s.val;f=h.val;if(!_j.h.a(u)){if(!_j.h.a(f))if(_cmc.e.o(u))i[u]=f;else if(_cmc.b.a(u))try{var e=null;if(f.indexOf("MentionActionWrapper")===-1){e=new _g.ct;var l=JsonParser.deserialize(f);e.Mentioned=r(l)}else e=JsonParser.deserialize(f);e&&(t[u]=e)}catch(a){_j.e.b(_a.a.br,"Failed to deserialize tag from draft. TagId={0}, TagContent={1}. Error={2}.",u,f,a.toString())}else if(u==="MentionAddedRecipients"){var c=JsonParser.deserialize(f);c&&(t[u]=c)}_cmc.b.c(u)&&(t[u]="at-all")}}};_cmc.f.k=function(n){return _cmc.b.i(n)||_cmc.e.i(n)};_cmc.f.j=function(n){return _cmc.b.o(n)||_cmc.e.h(n)};_cmc.f.h=function(n,t,i){t.val="";i.val="";if(!_j.h.a(n))try{var r=JsonParser.deserialize(n);if(r){t.val=r.b;i.val=r.a}}catch(u){_j.e.b(_a.a.br,"Failed to deserialize tag from draft. pendingSocialActivityTagId={0}. Error={1}.",n,u.toString())}};_cmc.f.g=function(n,t,i){if(i){for(var h=Object.keys(i),u=new _j.q,e=0;e<h.length;e++){var r=h[e];_cmc.f.j(r)&&!_j.h.a(n)&&n.indexOf(r)<0&&u.c(r);if(_cmc.f.k(r)){var f=null;if(_cmc.b.i(r)){var o=i[r];o&&o.Mentioned&&(f=o.Mentioned.Name)}else if(_cmc.e.i(r)){var c=i[r];_j.h.a(c)||(f=c)}!_j.h.a(f)&&!_j.h.a(t)&&t.indexOf(f)<0&&u.c(r)}}if(u.d.length>0)for(var s=0;s<u.d.length;s++)delete i[u.d[s]]}};_cmc.f.e=function(n,t,i){n.D(i,t)<0&&n.c(i)};_cmc.bu=function(n,t){this.b=n;this.a=t};_cmc.bu.prototype={b:null,a:null};_cmc.t=function(n){_cmc.t.initializeBase(this,[n])};_cmc.t.prototype={r:function(n){n&&this.v(n);return n},v:function(n){if(_cmc.y.isInstanceOfType(n)){var t=n;if(t.x){t.y=!0;return}var u=t.t?_ff.g.b(t.t):"";var r=this.b;var i=r.substring(0,this.cP())+u+r.substr(this.cM());i=this.cn(i,this.bR);this.c(i)}else if(_cmc.q.isInstanceOfType(n)){var f=n;f.a=this.b.substring(this.cP(),this.cM())}}};_cmc.c=function(){};_cmc.c.f=function(n){for(var t=n,i=0;i<_cmc.c.a.length;++i){var r=_cmc.c.a[i];if(r[0]===t){t=r[1];break}}return t};_cmc.c.j=function(n){for(var r=null,t=0;t<_cmc.c.a.length;++t){var i=_cmc.c.a[t];if(i[0]===n&&i[2]){r=i[2];break}}return r};_cmc.c.i=function(n){for(var i=n,t=0;t<_cmc.c.h.length;++t){var r=_cmc.c.h[t];r[0].toLowerCase()===n.toLowerCase()&&(i=r[1])}return i};_cmc.s=function(){};_cmc.s.c=function(n){var t=n.match(_cmc.s.b);return _j.h.a(t[2])?[t[1]]:[t[1],t[2]]};_cmc.s.a=function(n){for(var i="",r=_cmc.s.c(n),u=r.length,t=0;t<u;++t){var f=r[t];i+=_cmc.s.d(f)}return i};_cmc.s.d=function(n){var t=_cmc.s.e(n);return t?String.fromCharCode.apply(null,t):""};_cmc.s.e=function(n){var e="&#X"+n;var t=parseInt(n,16);if(t>=126976&&t<=128768){var i=Math.floor((t-65536)/1024)+55296;var r=(t-65536)%1024+56320;var u=Number.parseInvariant(i.toString(10));var f=Number.parseInvariant(r.toString(10));return[u,f]}else if(t>=35&&t<=16384)return[t];return null};_cmc.br=function(n,t){this.f=n;this.e=t};_cmc.br.prototype={e:0,c:function(){return this.e},f:null,d:function(){return this.f},b:function(){return!1},a:function(n){return n}};_cmc.B=function(){};_cmc.B.d=function(n){var t={};if(!n)return t;for(var u=n.getElementsByClassName("PendingHashtag"),i=0;i<u.length;i++){var f=u[i];var r=f.id;var e=f.textContent;_j.h.a(r)||_j.h.a(e)||r in t||(t[r]=e)}return t};_cmc.B.c=function(n,t){return _cmc.B.a(n,!0,t)};_cmc.B.b=function(n,t){return _cmc.B.a(n,!1,t)};_cmc.B.e=function(n,t){if(n&&t){for(var i=new _j.q,o=Object.keys(t),r=0;r<o.length;r++){var u=o[r];_cmc.e.h(u)&&(u in n||i.c(u))}for(var f=0;f<i.d.length;f++)delete t[i.d[f]];for(var s=Object.keys(n),e=0;e<s.length;e++){var h=s[e];t[h]=n[h]}}};_cmc.B.a=function(n,t,i){var f=!1;if(!i||!n)return f;for(var s=Object.keys(i),e=0;e<s.length;e++){var c=s[e];var r=n.ownerDocument.getElementById(c);if(r){t?_j.k.p(r,"PendingHashtag")&&_j.k.f(r,"PendingHashtag"):_j.k.p(r,"PendingHashtag")||_j.k.d(r,"PendingHashtag");f=!0}}for(var l="a[id^='OWAHT']",h=document.querySelectorAll(l),o=0;o<h.length;o++){var a=h[o];var u=a;t?_j.k.p(u,"hashtag ms-bgc-nlr ms-fcl-b")&&_j.k.f(u,"hashtag ms-bgc-nlr ms-fcl-b"):_j.k.p(u,"hashtag ms-bgc-nlr ms-fcl-b")||_j.k.d(u,"hashtag ms-bgc-nlr ms-fcl-b")}return f};_cmc.C=function(){};_cmc.e=function(){};_cmc.e.p=function(n){return Array.indexOf(_cmc.C.c,n)>=0};_cmc.e.g=function(n){return Array.indexOf(_cmc.C.b,n)>=0};_cmc.e.r=function(n,t){for(var u=!1,f=!1,r=_j.h.a(n)?0:n.length,i=r>0?r-1:-1,e=null,c=Math.max(0,r-129);!f&&!u&&i>=c;){var o=n.charCodeAt(i);if(_cmc.e.p(o)){f=!0;break}if(_cmc.e.g(o)){u=!0;break}i--}if(f&&!u&&(!i||_cmc.e.g(n.charCodeAt(i-1)))){var s=n.substring(i,r);var h=s.slice(1);(!t||h.length>1&&!jQuery.isNumeric(h))&&(e=s)}return e};_cmc.e.q=function(n,t){if(t&&n)for(var r=Object.keys(t),i=0;i<r.length;i++){var u=r[i];var f=t[u];if(!_j.h.a(f)){var e=new _cmc.bu(u,f);var o=JsonParser.serialize(e);n.c(o)}}};_cmc.e.a=function(n,t,i){_a.z.b.a(new _a.br(1,"MailComposeFilterOutRemovedHashtagsStart"));try{_cmc.f.g(n,t,i)}catch(r){_j.e.b(_a.a.br,"FilterOutRemovedHashTags failure. Error = {0}.",r.toString())}_a.z.b.a(new _a.br(1,"MailComposeFilterOutRemovedHashtagsEnd"))};_cmc.e.m=function(n,t,i,r,u,f){if(null!==r&&_cmc.e.n(t,i)){if(n)_cmc.e.d(n,i,r);else{if(u)return!0;_cmc.e.j(i,r,f)}return!0}return!1};_cmc.e.j=function(n,t,i){t.a(_y.fz,new _y.fz(n));_cmc.e.c(i,0)};_cmc.e.d=function(n,t,i){i.a(_y.N,new _y.N(n,t,!0));_cmc.e.c(10,n)};_cmc.e.o=function(n){return n.startsWith("OWAHT")};_cmc.e.h=function(n){return n.startsWith("OWAHT")&&!n.startsWith(_cmc.C.a)};_cmc.e.i=function(n){return n.startsWith(_cmc.C.a)};_cmc.e.n=function(n,t){return!_j.h.a(n)&&!_j.h.a(t)&&n.startsWith("OWAHT")&&t.startsWith("#")?!0:!1};_cmc.e.b=function(n,t,i){var r=_cmc.e.f(n,t,i);return _cmc.e.e(r)};_cmc.e.l=function(n,t){for(var i={},r=0;r<n.length;r++){var f=n[r];i[f.toLocaleLowerCase()]=f}for(var e=_cmc.e.f(i,t,!1),s=t?t.b():0,u=0;u<s;u++){var h=t.a(u);var o=h.Tag.toLocaleLowerCase();i[o]||delete e[o]}return _cmc.e.e(e)};_cmc.e.c=function(n,t){var i=new _a.l;i.b("mod",_a.M.toString(t));_h.j.a(_a.a.br,"HashtagSearch",n,1,i)};_cmc.e.k=function(n,t){var i=new _g.dZ;i.Tag=n;i.IsInlined=t;i.Application="Outlook";var r;i.CreatedBy=(r=new _dg.bW,r.Name=_g.a.a().c().bD.UserDisplayName,r.EmailAddress=_g.a.a().c().bD.UserEmailAddress,r);return i};_cmc.e.e=function(n){var t=new _a.k;var i=n;for(var r in i){var u={key:r,value:i[r]};t.c(u.value)}return t};_cmc.e.f=function(n,t,i){for(var c=t?t.b():0,r={},u=0;u<c;u++){var f=t.a(u);var l=f.Tag.toLocaleLowerCase();r[l]=f}if(n){var e=n;for(var o in e){var a={key:o,value:e[o]};var s=a.value;var h=s.toLocaleLowerCase();if(!r[h]){var v=_cmc.e.k(s,i);r[h]=v}}}return r};_cmc.bG=function(n,t,i,r,u,f){this.g=n;this.i=t;this.j=i;this.l=r;this.k=u;this.h=f};_cmc.bG.prototype={g:null,b:function(){return this.g},i:0,d:function(){return this.i},j:null,c:function(){return this.j},l:0,f:function(){return this.l},k:0,e:function(){return this.k},h:null,a:function(){return this.h}};_cmc.Z=function(){};_cmc.A=function(n,t){this.e=n;this.f=t};_cmc.A.prototype={c:function(){return!0},e:null,a:function(){return this.e},f:null,d:function(){return this.f},b:function(){return null}};_cmc.bH=function(n,t,i){_cmc.bH.initializeBase(this,[1,"MentionedTagCreate"]);this.a.Suggester=n;this.a.MailType=t;this.a.PlaceholderShown=i};_cmc.b=function(){};_cmc.b.n=function(n){return Array.indexOf(_cmc.v.c,n)>=0};_cmc.b.p=function(n){return Array.indexOf(_cmc.v.d,n)>=0};_cmc.b.c=function(n){return!!n&&n.startsWith("OWAALLAM")};_cmc.b.l=function(n){var r=new Array(0);var t=n.querySelectorAll(String.format("a[id^='{0}'], span[id^='{1}']","OWAAM","OWAALLAM"));if(t&&t.length>0)for(var i=0;i<t.length;i++)r.push(t[i].id);return r};_cmc.b.m=function(n,t){return n.querySelector(String.format("a[id^='{0}'",t))};_cmc.b.k=function(n,t){return String.format('<span ID="{0}" style="font-weight:bold" class="{1} {2}">{3}</span>&nbsp;',t,"mention","ms-bgc-nlr ms-fcl-b",_ff.g.a(n))};_cmc.b.f=function(n){var r=null;if(n){r=new Array(0);var f=n;for(var e in f){var t={key:e,value:f[e]};if(_cmc.b.c(t.key))r.push(new _cmc.A(t.key,t.value));else if(_cmc.b.a(t.key)){var o=t.value;var i=o?o.Mentioned:null;var s=i?i.Name:null;var u=null;if(i&&!_j.h.a(i.PrimaryEmailAddress)){u=new _g.f;u.EmailAddress=i.PrimaryEmailAddress}r.push(new _cmc.M(t.key,s,u))}}}return r};_cmc.b.q=function(n,t){if(t&&n)for(var e=Object.keys(t),r=0;r<e.length;r++){var u=e[r];var i=t[u];if(i){var f="";if(_cmc.b.a(u)){var o=i;f=JsonParser.serialize(o)}else if(Array.isInstanceOfType(i)){var s=i;f=JsonParser.serialize(s)}var h=new _cmc.bu(u,f);var c=JsonParser.serialize(h);n.c(c)}}};_cmc.b.e=function(n,t,i){_a.z.b.a(new _a.br(1,"MailComposeFilterOutRemovedAtMentionsStart"));try{_cmc.f.g(n,t,i)}catch(r){_j.e.b(_a.a.fb,"FilterOutRemovedAtMentions failure. Error = {0}.",r.toString())}_a.z.b.a(new _a.br(1,"MailComposeFilterOutRemovedAtMentionsEnd"))};_cmc.b.a=function(n){return!_j.h.b(n)&&n.startsWith("OWAAM")};_cmc.b.o=function(n){return _cmc.b.a(n)&&!n.startsWith(_cmc.v.b)};_cmc.b.i=function(n){return!_j.h.b(n)&&n.startsWith("SB")};_cmc.b.b=function(n,t){if(n&&t&&Object.getType(n)!==Object.getType(t))return!1;if(n&&t){var i=n;var r=t;return i.Mentioned&&r.Mentioned?i.Mentioned.EmailAddress===r.Mentioned.EmailAddress:!1}return n===t};_cmc.b.j=function(n,t){var r=!0;if(!(!n&&!t))if(n&&t&&n.b()===t.b()){for(var i=0;i<n.b();i++)if(!_cmc.b.b(n.a(i),t.a(i))){r=!1;break}}else r=!1;return r};_cmc.b.d=function(n,t,i){var e="AtAllMention_ExistsInMessage";if(i){var r=Object.keys(i);if(!_j.h.a(n))for(var u=0;u<r.length;u++){var o=r[u];if(o.startsWith("OWAALLAM")&&n.indexOf(o)>=0){var c=new _a.br(1,e);_a.z.b.a(c);return!0}}if(!_j.h.a(t)){for(var s=!1,f=0;f<r.length;f++)if(r[f].startsWith(_cmc.v.a)){s=!0;break}var h=s&&t.indexOf("@all")>=0;if(h){var l=new _a.br(1,e);_a.z.b.a(l)}return h}}return!1};_cmc.b.h=function(n){if(n)for(var i=Object.keys(n),t=0;t<i.length;t++){var r=i[t];if(r.startsWith("OWAALLAM"))return!0}return!1};_cmc.b.g=function(n,t){if(n)for(var r=Object.keys(n),i=0;i<r.length;i++){var u=r[i];var f=n[u];if(_cmc.b.a(u)&&_cmc.b.b(t,f))return!0}return!1};_cmc.M=function(n,t,i){this.f=n;this.g=t;this.e=i};_cmc.M.prototype={c:function(){return!1},f:null,a:function(){return this.f},g:null,d:function(){return this.g},e:null,b:function(){return this.e}};_cmc.X=function(n,t,i){_cmc.X.initializeBase(this);this.e=new _dg.cr(t);this.e.DataProviderType=i;this.e.PermissionLevel=n};_cmc.X.prototype={e:null,h:null,f:null,K:function(n){var t=new _dg.cT(this.L);n.dH(this.e,t,this.J,this.H)},cS:function(n,t,i){if(n&&n.Link){this.h=n;t()}else i(null)}};_cmc.v=function(){};_cmc.ba=function(n,t,i){this.i=n;this.k=t;this.j=i};_cmc.ba.prototype={k:null,i:null,j:null,a:function(){return this.i},c:function(){if(!this.j){var n=new _cmc.o(this.k);this.j=n.e(this.i)}return this.j},b:function(){return this.i.textContent},g:function(n){for(var r=new _cmc.o(this.i),i=this.i;i.firstChild;)i=i.firstChild;while(i.nodeType===3&&_j.h.a(i.nodeValue)){var u=r.a(i);if(u)i=u;else break}for(var t=this.i;t.lastChild;)t=t.lastChild;while(t.nodeType===3&&_j.h.a(t.nodeValue)){var f=r.c(t);if(f)t=f;else break}return n.c(new _cmc.Y(t,t.nodeType===3?t.nodeValue.length:1))&&n.d(new _cmc.Y(i,0))},d:function(n){var t=this.i.compareDocumentPosition(n.a());return(t&4)==4},e:function(n){var t=this.i.compareDocumentPosition(n.a());return(t&2)==2},f:function(n,t,i,r){var a=new _cmc.o(this.i);var y=this.i.ownerDocument;var u=null;var f=null;var e=0;var s=1;if(i){u=i.a;e=i.b;if(u.nodeType===3&&e===u.nodeValue.length||u.nodeType===1&&e===1){u=a.a(u);e=0}}else{u=this.i;while(u.firstChild){u=u.firstChild;e=0}}if(r){f=r.a;s=r.b;if(!s){f=a.c(f);s=f&&f.nodeType===3?f.nodeValue.length:1}}else{f=this.i;while(f.lastChild)f=f.lastChild;s=f&&f.nodeType===3?f.nodeValue.length:1}if(u&&f)while(u===this.i||_cmc.a.c(this.i,u)){var w=a.a(u);var b=u===f||(u.compareDocumentPosition(f)&4)==4;if(!b)break;if(u.nodeType===3&&u.nodeValue!==""){var v=u===f?s:u.nodeValue.length;if(v>e){var p=v-e;var o=null;var h=u.parentNode;if(_cmc.a.a(h)==="SPAN"&&h.textContent.length===p){n(h);o=h}else if(p===u.nodeValue.length){_j.k.T(u,"<span></span>");o=u.parentNode;n(o)}else{var c=y.createElement("span");c.textContent=u.nodeValue;n(c);var l=y.createRange();l.setStart(u,e);l.setEnd(u,v);l.deleteContents();l.insertNode(c);o=c}o&&t&&t(o)}}u=w;e=0}},h:function(n,t,i,r){var s=new _cmc.o(this.i);var c=this.i.ownerDocument;var u=null;var f=null;var e=0;var o=1;if(i){u=i.a;e=i.b;if(u.nodeType===3&&e===u.nodeValue.length||u.nodeType===1&&e===1){u=s.a(u);e=0}}else{u=this.i;while(u.firstChild){u=u.firstChild;e=0}}if(r){f=r.a;o=r.b;if(!o){f=s.c(f);o=f&&f.nodeType===3?f.nodeValue.length:1}}else{f=this.i;while(f.lastChild)f=f.lastChild;o=f&&f.nodeType===3?f.nodeValue.length:1}if(u&&f)while(u===this.i||_cmc.a.c(this.i,u)){var h=u===f||(u.compareDocumentPosition(f)&4)==4;if(!h)break;(t&&u===f&&o>0||u!==f&&(!e||u.nodeType===3&&e<u.nodeValue.length))&&(n?n(u):!0)&&t(u);u=s.a(u);e=0}}};_cmc.bL=function(n,t,i){this.p=n;this.n=t;this.o=i};_cmc.bL.prototype={p:null,n:null,o:null,q:null,r:null,a:function(){return this.n},c:function(){return this.o},k:function(){if(!this.q){for(var n=this.n;n.firstChild;)n=n.firstChild;var t=new _cmc.o(this.p);n&&_cmc.a.b(n)&&(n=t.a(n));this.q=n&&this.g(n)?t.d(n):null}return this.q},m:function(){if(!this.r){for(var n=this.n;n.lastChild;)n=n.lastChild;var t=new _cmc.o(this.p);n&&_cmc.a.b(n)&&(n=t.c(n));this.r=n&&this.g(n)?t.d(n):null}return this.r},b:function(){for(var t="",n=0;n<this.j().length;n++)t+=this.j()[n].innerText;return t},j:function(){for(var t=new Array(0),n=this.n;n;){Array.add(t,n);if(n===this.o)break;n=n.nextSibling}return t},l:function(){return this.n.parentNode!==this.p},h:function(n){return this.n===n.a()&&this.o===n.c()},i:function(n){var t=this.o.compareDocumentPosition(n.a());return(t&4)==4},e:function(n){var t=this.n.compareDocumentPosition(n.c());return(t&2)==2},d:function(n){var t=n.a()===this.n||n.a()===this.o;if(!t){var i=this.n.compareDocumentPosition(n.a());var r=this.o.compareDocumentPosition(n.a());var u=(i&4)==4||(i&16)==16;var f=(r&2)==2||(r&16)==16;t=u&&f}return t},g:function(n){var t=this.n.compareDocumentPosition(n);var i=!t||(t&16)==16;if(!i&&this.n!==this.o&&(t&4)==4){var r=this.o.compareDocumentPosition(n);i=!r||(r&16)==16||(r&2)==2}return i},f:function(n){var t=n?"ltr":"rtl";var i=n?"left":"right";_j.k.Q(this.j(),String.format('<div dir="{0}", style="text-align:{1};"></div>',t,i))}};_cmc.bh=function(){};_cmc.bh.prototype={n:function(){return!1}};_cmc.I=function(){};_cmc.I.a=function(n){var t=n.a;return t&&"UnpromotedInlineImageCount"in t?t.UnpromotedInlineImageCount:0};_cmc.I.prototype={a:null,n:function(){return!1}};_cmc.bk=function(n){this.a=n};_cmc.bk.prototype={a:null,b:!1,n:function(){return!1}};_cmc.bA=function(){};_cmc.bA.prototype={b:0,a:function(n){this.b=n;return n},n:function(){return!1}};_cmc.j=function(n,t,i,r){this.A=n;this.t=t;this.x=i;this.w=r};_cmc.j.prototype={t:null,b:function(){return this.t},x:!1,c:function(){return this.x},A:0,a:function(){return this.A},v:0,i:function(){return this.v},p:!1,m:function(){return this.p},r:!1,k:function(){return this.r},s:!1,h:function(){return this.s},B:!1,f:function(){return this.B},q:!1,j:function(){return this.q},u:null,o:function(){return this.u},C:null,l:function(){return this.C},w:0,e:function(){return this.w},n:function(){return!0}};_cmc.g=function(){};_cmc.g.d=function(n,t,i,r,u){var f=new _g.I;f.BlockStatus=!1;f.ConversationId=n.ConversationId;var e=_a.d.f(_a.d.a());f.DateTimeCreated=e;f.DateTimeReceived=e;f.DateTimeSent=e;var o=t.n();if(o){f.DisplayTo=_cmc.g.c(o.f);f.ToRecipients=o.e()}var s=t.q();if(s){f.DisplayCc=_cmc.g.c(s.f);f.CcRecipients=s.e()}var c=n.ConversationTopic;var h=new _bc.h;f.ExtendedProperty=new Array(3);f.ExtendedProperty[0]=new _g.S;f.ExtendedProperty[0].ExtendedFieldURI=_g.c.br();f.ExtendedProperty[0].Value=c;f.ExtendedProperty[1]=new _g.S;f.ExtendedProperty[1].ExtendedFieldURI=_g.c.bh();f.ExtendedProperty[1].Value="3";f.ExtendedProperty[2]=new _g.S;f.ExtendedProperty[2].ExtendedFieldURI=_g.c.bw();f.ExtendedProperty[2].Value=h.c;f.Flag=new _g.cD;f.Flag.FlagStatus=t.bT()?t.bT().a():"NotFlagged";f.From=i;f.HasAttachments=!!t.bf()&&t.bf().b()>0;f.HasBlockedImages=t.bD.HasBlockedImages;f.Importance=t.be();f.InstanceKey="INSK:"+h.a;f.InternetMessageId=t.bD.InternetMessageId;f.IsDeliveryReceiptRequested=undefined===t.bD.IsDeliveryReceiptRequested?!1:t.bD.IsDeliveryReceiptRequested;f.IsDraft=!1;f.IsRead=!0;f.IsReadReceiptRequested=undefined===t.bD.IsReadReceiptRequested?!1:t.bD.IsReadReceiptRequested;f.ItemClass="IPM.Note";f.ItemId=h.b;f.LastModifiedTime=e;f.ParentFolderId=_g.b.a.nameToId(u);f.Preview=t.O().bD.Value;f.ResponseObjects=new Array(3);f.ResponseObjects[0]=new _g.bQ;f.ResponseObjects[1]=new _g.bt;f.ResponseObjects[2]=new _g.bK;f.Sender=r;f.Sensitivity=t.cl();f.Subject=_u.n.Nj+" "+c;f.UniqueBody=new _g.t("HTML",t.O().bD.Value);f.Conversation=n;return f};_cmc.g.e=function(n,t){if(n.x.length>1){var i="";var r=new _j.l;_j.e.a(_a.a.a,"[CommonComposeHelper: GetTopItemIdAttachmentsFromConversation] - Getting top attachments from conversations");n.o(function(n){var u=n;if(u.bD.Name){if(i!==u.bD.Name&&(!t||u.bD.ItemId.Id!==t.Id)){r.a(u);i=u.bD.Name}}else _j.e.a(_a.a.a,"[CommonComposeHelper: GetTopItemIdAttachmentsFromConversation] - Attachment.Name is null")});return r}else return n};_cmc.g.g=function(n,t){return n.x.length>1&&t.indexOf("ItemId:#Exchange")!==-1};_cmc.g.b=function(n){if(n.nodeType===1){if(n.className.indexOf("OLK-Hidden")>-1)return!0;for(var t=_cmc.Z.a.length-1;t>=0;t--)if(n.id===_cmc.Z.a[t])return!0}return!1};_cmc.g.h=function(n){if(n)if(_cmc.g.b(n))return!0;else{for(var t=n.parentNode;t;){if(_cmc.g.b(t))return!0;t=t.parentNode}return!1}else return!1};_cmc.g.a=function(n,t){try{t.val=n.href;return!0}catch(i){t.val=null;_j.e.b(_a.a.a,"Exception happens when trying to retrieve HREF from an anchor element.");return!1}};_cmc.g.c=function(n){var t=_cmc.g.f.a(n,!1);_cmc.g.i(t);return t};_cmc.g.i=function(n){!_j.h.a(n)&&n.length>2&&(n=n.substr(0,n.length-2));return n};_cmc.bv=function(n,t){this.f=n;this.e=t};_cmc.bv.prototype={f:null,d:function(){return this.f},e:null,c:function(){return this.e},b:function(){return!1},a:function(n){return n}};_cmc.T=function(n){this.c=n};_cmc.T.prototype={c:null,d:function(){return this.c},b:function(){return!1},a:function(n){return n}};_cmc.bw=function(n,t,i){this.h=n;this.g=t;this.f=i};_cmc.bw.prototype={h:null,d:function(){return this.h},g:null,e:function(){return this.g},f:0,c:function(){return this.f},b:function(){return!1},a:function(n){return n}};_cmc.bx=function(n,t){this.f=n;this.e=t};_cmc.bx.prototype={f:null,d:function(){return this.f},e:null,c:function(){return this.e},b:function(){return!1},a:function(n){return n}};_cmc.bc=function(n,t){this.f=n;this.e=t};_cmc.bc.prototype={f:null,d:function(){return this.f},e:null,c:function(){return this.e},b:function(){return!1},a:function(n){return n}};_cmc.U=function(n,t){this.f=n;this.e=t};_cmc.U.prototype={f:null,d:function(){return this.f},e:null,c:function(){return this.e},b:function(){return!1},a:function(n){return n}};_cmc.bd=function(n){this.c=n};_cmc.bd.prototype={c:null,d:function(){return this.c},b:function(){return!1},a:function(n){return n}};_cmc.be=function(n){this.c=n};_cmc.be.prototype={c:null,d:function(){return this.c},b:function(){return!1},a:function(n){return n}};_cmc.bf=function(n,t){this.f=n;this.e=t};_cmc.bf.prototype={f:null,e:null,d:function(){return this.f},c:function(){return this.e},b:function(){return!1},a:function(n){return n}};_cmc.bz=function(n,t){this.e=n;this.c=t};_cmc.bz.prototype={e:null,d:function(){return this.e},c:!1,b:function(){return this.c},a:function(n){this.c=n;return n}};_cmc.bg=function(n){this.c=n};_cmc.bg.prototype={c:null,d:function(){return this.c},b:function(){return!1},a:function(n){return n}};_cmc.x=function(n,t){this.g=n;this.f=t};_cmc.x.prototype={e:!1,g:null,d:function(){return this.g},f:0,c:function(){return this.f},b:function(){return this.e},a:function(n){this.e=n;return n}};_cmc.W=function(n){if(_j.h.a(n))throw Error.argument("coercionType","coercionType cannot be null or empty.");if(n==="text"||n==="html")this.b=n;else throw Error.argument("coercionType","Unsupported coercionType value.");};_cmc.W.prototype={b:null,a:null,n:function(){return!1}};_cmc.k=function(n){this.e=n};_cmc.k.prototype={d:null,c:function(){return this.d},a:function(n){this.d=n;return n},n:function(){return!1},e:!1,b:function(){return this.e}};_cmc.r=function(n){this.b=n};_cmc.r.prototype={b:null,a:function(){return this.b},n:function(){return!0}};_cmc.F=function(n){this.b=n};_cmc.F.prototype={b:!1,a:function(){return this.b},n:function(){return!0}};_cmc.H=function(n){this.a=n};_cmc.H.prototype={a:null,n:function(){return!0}};_cmc.bb=function(n){this.a=n};_cmc.bb.prototype={a:null,n:function(){return!0}};_cmc.bi=function(n,t,i,r,u,f){this.c=n;this.d=t;this.b=i;this.a=r;this.f=u;this.e=f};_cmc.bi.prototype={c:null,d:null,b:!1,a:null,f:0,e:0,n:function(){return!0}};_cmc.bl=function(n,t,i,r){this.a=n;this.b=t;this.d=i;this.c=r};_cmc.bl.prototype={a:null,b:null,d:0,c:0,n:function(){return!0}};_cmc.bm=function(n,t,i,r,u){this.c=n;this.e=t;this.a=i;this.b=r;this.d=u};_cmc.bm.prototype={c:null,e:null,a:null,d:0,b:null,n:function(){return!0}};_cmc.q=function(n){if(n==="text"||n==="html")this.e=n;else throw Error.argument("coercionType","Unsupported coercionType value.");};_cmc.q.prototype={c:null,e:null,a:null,b:!1,g:function(n){this.b=n;return n},d:function(n){if(n==="subject"||n==="body")this.c=n;else throw Error.argument("sourceProperty","Unsupported sourceProperty value.");return n},n:function(){return!1}};_cmc.y=function(n,t,i,r){_cmc.y.initializeBase(this,[0,n,i,r]);this.r=t};_cmc.y.prototype={D:null,y:!1,z:!1,g:function(n){this.z=n;return n},d:function(n){if(n==="subject"||n==="body")this.D=n;else throw Error.argument("sourceProperty","Unsupported sourceProperty value.");return n}};_cmc.bj=function(n,t,i){_cmc.bj.initializeBase(this,[3,n,t,i]);this.r=!1};_cmc.bj.prototype={d:!1};_cmc.O=function(){};_cmc.O.prototype={n:function(){return!0}};_cmc.by=function(n,t){this.f=n;this.e=t};_cmc.by.prototype={e:null,c:function(){return this.e},f:null,d:function(){return this.f},b:function(){return!1},a:function(n){return n}};_cmc.V=function(n){this.c=n};_cmc.V.prototype={c:null,d:function(){return this.c},b:function(){return!1},a:function(n){return n}};_cmc.bN=function(n,t,i,r){this.j=n;this.h=t;this.g=i;this.i=r};_cmc.bN.prototype={h:!1,c:function(){return this.h},g:null,e:function(){return this.g},i:!1,f:function(){return this.i},j:null,d:function(){return this.j},b:function(){return!1},a:function(n){return n}};_cmc.bM=function(n,t){_cmc.bM.initializeBase(this);this.a=n;this.c=t};_cmc.bM.prototype={a:null,c:null,b:function(n){if(this.a){var t=this;_j.m.a().a(_a.a.c,"ComposeCopyPasteViewModel.OnAttachViaString",function(){var i=_a.c.b(_a.a.c,"AttachmentCopyAndPasteItemAttachments",!1,null);t.a.w(n,i)},0)}}};_cmc.E=function(){};_cmc.E.prototype={a:function(n,t){return new _cmc.bM(n,t)}};_cmc.n=function(){};_cmc.n.registerInterface("_cmc.n");_cmc.bO=function(){};_cmc.bP=function(){};_cmc.bP.registerInterface("_cmc.bP");_cmc.bQ=function(){};_cmc.G=function(){};_cmc.G.registerInterface("_cmc.G");_cmc.bR=function(){};_cmc.bR.registerInterface("_cmc.bR");_cmc.bS=function(){};_cmc.bS.registerInterface("_cmc.bS");_cmc.bn=function(){};_cmc.bn.registerInterface("_cmc.bn");_cmc.bT=function(){};_cmc.bT.registerInterface("_cmc.bT");_cmc.bU=function(){};_cmc.bU.registerInterface("_cmc.bU");_cmc.P=function(){};_cmc.P.registerInterface("_cmc.P");_cmc.bV=function(){};_cmc.bV.registerInterface("_cmc.bV");_cmc.z=function(n,t,i,r,u){this.k=Function.createDelegate(this,this.t);this.f=Function.createDelegate(this,this.p);this.g=Function.createDelegate(this,this.q);this.d=t;this.h=r;this.j=i;this.i=n.x().toUpperCase();u.b()?this.x():this.c=6};_cmc.z.b=function(){var n={};n.Australia="AU";n.Austria="AT";n.Brazil="BR";n.Canada="CA";n.Colombia="CO";n.Finland="FI";n.France="FR";n.England="GB";n.Greece="GR";n.Guatemala="GT";n["Hong Kong"]="HK";n.India="IN";n.Italy="IT";n.Japan="JP";n.Netherlands="NL";n["New Zealand"]="NZ";n.Norway="NO";n.Portugal="PT";n["Saudi Arabia"]="SA";n.Singapore="SG";n.Spain="ES";n.Sweden="SE";n.Switzerland="CH";n.Taiwan="TW";n.Thailand="TH";n["United Arab Emirates"]="AE";n["United States"]="US";return n};_cmc.z.prototype={c:0,d:null,j:null,h:null,i:null,e:null,b:null,dispose:function(){if(this.b){this.b.f();this.b=null}},a:function(n){if(this.d&&this.d.a().m().Enabled){var t=this.d.a().m().SupportedMarkets||["EN-US","EN-CA"];this.w(t,n,!1)}},x:function(){this.c=1;this.r()},o:function(){var n=new _cmc.bo(!0);n.b(this.g);n.c(this.f);this.h.a(n)},q:function(n){this.n(n);for(var f=n,e=f.N,t=null,r=e.Sessions,o=r.length,i=0;i<o;++i){var u=r[i];if(u.IsCurrent){t=u;this.m(t.Location);break}}if(!t){_j.e.c(_a.a.w,"No session marked as current session.");this.c=2}},m:function(n){this.c=2;if(n){this.e=this.v(n);if(_j.h.a(this.e)){_j.e.a(_a.a.w,"Current session location cannot be matched: {0}",n.CountryName);this.c=5}else{this.c=3;this.s()}}else{_j.e.b(_a.a.w,"Current session location not present on the active session.");this.c=4}},v:function(n){var t=null;if(_j.h.a(n.CountryISO)){if(!_j.h.a(n.CountryName)&&n.CountryName in _cmc.z.a){t=_cmc.z.a[n.CountryName];_j.e.b(_a.a.w,"Current session location {0} matched to ISO code {1}",n.CountryName,t)}}else{t=n.CountryISO;_j.e.a(_a.a.w,"Current session information contains ISO code {0}",t)}return t?t.toUpperCase():""},p:function(n){this.n(n);this.c=2;_j.e.b(_a.a.w,"FetchOwaSessionsAction failed.")},n:function(n){n.U(this.g);n.T(this.f)},r:function(){_j.e.a(_a.a.w,"Attempting to initialize session location from non-boot configuration...");this.j.a(this.k)},t:function(n){_j.e.a(_a.a.w,"Non-boot configuration ready. Looking for session location...");if(n){this.m(n.CurrentSessionLocation);if(this.c===2){_j.e.c(_a.a.w,"Non-boot configuration does not contain session location. Falling back to FetchOwaSessions request.");this.o()}}else _j.e.c(_a.a.w,"Non-boot configuration is not available.")},w:function(n,t,i){switch(this.c){case 1:this.u(n,t);break;case 3:t(this.l(n));break;case 6:default:_j.e.a(_a.a.w,"[IsLocationInSupportedMarket] status = {0}, unable to determine feature status.",this.c);t(i);break}},l:function(n){for(var i=!1,r=n,f=r.length,t=0;t<f;++t){var e=r[t];var u=e.split("-");if(u[1]===this.e&&u[0]===this.i){i=!0;break}}return i},u:function(n,t){this.b||(this.b=new _a.S);this.b.a(new _cmc.z.c(n,t))},s:function(){if(this.b){for(var i=this.b.b.length,n=0;n<i;n++){var t=this.b.c(n);var r=t.a;r(this.l(t.b));this.b.m(n,null)}this.b=null}}};_cmc.z.c=function(n,t){this.b=n;this.a=t};_cmc.z.c.prototype={b:null,a:null};_cmc.bo=function(n){_cmc.bo.initializeBase(this);this.e=n};_cmc.bo.prototype={e:!1,K:function(n){var t=new _dg.cY(this.L);n.eB(t,this.J,this.H,this.e)},cS:function(n,t,i){if(n&&n.Sessions&&n.Sessions.length>0){this.e&&n.Sessions.length>1&&_j.e.b(_a.a.w,"FetchOwaSessionsAction should only return the current session when FilterOnCurrentSession = true; result.Sessions.Length = {0}",n.Sessions.length);t()}i(Error.create("Invalid SessionInformationResponse"))}};_cmc.bB=function(n){this.d=new _j.q;this.d.c(n)};_cmc.bB.prototype={d:null,a:function(){return this.d},bf:function(){return!this.d.d.length}};_cmc.cd=function(){};_cmc.cd.prototype={entity:null,segment:null,score:0};_cmc.K.registerClass("_cmc.K",_fce.ba);_cmc.L.registerClass("_cmc.L");_cmc.ba.registerClass("_cmc.ba",null,_cmc.cb,_cmc.ca);_cmc.m.registerClass("_cmc.m",_cmc.ba);_cmc.J.registerClass("_cmc.J",_cmc.ba);_cmc.bX.registerClass("_cmc.bX",null,_cmc.bZ);_cmc.bp.registerClass("_cmc.bp",_cmc.bX);_cmc.bq.registerClass("_cmc.bq",_cmc.bX);_cmc.Y.registerClass("_cmc.Y");_cmc.S.registerClass("_cmc.S");_cmc.bs.registerClass("_cmc.bs",_cmc.bX);_cmc.w.registerClass("_cmc.w",_cmc.ba);_cmc.N.registerClass("_cmc.N",_cmc.m);_cmc.p.registerClass("_cmc.p",_cmc.ba);_cmc.D.registerClass("_cmc.D",_cmc.ba);CommonComposeComponent.registerClass("CommonComposeComponent",null,_a.jR,_j.ce);_cmc.bW.registerClass("_cmc.bW");_cmc.bE.registerClass("_cmc.bE",_cmc.bW);_cmc.bD.registerClass("_cmc.bD",_a.br);_cmc.l.registerClass("_cmc.l",_j.i);_cmc.h.registerClass("_cmc.h");_cmc.bF.registerClass("_cmc.bF",null,_y.kl);_cmc.d.registerClass("_cmc.d",null,_cmc.cb,_cmc.ca);_cmc.bu.registerClass("_cmc.bu");_cmc.t.registerClass("_cmc.t",_fc.i);_cmc.bG.registerClass("_cmc.bG",null,_y.jO);_cmc.A.registerClass("_cmc.A",null,_y.jP);_cmc.bH.registerClass("_cmc.bH",_a.br);_cmc.M.registerClass("_cmc.M",null,_y.jP);_cmc.X.registerClass("_cmc.X",_h.fG,_a.fD);_cmc.bh.registerClass("_cmc.bh",null,_h.dx);_cmc.I.registerClass("_cmc.I",null,_h.dx);_cmc.bk.registerClass("_cmc.bk",null,_h.dx);_cmc.bA.registerClass("_cmc.bA",null,_y.hR,_h.dx);_cmc.j.registerClass("_cmc.j",null,_y.eW,_h.dx);_cmc.W.registerClass("_cmc.W",null,_h.dx);_cmc.k.registerClass("_cmc.k",null,_y.cl,_h.dx,_y.fj);_cmc.r.registerClass("_cmc.r",null,_y.fh,_h.dx);_cmc.F.registerClass("_cmc.F",null,_y.fi,_h.dx);_cmc.H.registerClass("_cmc.H",null,_h.dx);_cmc.bb.registerClass("_cmc.bb",null,_h.dx);_cmc.bi.registerClass("_cmc.bi",null,_h.dx);_cmc.bl.registerClass("_cmc.bl",null,_h.dx);_cmc.bm.registerClass("_cmc.bm",null,_h.dx);_cmc.q.registerClass("_cmc.q",null,_y.ll,_h.dx);_cmc.y.registerClass("_cmc.y",_cmc.j,_y.ll,_h.dx);_cmc.bj.registerClass("_cmc.bj",_cmc.j,_h.dx);_cmc.O.registerClass("_cmc.O",null,_y.fg,_h.dx);_cmc.bM.registerClass("_cmc.bM",_a.bv);_cmc.E.registerClass("_cmc.E");_cmc.z.registerClass("_cmc.z",null,_a.fE,Sys.IDisposable);_cmc.z.c.registerClass("_cmc.z.c");_cmc.bo.registerClass("_cmc.bo",_h.fG);_cmc.bB.registerClass("_cmc.bB",null,IOutstandingComposeContext,IContext);_cmc.cd.registerClass("_cmc.cd");_cmc.i.a=_a.a.dW;_cmc.u.a=null;_cmc.p.b="SPAN";_cmc.p.a="SmartSuggestionsKeyword";CommonComposeComponent.$$cctor();_cmc.l.b=new RegExp("<p>\\s*</p>","gim");_cmc.l.a=new RegExp("​","gim");_cmc.l.d=new RegExp("(<style[^>]*>)[\\s]*p[\\s]*{[^}]*}","i");_cmc.l.e=new RegExp("}[\\s]*p[\\s]*{[^}]*","gi");_cmc.l.c=new RegExp("^['\"]?([^'\",]*)","i");_cmc.bt.a=[32,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288];_cmc.c.c="Groups";_cmc.c.g="Inbox";_cmc.c.d="Calendar";_cmc.c.a=[["Arial","Arial,Helvetica,sans-serif","Helvetica"],["Arial Black","'Arial Black',Arial,sans-serif","Arial"],["Calibri","Calibri,Helvetica,sans-serif","Helvetica"],["Calibri Light","'Calibri Light','Helvetica Light',sans-serif","'Helvetica Light'"],["Cambria","Cambria,Georgia,serif","Georgia"],["Candara","Candara,Optima,sans-serif","Optima"],["Century Gothic","'Century Gothic',sans-serif","'Century Gothic'"],["Comic Sans MS","'Comic Sans MS',Chalkboard,cursive","Chalkboard"],["Consolas","Consolas,Courier,monospace","Courier"],["Constantia","Constantia,'Hoefler Text',serif","'Hoefler Text'"],["Corbel","Corbel,Skia,sans-serif","Skia"],["Courier New","'Courier New',monospace","'Courier New'"],["Franklin Gothic Book","'Franklin Gothic Book','Avenir Next Condensed',sans-serif","'Avenir Next Condensed'"],["Franklin Gothic Demi","'Franklin Gothic Demi','Avenir Next Condensed Demi Bold',sans-serif","'Avenir Next Condensed Demi Bold'"],["Franklin Gothic Medium","'Franklin Gothic Medium','Avenir Next Condensed Medium',sans-serif","'Avenir Next Condensed Medium'"],["Garamond","Garamond,Georgia,serif","Georgia"],["Georgia","Georgia,serif","Georgia"],["Helvetica","Helvetica,Arial,sans-serif","Arial"],["Impact","Impact,Charcoal,sans-serif","Charcoal"],["Lucida Console","'Lucida Console',Monaco,monospace","Monaco"],["Lucida Handwriting","'Lucida Handwriting','Apple Chancery',cursive","'Apple Chancery'"],["Lucida Sans Unicode","'Lucida Sans Unicode','Lucida Grande',sans-serif","'Lucida Grande'"],["Palatino Linotype","'Palatino Linotype','Book Antiqua',Palatino,serif","Palatino"],["Segoe UI","'Segoe UI','Helvetica Neue',sans-serif","'Helvetica Neue'"],["Sitka Heading","'Sitka Heading',Cochin,serif","Cochin"],["Sitka Text","'Sitka Text',Cochin,serif","Cochin"],["Tahoma","Tahoma,Geneva,sans-serif","Geneva"],["Times","Times,'Times New Roman',serif","'Times New Roman'"],["Times New Roman","'Times New Roman',Times,serif","Times"],["Trebuchet MS","'Trebuchet MS',Trebuchet,sans-serif","Trebuchet"],["TW Cen MT","'TW Cen MT','Century Gothic',sans-serif","'Century Gothic'"],["Verdana","Verdana,Geneva,sans-serif","Geneva"],["微软雅黑","'Microsoft YaHei','微软雅黑',STHeiti,sans-serif","STHeiti"],["黑体","SimHei,'黑体',STHeiti,sans-serif","STHeiti"],["新宋体","NSimSun,'新宋体',SimSun,'宋体',SimSun-ExtB,'宋体-ExtB',STSong,serif","STSong"],["仿宋","FangSong,'仿宋',STFangsong,serif","STFangsong"],["隶书","SimLi,'隶书','Baoli SC',serif","'Baoli SC'"],["楷体","KaiTi,'楷体',STKaiti,serif","STKaiti"],["微軟正黑體","'Microsoft JhengHei','微軟正黑體','Apple LiGothic',sans-serif","'Apple LiGothic'"],["新細明體","PMingLiU,'新細明體',PMingLiU-ExtB,'新細明體-ExtB','Apple LiSung',serif","'Apple LiSung'"],["標楷體","DFKai-SB,'標楷體','BiauKai',serif","'BiauKai'"],["メイリオ","Meiryo,'メイリオ','Hiragino Sans',sans-serif","'Hiragino Sans'"],["ＭＳ Ｐゴシック","'MS PGothic','ＭＳ Ｐゴシック','MS Gothic','ＭＳ ゴシック','Hiragino Kaku Gothic ProN',sans-serif","'Hiragino Kaku Gothic ProN'"],["ＭＳ Ｐ明朝","'MS PMincho','ＭＳ Ｐ明朝','MS Mincho','ＭＳ 明朝','Hiragino Mincho ProN',serif","'Hiragino Mincho ProN'"],["游ゴシック","'Yu Gothic','游ゴシック','YuGothic',sans-serif","'YuGothic'"],["游明朝","'Yu Mincho','游明朝','YuMincho',serif","'YuMincho'"],["맑은 고딕","'Malgun Gothic','맑은 고딕',AppleGothic,sans-serif","AppleGothic"],["굴림","Gulim,'굴림','Nanum Gothic',sans-serif","'Nanum Gothic'"],["돋움","Dotum,'돋움',AppleGothic,sans-serif","AppleGothic"],["바탕","Batang,'바탕',AppleMyungjo,serif","AppleMyungjo"],["바탕체","BatangChe,'바탕체',AppleMyungjo,serif","AppleMyungjo"],["궁서","Gungsuh,'궁서',GungSeo,serif","GungSeo"],["Leelawadee UI","'Leelawadee UI',Thonburi,sans-serif","Thonburi"],["Angsana New","'Angsana New','Leelawadee UI',Sathu,serif","Sathu"],["Cordia New","'Cordia New','Leelawadee UI',Silom,sans-serif","Silom"],["DaunPenh","DaunPenh,'Leelawadee UI','Khmer MN',sans-serif","'Khmer MN'"],["Nirmala UI","'Nirmala UI',sans-serif","'Nirmala UI'"],["Gautami","Gautami,'Nirmala UI','Telugu MN',sans-serif","'Telugu MN'"],["Iskoola Pota","'Iskoola Pota','Nirmala UI','Sinhala MN',sans-serif","'Sinhala MN'"],["Kalinga","Kalinga,'Nirmala UI','Oriya MN',sans-serif","'Oriya MN'"],["Kartika","Kartika,'Nirmala UI','Malayalam MN',sans-serif","'Malayalam MN'"],["Latha","Latha,'Nirmala UI','Tamil MN',sans-serif","'Tamil MN'"],["Mangal","Mangal,'Nirmala UI','Devanagari Sangam MN',sans-serif","'Devanagari Sangam MN'"],["Raavi","Raavi,'Nirmala UI','Gurmukhi MN',sans-serif","'Gurmukhi MN'"],["Shruti","Shruti,'Nirmala UI','Gujarati Sangam MN',sans-serif","'Gujarati Sangam MN'"],["Tunga","Tunga,'Nirmala UI','Kannada MN',sans-serif","'Kannada MN'"],["Vrinda","Vrinda,'Nirmala UI','Bangla MN',sans-serif","'Bangla MN'"],["Nyala","Nyala,Kefa,sans-serif","Kefa"],["Sylfaen","Sylfaen,Mshtakan,Menlo,serif","Mshtakan,Menlo"]];_cmc.c.h=[["Microsoft YaHei","微软雅黑"],["SimHei","黑体"],["NSimSun","新宋体"],["FangSong","仿宋"],["SimLi","隶书"],["KaiTi","楷体"],["Microsoft JhengHei","微軟正黑體"],["PMingLiU","新細明體"],["DFKai-SB","標楷體"],["Meiryo","メイリオ"],["MS PGothic","ＭＳ Ｐゴシック"],["MS PMincho","ＭＳ Ｐ明朝"],["Yu Gothic","游ゴシック"],["Yu Mincho","游明朝"],["Malgun Gothic","맑은 고딕"],["Gulim","굴림"],["Dotum","돋움"],["Batang","바탕"],["BatangChe","바탕체"],["Gungsuh","궁서"]];_cmc.c.e=["","8","10","12","14","18","24","36"];_cmc.c.b=["8","9","10","11","12","14","16","18","20","22","24","26","28","36","48","72"];_cmc.s.b=new RegExp("emoji_([0-9a-z]+)_*([0-9a-z]*)-png");_cmc.C.a="OWAHTSB";_cmc.C.c=[35,65283,65119,9839];_cmc.C.b=[32,9,13,160,8203,64,65312,65131,96,126,33,65281,65111,36,37,94,38,65286,65120,42,40,41,65288,65289,61,43,65291,45,8722,65293,91,93,8968,8969,8970,8971,65378,65379,12300,12301,12302,12303,12304,12305,65339,65341,65288,65289,123,125,65371,65373,124,92,65340,59,65307,65108,58,65306,39,8216,8217,8218,8219,65287,34,8220,8221,8222,8223,12317,12318,12319,65282,44,12289,65292,65380,46,12290,65377,60,62,171,187,8249,8250,9001,9002,12296,12297,65308,65310,63,65311];_cmc.Z.a=["OwaReferenceAttachments","OwaReferenceAttachmentsEnd"];_cmc.v.b="OWAAMSB";_cmc.v.a="OWAALLAMSB";_cmc.v.c=[59,65307,65108];_cmc.v.d=[64,65312,65131];_cmc.v.e=[32,9,13,160,8203,35,65283,65119,9839,96,126,33,65281,65111,36,37,94,38,65286,65120,42,40,41,65288,65289,61,43,65291,91,93,8968,8969,8970,8971,65378,65379,12300,12301,12302,12303,12304,12305,65339,65341,65288,65289,123,125,65371,65373,124,92,65340,59,65307,65108,58,65306,39,8216,8217,8218,8219,65287,34,8220,8221,8222,8223,12317,12318,12319,65282,44,12289,65292,65380,46,12290,65377,60,62,171,187,8249,8250,9001,9002,12296,12297,65308,65310,47,8260,8725,65295,63,65311];_cmc.g.f=new _y.cX;_cmc.z.a=_cmc.z.b();
window.scriptsLoaded['microsoft.owa.common.compose.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.common.compose.js'] = (new Date()).getTime();
